<!DOCTYPE html>
<html>
<head><meta charset="utf-8" />

<title>8F1_make_mpra</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<style type="text/css">
    /*!
*
* Twitter Bootstrap
*
*/
/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */
html {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block;
  vertical-align: baseline;
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a {
  background-color: transparent;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit;
  font: inherit;
  margin: 0;
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"],
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button;
  cursor: pointer;
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box;
  padding: 0;
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0;
  padding: 0;
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
/*! Source: https://github.com/h5bp/html5-boilerplate/blob/master/src/css/main.css */
@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  a,
  a:visited {
    text-decoration: underline;
  }
  a[href]:after {
    content: " (" attr(href) ")";
  }
  abbr[title]:after {
    content: " (" attr(title) ")";
  }
  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }
  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }
  thead {
    display: table-header-group;
  }
  tr,
  img {
    page-break-inside: avoid;
  }
  img {
    max-width: 100% !important;
  }
  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }
  h2,
  h3 {
    page-break-after: avoid;
  }
  .navbar {
    display: none;
  }
  .btn > .caret,
  .dropup > .btn > .caret {
    border-top-color: #000 !important;
  }
  .label {
    border: 1px solid #000;
  }
  .table {
    border-collapse: collapse !important;
  }
  .table td,
  .table th {
    background-color: #fff !important;
  }
  .table-bordered th,
  .table-bordered td {
    border: 1px solid #ddd !important;
  }
}
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot');
  src: url('../components/bootstrap/fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff2') format('woff2'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.woff') format('woff'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../components/bootstrap/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
.glyphicon-asterisk:before {
  content: "\002a";
}
.glyphicon-plus:before {
  content: "\002b";
}
.glyphicon-euro:before,
.glyphicon-eur:before {
  content: "\20ac";
}
.glyphicon-minus:before {
  content: "\2212";
}
.glyphicon-cloud:before {
  content: "\2601";
}
.glyphicon-envelope:before {
  content: "\2709";
}
.glyphicon-pencil:before {
  content: "\270f";
}
.glyphicon-glass:before {
  content: "\e001";
}
.glyphicon-music:before {
  content: "\e002";
}
.glyphicon-search:before {
  content: "\e003";
}
.glyphicon-heart:before {
  content: "\e005";
}
.glyphicon-star:before {
  content: "\e006";
}
.glyphicon-star-empty:before {
  content: "\e007";
}
.glyphicon-user:before {
  content: "\e008";
}
.glyphicon-film:before {
  content: "\e009";
}
.glyphicon-th-large:before {
  content: "\e010";
}
.glyphicon-th:before {
  content: "\e011";
}
.glyphicon-th-list:before {
  content: "\e012";
}
.glyphicon-ok:before {
  content: "\e013";
}
.glyphicon-remove:before {
  content: "\e014";
}
.glyphicon-zoom-in:before {
  content: "\e015";
}
.glyphicon-zoom-out:before {
  content: "\e016";
}
.glyphicon-off:before {
  content: "\e017";
}
.glyphicon-signal:before {
  content: "\e018";
}
.glyphicon-cog:before {
  content: "\e019";
}
.glyphicon-trash:before {
  content: "\e020";
}
.glyphicon-home:before {
  content: "\e021";
}
.glyphicon-file:before {
  content: "\e022";
}
.glyphicon-time:before {
  content: "\e023";
}
.glyphicon-road:before {
  content: "\e024";
}
.glyphicon-download-alt:before {
  content: "\e025";
}
.glyphicon-download:before {
  content: "\e026";
}
.glyphicon-upload:before {
  content: "\e027";
}
.glyphicon-inbox:before {
  content: "\e028";
}
.glyphicon-play-circle:before {
  content: "\e029";
}
.glyphicon-repeat:before {
  content: "\e030";
}
.glyphicon-refresh:before {
  content: "\e031";
}
.glyphicon-list-alt:before {
  content: "\e032";
}
.glyphicon-lock:before {
  content: "\e033";
}
.glyphicon-flag:before {
  content: "\e034";
}
.glyphicon-headphones:before {
  content: "\e035";
}
.glyphicon-volume-off:before {
  content: "\e036";
}
.glyphicon-volume-down:before {
  content: "\e037";
}
.glyphicon-volume-up:before {
  content: "\e038";
}
.glyphicon-qrcode:before {
  content: "\e039";
}
.glyphicon-barcode:before {
  content: "\e040";
}
.glyphicon-tag:before {
  content: "\e041";
}
.glyphicon-tags:before {
  content: "\e042";
}
.glyphicon-book:before {
  content: "\e043";
}
.glyphicon-bookmark:before {
  content: "\e044";
}
.glyphicon-print:before {
  content: "\e045";
}
.glyphicon-camera:before {
  content: "\e046";
}
.glyphicon-font:before {
  content: "\e047";
}
.glyphicon-bold:before {
  content: "\e048";
}
.glyphicon-italic:before {
  content: "\e049";
}
.glyphicon-text-height:before {
  content: "\e050";
}
.glyphicon-text-width:before {
  content: "\e051";
}
.glyphicon-align-left:before {
  content: "\e052";
}
.glyphicon-align-center:before {
  content: "\e053";
}
.glyphicon-align-right:before {
  content: "\e054";
}
.glyphicon-align-justify:before {
  content: "\e055";
}
.glyphicon-list:before {
  content: "\e056";
}
.glyphicon-indent-left:before {
  content: "\e057";
}
.glyphicon-indent-right:before {
  content: "\e058";
}
.glyphicon-facetime-video:before {
  content: "\e059";
}
.glyphicon-picture:before {
  content: "\e060";
}
.glyphicon-map-marker:before {
  content: "\e062";
}
.glyphicon-adjust:before {
  content: "\e063";
}
.glyphicon-tint:before {
  content: "\e064";
}
.glyphicon-edit:before {
  content: "\e065";
}
.glyphicon-share:before {
  content: "\e066";
}
.glyphicon-check:before {
  content: "\e067";
}
.glyphicon-move:before {
  content: "\e068";
}
.glyphicon-step-backward:before {
  content: "\e069";
}
.glyphicon-fast-backward:before {
  content: "\e070";
}
.glyphicon-backward:before {
  content: "\e071";
}
.glyphicon-play:before {
  content: "\e072";
}
.glyphicon-pause:before {
  content: "\e073";
}
.glyphicon-stop:before {
  content: "\e074";
}
.glyphicon-forward:before {
  content: "\e075";
}
.glyphicon-fast-forward:before {
  content: "\e076";
}
.glyphicon-step-forward:before {
  content: "\e077";
}
.glyphicon-eject:before {
  content: "\e078";
}
.glyphicon-chevron-left:before {
  content: "\e079";
}
.glyphicon-chevron-right:before {
  content: "\e080";
}
.glyphicon-plus-sign:before {
  content: "\e081";
}
.glyphicon-minus-sign:before {
  content: "\e082";
}
.glyphicon-remove-sign:before {
  content: "\e083";
}
.glyphicon-ok-sign:before {
  content: "\e084";
}
.glyphicon-question-sign:before {
  content: "\e085";
}
.glyphicon-info-sign:before {
  content: "\e086";
}
.glyphicon-screenshot:before {
  content: "\e087";
}
.glyphicon-remove-circle:before {
  content: "\e088";
}
.glyphicon-ok-circle:before {
  content: "\e089";
}
.glyphicon-ban-circle:before {
  content: "\e090";
}
.glyphicon-arrow-left:before {
  content: "\e091";
}
.glyphicon-arrow-right:before {
  content: "\e092";
}
.glyphicon-arrow-up:before {
  content: "\e093";
}
.glyphicon-arrow-down:before {
  content: "\e094";
}
.glyphicon-share-alt:before {
  content: "\e095";
}
.glyphicon-resize-full:before {
  content: "\e096";
}
.glyphicon-resize-small:before {
  content: "\e097";
}
.glyphicon-exclamation-sign:before {
  content: "\e101";
}
.glyphicon-gift:before {
  content: "\e102";
}
.glyphicon-leaf:before {
  content: "\e103";
}
.glyphicon-fire:before {
  content: "\e104";
}
.glyphicon-eye-open:before {
  content: "\e105";
}
.glyphicon-eye-close:before {
  content: "\e106";
}
.glyphicon-warning-sign:before {
  content: "\e107";
}
.glyphicon-plane:before {
  content: "\e108";
}
.glyphicon-calendar:before {
  content: "\e109";
}
.glyphicon-random:before {
  content: "\e110";
}
.glyphicon-comment:before {
  content: "\e111";
}
.glyphicon-magnet:before {
  content: "\e112";
}
.glyphicon-chevron-up:before {
  content: "\e113";
}
.glyphicon-chevron-down:before {
  content: "\e114";
}
.glyphicon-retweet:before {
  content: "\e115";
}
.glyphicon-shopping-cart:before {
  content: "\e116";
}
.glyphicon-folder-close:before {
  content: "\e117";
}
.glyphicon-folder-open:before {
  content: "\e118";
}
.glyphicon-resize-vertical:before {
  content: "\e119";
}
.glyphicon-resize-horizontal:before {
  content: "\e120";
}
.glyphicon-hdd:before {
  content: "\e121";
}
.glyphicon-bullhorn:before {
  content: "\e122";
}
.glyphicon-bell:before {
  content: "\e123";
}
.glyphicon-certificate:before {
  content: "\e124";
}
.glyphicon-thumbs-up:before {
  content: "\e125";
}
.glyphicon-thumbs-down:before {
  content: "\e126";
}
.glyphicon-hand-right:before {
  content: "\e127";
}
.glyphicon-hand-left:before {
  content: "\e128";
}
.glyphicon-hand-up:before {
  content: "\e129";
}
.glyphicon-hand-down:before {
  content: "\e130";
}
.glyphicon-circle-arrow-right:before {
  content: "\e131";
}
.glyphicon-circle-arrow-left:before {
  content: "\e132";
}
.glyphicon-circle-arrow-up:before {
  content: "\e133";
}
.glyphicon-circle-arrow-down:before {
  content: "\e134";
}
.glyphicon-globe:before {
  content: "\e135";
}
.glyphicon-wrench:before {
  content: "\e136";
}
.glyphicon-tasks:before {
  content: "\e137";
}
.glyphicon-filter:before {
  content: "\e138";
}
.glyphicon-briefcase:before {
  content: "\e139";
}
.glyphicon-fullscreen:before {
  content: "\e140";
}
.glyphicon-dashboard:before {
  content: "\e141";
}
.glyphicon-paperclip:before {
  content: "\e142";
}
.glyphicon-heart-empty:before {
  content: "\e143";
}
.glyphicon-link:before {
  content: "\e144";
}
.glyphicon-phone:before {
  content: "\e145";
}
.glyphicon-pushpin:before {
  content: "\e146";
}
.glyphicon-usd:before {
  content: "\e148";
}
.glyphicon-gbp:before {
  content: "\e149";
}
.glyphicon-sort:before {
  content: "\e150";
}
.glyphicon-sort-by-alphabet:before {
  content: "\e151";
}
.glyphicon-sort-by-alphabet-alt:before {
  content: "\e152";
}
.glyphicon-sort-by-order:before {
  content: "\e153";
}
.glyphicon-sort-by-order-alt:before {
  content: "\e154";
}
.glyphicon-sort-by-attributes:before {
  content: "\e155";
}
.glyphicon-sort-by-attributes-alt:before {
  content: "\e156";
}
.glyphicon-unchecked:before {
  content: "\e157";
}
.glyphicon-expand:before {
  content: "\e158";
}
.glyphicon-collapse-down:before {
  content: "\e159";
}
.glyphicon-collapse-up:before {
  content: "\e160";
}
.glyphicon-log-in:before {
  content: "\e161";
}
.glyphicon-flash:before {
  content: "\e162";
}
.glyphicon-log-out:before {
  content: "\e163";
}
.glyphicon-new-window:before {
  content: "\e164";
}
.glyphicon-record:before {
  content: "\e165";
}
.glyphicon-save:before {
  content: "\e166";
}
.glyphicon-open:before {
  content: "\e167";
}
.glyphicon-saved:before {
  content: "\e168";
}
.glyphicon-import:before {
  content: "\e169";
}
.glyphicon-export:before {
  content: "\e170";
}
.glyphicon-send:before {
  content: "\e171";
}
.glyphicon-floppy-disk:before {
  content: "\e172";
}
.glyphicon-floppy-saved:before {
  content: "\e173";
}
.glyphicon-floppy-remove:before {
  content: "\e174";
}
.glyphicon-floppy-save:before {
  content: "\e175";
}
.glyphicon-floppy-open:before {
  content: "\e176";
}
.glyphicon-credit-card:before {
  content: "\e177";
}
.glyphicon-transfer:before {
  content: "\e178";
}
.glyphicon-cutlery:before {
  content: "\e179";
}
.glyphicon-header:before {
  content: "\e180";
}
.glyphicon-compressed:before {
  content: "\e181";
}
.glyphicon-earphone:before {
  content: "\e182";
}
.glyphicon-phone-alt:before {
  content: "\e183";
}
.glyphicon-tower:before {
  content: "\e184";
}
.glyphicon-stats:before {
  content: "\e185";
}
.glyphicon-sd-video:before {
  content: "\e186";
}
.glyphicon-hd-video:before {
  content: "\e187";
}
.glyphicon-subtitles:before {
  content: "\e188";
}
.glyphicon-sound-stereo:before {
  content: "\e189";
}
.glyphicon-sound-dolby:before {
  content: "\e190";
}
.glyphicon-sound-5-1:before {
  content: "\e191";
}
.glyphicon-sound-6-1:before {
  content: "\e192";
}
.glyphicon-sound-7-1:before {
  content: "\e193";
}
.glyphicon-copyright-mark:before {
  content: "\e194";
}
.glyphicon-registration-mark:before {
  content: "\e195";
}
.glyphicon-cloud-download:before {
  content: "\e197";
}
.glyphicon-cloud-upload:before {
  content: "\e198";
}
.glyphicon-tree-conifer:before {
  content: "\e199";
}
.glyphicon-tree-deciduous:before {
  content: "\e200";
}
.glyphicon-cd:before {
  content: "\e201";
}
.glyphicon-save-file:before {
  content: "\e202";
}
.glyphicon-open-file:before {
  content: "\e203";
}
.glyphicon-level-up:before {
  content: "\e204";
}
.glyphicon-copy:before {
  content: "\e205";
}
.glyphicon-paste:before {
  content: "\e206";
}
.glyphicon-alert:before {
  content: "\e209";
}
.glyphicon-equalizer:before {
  content: "\e210";
}
.glyphicon-king:before {
  content: "\e211";
}
.glyphicon-queen:before {
  content: "\e212";
}
.glyphicon-pawn:before {
  content: "\e213";
}
.glyphicon-bishop:before {
  content: "\e214";
}
.glyphicon-knight:before {
  content: "\e215";
}
.glyphicon-baby-formula:before {
  content: "\e216";
}
.glyphicon-tent:before {
  content: "\26fa";
}
.glyphicon-blackboard:before {
  content: "\e218";
}
.glyphicon-bed:before {
  content: "\e219";
}
.glyphicon-apple:before {
  content: "\f8ff";
}
.glyphicon-erase:before {
  content: "\e221";
}
.glyphicon-hourglass:before {
  content: "\231b";
}
.glyphicon-lamp:before {
  content: "\e223";
}
.glyphicon-duplicate:before {
  content: "\e224";
}
.glyphicon-piggy-bank:before {
  content: "\e225";
}
.glyphicon-scissors:before {
  content: "\e226";
}
.glyphicon-bitcoin:before {
  content: "\e227";
}
.glyphicon-btc:before {
  content: "\e227";
}
.glyphicon-xbt:before {
  content: "\e227";
}
.glyphicon-yen:before {
  content: "\00a5";
}
.glyphicon-jpy:before {
  content: "\00a5";
}
.glyphicon-ruble:before {
  content: "\20bd";
}
.glyphicon-rub:before {
  content: "\20bd";
}
.glyphicon-scale:before {
  content: "\e230";
}
.glyphicon-ice-lolly:before {
  content: "\e231";
}
.glyphicon-ice-lolly-tasted:before {
  content: "\e232";
}
.glyphicon-education:before {
  content: "\e233";
}
.glyphicon-option-horizontal:before {
  content: "\e234";
}
.glyphicon-option-vertical:before {
  content: "\e235";
}
.glyphicon-menu-hamburger:before {
  content: "\e236";
}
.glyphicon-modal-window:before {
  content: "\e237";
}
.glyphicon-oil:before {
  content: "\e238";
}
.glyphicon-grain:before {
  content: "\e239";
}
.glyphicon-sunglasses:before {
  content: "\e240";
}
.glyphicon-text-size:before {
  content: "\e241";
}
.glyphicon-text-color:before {
  content: "\e242";
}
.glyphicon-text-background:before {
  content: "\e243";
}
.glyphicon-object-align-top:before {
  content: "\e244";
}
.glyphicon-object-align-bottom:before {
  content: "\e245";
}
.glyphicon-object-align-horizontal:before {
  content: "\e246";
}
.glyphicon-object-align-left:before {
  content: "\e247";
}
.glyphicon-object-align-vertical:before {
  content: "\e248";
}
.glyphicon-object-align-right:before {
  content: "\e249";
}
.glyphicon-triangle-right:before {
  content: "\e250";
}
.glyphicon-triangle-left:before {
  content: "\e251";
}
.glyphicon-triangle-bottom:before {
  content: "\e252";
}
.glyphicon-triangle-top:before {
  content: "\e253";
}
.glyphicon-console:before {
  content: "\e254";
}
.glyphicon-superscript:before {
  content: "\e255";
}
.glyphicon-subscript:before {
  content: "\e256";
}
.glyphicon-menu-left:before {
  content: "\e257";
}
.glyphicon-menu-right:before {
  content: "\e258";
}
.glyphicon-menu-down:before {
  content: "\e259";
}
.glyphicon-menu-up:before {
  content: "\e260";
}
* {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
*:before,
*:after {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html {
  font-size: 10px;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}
body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 1.42857143;
  color: #000;
  background-color: #fff;
}
input,
button,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}
a {
  color: #337ab7;
  text-decoration: none;
}
a:hover,
a:focus {
  color: #23527c;
  text-decoration: underline;
}
a:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
figure {
  margin: 0;
}
img {
  vertical-align: middle;
}
.img-responsive,
.thumbnail > img,
.thumbnail a > img,
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  display: block;
  max-width: 100%;
  height: auto;
}
.img-rounded {
  border-radius: 3px;
}
.img-thumbnail {
  padding: 4px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: all 0.2s ease-in-out;
  -o-transition: all 0.2s ease-in-out;
  transition: all 0.2s ease-in-out;
  display: inline-block;
  max-width: 100%;
  height: auto;
}
.img-circle {
  border-radius: 50%;
}
hr {
  margin-top: 18px;
  margin-bottom: 18px;
  border: 0;
  border-top: 1px solid #eeeeee;
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  margin: -1px;
  padding: 0;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
[role="button"] {
  cursor: pointer;
}
h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6 {
  font-family: inherit;
  font-weight: 500;
  line-height: 1.1;
  color: inherit;
}
h1 small,
h2 small,
h3 small,
h4 small,
h5 small,
h6 small,
.h1 small,
.h2 small,
.h3 small,
.h4 small,
.h5 small,
.h6 small,
h1 .small,
h2 .small,
h3 .small,
h4 .small,
h5 .small,
h6 .small,
.h1 .small,
.h2 .small,
.h3 .small,
.h4 .small,
.h5 .small,
.h6 .small {
  font-weight: normal;
  line-height: 1;
  color: #777777;
}
h1,
.h1,
h2,
.h2,
h3,
.h3 {
  margin-top: 18px;
  margin-bottom: 9px;
}
h1 small,
.h1 small,
h2 small,
.h2 small,
h3 small,
.h3 small,
h1 .small,
.h1 .small,
h2 .small,
.h2 .small,
h3 .small,
.h3 .small {
  font-size: 65%;
}
h4,
.h4,
h5,
.h5,
h6,
.h6 {
  margin-top: 9px;
  margin-bottom: 9px;
}
h4 small,
.h4 small,
h5 small,
.h5 small,
h6 small,
.h6 small,
h4 .small,
.h4 .small,
h5 .small,
.h5 .small,
h6 .small,
.h6 .small {
  font-size: 75%;
}
h1,
.h1 {
  font-size: 33px;
}
h2,
.h2 {
  font-size: 27px;
}
h3,
.h3 {
  font-size: 23px;
}
h4,
.h4 {
  font-size: 17px;
}
h5,
.h5 {
  font-size: 13px;
}
h6,
.h6 {
  font-size: 12px;
}
p {
  margin: 0 0 9px;
}
.lead {
  margin-bottom: 18px;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.4;
}
@media (min-width: 768px) {
  .lead {
    font-size: 19.5px;
  }
}
small,
.small {
  font-size: 92%;
}
mark,
.mark {
  background-color: #fcf8e3;
  padding: .2em;
}
.text-left {
  text-align: left;
}
.text-right {
  text-align: right;
}
.text-center {
  text-align: center;
}
.text-justify {
  text-align: justify;
}
.text-nowrap {
  white-space: nowrap;
}
.text-lowercase {
  text-transform: lowercase;
}
.text-uppercase {
  text-transform: uppercase;
}
.text-capitalize {
  text-transform: capitalize;
}
.text-muted {
  color: #777777;
}
.text-primary {
  color: #337ab7;
}
a.text-primary:hover,
a.text-primary:focus {
  color: #286090;
}
.text-success {
  color: #3c763d;
}
a.text-success:hover,
a.text-success:focus {
  color: #2b542c;
}
.text-info {
  color: #31708f;
}
a.text-info:hover,
a.text-info:focus {
  color: #245269;
}
.text-warning {
  color: #8a6d3b;
}
a.text-warning:hover,
a.text-warning:focus {
  color: #66512c;
}
.text-danger {
  color: #a94442;
}
a.text-danger:hover,
a.text-danger:focus {
  color: #843534;
}
.bg-primary {
  color: #fff;
  background-color: #337ab7;
}
a.bg-primary:hover,
a.bg-primary:focus {
  background-color: #286090;
}
.bg-success {
  background-color: #dff0d8;
}
a.bg-success:hover,
a.bg-success:focus {
  background-color: #c1e2b3;
}
.bg-info {
  background-color: #d9edf7;
}
a.bg-info:hover,
a.bg-info:focus {
  background-color: #afd9ee;
}
.bg-warning {
  background-color: #fcf8e3;
}
a.bg-warning:hover,
a.bg-warning:focus {
  background-color: #f7ecb5;
}
.bg-danger {
  background-color: #f2dede;
}
a.bg-danger:hover,
a.bg-danger:focus {
  background-color: #e4b9b9;
}
.page-header {
  padding-bottom: 8px;
  margin: 36px 0 18px;
  border-bottom: 1px solid #eeeeee;
}
ul,
ol {
  margin-top: 0;
  margin-bottom: 9px;
}
ul ul,
ol ul,
ul ol,
ol ol {
  margin-bottom: 0;
}
.list-unstyled {
  padding-left: 0;
  list-style: none;
}
.list-inline {
  padding-left: 0;
  list-style: none;
  margin-left: -5px;
}
.list-inline > li {
  display: inline-block;
  padding-left: 5px;
  padding-right: 5px;
}
dl {
  margin-top: 0;
  margin-bottom: 18px;
}
dt,
dd {
  line-height: 1.42857143;
}
dt {
  font-weight: bold;
}
dd {
  margin-left: 0;
}
@media (min-width: 541px) {
  .dl-horizontal dt {
    float: left;
    width: 160px;
    clear: left;
    text-align: right;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .dl-horizontal dd {
    margin-left: 180px;
  }
}
abbr[title],
abbr[data-original-title] {
  cursor: help;
  border-bottom: 1px dotted #777777;
}
.initialism {
  font-size: 90%;
  text-transform: uppercase;
}
blockquote {
  padding: 9px 18px;
  margin: 0 0 18px;
  font-size: inherit;
  border-left: 5px solid #eeeeee;
}
blockquote p:last-child,
blockquote ul:last-child,
blockquote ol:last-child {
  margin-bottom: 0;
}
blockquote footer,
blockquote small,
blockquote .small {
  display: block;
  font-size: 80%;
  line-height: 1.42857143;
  color: #777777;
}
blockquote footer:before,
blockquote small:before,
blockquote .small:before {
  content: '\2014 \00A0';
}
.blockquote-reverse,
blockquote.pull-right {
  padding-right: 15px;
  padding-left: 0;
  border-right: 5px solid #eeeeee;
  border-left: 0;
  text-align: right;
}
.blockquote-reverse footer:before,
blockquote.pull-right footer:before,
.blockquote-reverse small:before,
blockquote.pull-right small:before,
.blockquote-reverse .small:before,
blockquote.pull-right .small:before {
  content: '';
}
.blockquote-reverse footer:after,
blockquote.pull-right footer:after,
.blockquote-reverse small:after,
blockquote.pull-right small:after,
.blockquote-reverse .small:after,
blockquote.pull-right .small:after {
  content: '\00A0 \2014';
}
address {
  margin-bottom: 18px;
  font-style: normal;
  line-height: 1.42857143;
}
code,
kbd,
pre,
samp {
  font-family: monospace;
}
code {
  padding: 2px 4px;
  font-size: 90%;
  color: #c7254e;
  background-color: #f9f2f4;
  border-radius: 2px;
}
kbd {
  padding: 2px 4px;
  font-size: 90%;
  color: #888;
  background-color: transparent;
  border-radius: 1px;
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.25);
}
kbd kbd {
  padding: 0;
  font-size: 100%;
  font-weight: bold;
  box-shadow: none;
}
pre {
  display: block;
  padding: 8.5px;
  margin: 0 0 9px;
  font-size: 12px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  color: #333333;
  background-color: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 2px;
}
pre code {
  padding: 0;
  font-size: inherit;
  color: inherit;
  white-space: pre-wrap;
  background-color: transparent;
  border-radius: 0;
}
.pre-scrollable {
  max-height: 340px;
  overflow-y: scroll;
}
.container {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
@media (min-width: 768px) {
  .container {
    width: 768px;
  }
}
@media (min-width: 992px) {
  .container {
    width: 940px;
  }
}
@media (min-width: 1200px) {
  .container {
    width: 1140px;
  }
}
.container-fluid {
  margin-right: auto;
  margin-left: auto;
  padding-left: 0px;
  padding-right: 0px;
}
.row {
  margin-left: 0px;
  margin-right: 0px;
}
.col-xs-1, .col-sm-1, .col-md-1, .col-lg-1, .col-xs-2, .col-sm-2, .col-md-2, .col-lg-2, .col-xs-3, .col-sm-3, .col-md-3, .col-lg-3, .col-xs-4, .col-sm-4, .col-md-4, .col-lg-4, .col-xs-5, .col-sm-5, .col-md-5, .col-lg-5, .col-xs-6, .col-sm-6, .col-md-6, .col-lg-6, .col-xs-7, .col-sm-7, .col-md-7, .col-lg-7, .col-xs-8, .col-sm-8, .col-md-8, .col-lg-8, .col-xs-9, .col-sm-9, .col-md-9, .col-lg-9, .col-xs-10, .col-sm-10, .col-md-10, .col-lg-10, .col-xs-11, .col-sm-11, .col-md-11, .col-lg-11, .col-xs-12, .col-sm-12, .col-md-12, .col-lg-12 {
  position: relative;
  min-height: 1px;
  padding-left: 0px;
  padding-right: 0px;
}
.col-xs-1, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9, .col-xs-10, .col-xs-11, .col-xs-12 {
  float: left;
}
.col-xs-12 {
  width: 100%;
}
.col-xs-11 {
  width: 91.66666667%;
}
.col-xs-10 {
  width: 83.33333333%;
}
.col-xs-9 {
  width: 75%;
}
.col-xs-8 {
  width: 66.66666667%;
}
.col-xs-7 {
  width: 58.33333333%;
}
.col-xs-6 {
  width: 50%;
}
.col-xs-5 {
  width: 41.66666667%;
}
.col-xs-4 {
  width: 33.33333333%;
}
.col-xs-3 {
  width: 25%;
}
.col-xs-2 {
  width: 16.66666667%;
}
.col-xs-1 {
  width: 8.33333333%;
}
.col-xs-pull-12 {
  right: 100%;
}
.col-xs-pull-11 {
  right: 91.66666667%;
}
.col-xs-pull-10 {
  right: 83.33333333%;
}
.col-xs-pull-9 {
  right: 75%;
}
.col-xs-pull-8 {
  right: 66.66666667%;
}
.col-xs-pull-7 {
  right: 58.33333333%;
}
.col-xs-pull-6 {
  right: 50%;
}
.col-xs-pull-5 {
  right: 41.66666667%;
}
.col-xs-pull-4 {
  right: 33.33333333%;
}
.col-xs-pull-3 {
  right: 25%;
}
.col-xs-pull-2 {
  right: 16.66666667%;
}
.col-xs-pull-1 {
  right: 8.33333333%;
}
.col-xs-pull-0 {
  right: auto;
}
.col-xs-push-12 {
  left: 100%;
}
.col-xs-push-11 {
  left: 91.66666667%;
}
.col-xs-push-10 {
  left: 83.33333333%;
}
.col-xs-push-9 {
  left: 75%;
}
.col-xs-push-8 {
  left: 66.66666667%;
}
.col-xs-push-7 {
  left: 58.33333333%;
}
.col-xs-push-6 {
  left: 50%;
}
.col-xs-push-5 {
  left: 41.66666667%;
}
.col-xs-push-4 {
  left: 33.33333333%;
}
.col-xs-push-3 {
  left: 25%;
}
.col-xs-push-2 {
  left: 16.66666667%;
}
.col-xs-push-1 {
  left: 8.33333333%;
}
.col-xs-push-0 {
  left: auto;
}
.col-xs-offset-12 {
  margin-left: 100%;
}
.col-xs-offset-11 {
  margin-left: 91.66666667%;
}
.col-xs-offset-10 {
  margin-left: 83.33333333%;
}
.col-xs-offset-9 {
  margin-left: 75%;
}
.col-xs-offset-8 {
  margin-left: 66.66666667%;
}
.col-xs-offset-7 {
  margin-left: 58.33333333%;
}
.col-xs-offset-6 {
  margin-left: 50%;
}
.col-xs-offset-5 {
  margin-left: 41.66666667%;
}
.col-xs-offset-4 {
  margin-left: 33.33333333%;
}
.col-xs-offset-3 {
  margin-left: 25%;
}
.col-xs-offset-2 {
  margin-left: 16.66666667%;
}
.col-xs-offset-1 {
  margin-left: 8.33333333%;
}
.col-xs-offset-0 {
  margin-left: 0%;
}
@media (min-width: 768px) {
  .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10, .col-sm-11, .col-sm-12 {
    float: left;
  }
  .col-sm-12 {
    width: 100%;
  }
  .col-sm-11 {
    width: 91.66666667%;
  }
  .col-sm-10 {
    width: 83.33333333%;
  }
  .col-sm-9 {
    width: 75%;
  }
  .col-sm-8 {
    width: 66.66666667%;
  }
  .col-sm-7 {
    width: 58.33333333%;
  }
  .col-sm-6 {
    width: 50%;
  }
  .col-sm-5 {
    width: 41.66666667%;
  }
  .col-sm-4 {
    width: 33.33333333%;
  }
  .col-sm-3 {
    width: 25%;
  }
  .col-sm-2 {
    width: 16.66666667%;
  }
  .col-sm-1 {
    width: 8.33333333%;
  }
  .col-sm-pull-12 {
    right: 100%;
  }
  .col-sm-pull-11 {
    right: 91.66666667%;
  }
  .col-sm-pull-10 {
    right: 83.33333333%;
  }
  .col-sm-pull-9 {
    right: 75%;
  }
  .col-sm-pull-8 {
    right: 66.66666667%;
  }
  .col-sm-pull-7 {
    right: 58.33333333%;
  }
  .col-sm-pull-6 {
    right: 50%;
  }
  .col-sm-pull-5 {
    right: 41.66666667%;
  }
  .col-sm-pull-4 {
    right: 33.33333333%;
  }
  .col-sm-pull-3 {
    right: 25%;
  }
  .col-sm-pull-2 {
    right: 16.66666667%;
  }
  .col-sm-pull-1 {
    right: 8.33333333%;
  }
  .col-sm-pull-0 {
    right: auto;
  }
  .col-sm-push-12 {
    left: 100%;
  }
  .col-sm-push-11 {
    left: 91.66666667%;
  }
  .col-sm-push-10 {
    left: 83.33333333%;
  }
  .col-sm-push-9 {
    left: 75%;
  }
  .col-sm-push-8 {
    left: 66.66666667%;
  }
  .col-sm-push-7 {
    left: 58.33333333%;
  }
  .col-sm-push-6 {
    left: 50%;
  }
  .col-sm-push-5 {
    left: 41.66666667%;
  }
  .col-sm-push-4 {
    left: 33.33333333%;
  }
  .col-sm-push-3 {
    left: 25%;
  }
  .col-sm-push-2 {
    left: 16.66666667%;
  }
  .col-sm-push-1 {
    left: 8.33333333%;
  }
  .col-sm-push-0 {
    left: auto;
  }
  .col-sm-offset-12 {
    margin-left: 100%;
  }
  .col-sm-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-sm-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-sm-offset-9 {
    margin-left: 75%;
  }
  .col-sm-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-sm-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-sm-offset-6 {
    margin-left: 50%;
  }
  .col-sm-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-sm-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-sm-offset-3 {
    margin-left: 25%;
  }
  .col-sm-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-sm-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-sm-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 992px) {
  .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6, .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12 {
    float: left;
  }
  .col-md-12 {
    width: 100%;
  }
  .col-md-11 {
    width: 91.66666667%;
  }
  .col-md-10 {
    width: 83.33333333%;
  }
  .col-md-9 {
    width: 75%;
  }
  .col-md-8 {
    width: 66.66666667%;
  }
  .col-md-7 {
    width: 58.33333333%;
  }
  .col-md-6 {
    width: 50%;
  }
  .col-md-5 {
    width: 41.66666667%;
  }
  .col-md-4 {
    width: 33.33333333%;
  }
  .col-md-3 {
    width: 25%;
  }
  .col-md-2 {
    width: 16.66666667%;
  }
  .col-md-1 {
    width: 8.33333333%;
  }
  .col-md-pull-12 {
    right: 100%;
  }
  .col-md-pull-11 {
    right: 91.66666667%;
  }
  .col-md-pull-10 {
    right: 83.33333333%;
  }
  .col-md-pull-9 {
    right: 75%;
  }
  .col-md-pull-8 {
    right: 66.66666667%;
  }
  .col-md-pull-7 {
    right: 58.33333333%;
  }
  .col-md-pull-6 {
    right: 50%;
  }
  .col-md-pull-5 {
    right: 41.66666667%;
  }
  .col-md-pull-4 {
    right: 33.33333333%;
  }
  .col-md-pull-3 {
    right: 25%;
  }
  .col-md-pull-2 {
    right: 16.66666667%;
  }
  .col-md-pull-1 {
    right: 8.33333333%;
  }
  .col-md-pull-0 {
    right: auto;
  }
  .col-md-push-12 {
    left: 100%;
  }
  .col-md-push-11 {
    left: 91.66666667%;
  }
  .col-md-push-10 {
    left: 83.33333333%;
  }
  .col-md-push-9 {
    left: 75%;
  }
  .col-md-push-8 {
    left: 66.66666667%;
  }
  .col-md-push-7 {
    left: 58.33333333%;
  }
  .col-md-push-6 {
    left: 50%;
  }
  .col-md-push-5 {
    left: 41.66666667%;
  }
  .col-md-push-4 {
    left: 33.33333333%;
  }
  .col-md-push-3 {
    left: 25%;
  }
  .col-md-push-2 {
    left: 16.66666667%;
  }
  .col-md-push-1 {
    left: 8.33333333%;
  }
  .col-md-push-0 {
    left: auto;
  }
  .col-md-offset-12 {
    margin-left: 100%;
  }
  .col-md-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-md-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-md-offset-9 {
    margin-left: 75%;
  }
  .col-md-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-md-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-md-offset-6 {
    margin-left: 50%;
  }
  .col-md-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-md-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-md-offset-3 {
    margin-left: 25%;
  }
  .col-md-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-md-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-md-offset-0 {
    margin-left: 0%;
  }
}
@media (min-width: 1200px) {
  .col-lg-1, .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9, .col-lg-10, .col-lg-11, .col-lg-12 {
    float: left;
  }
  .col-lg-12 {
    width: 100%;
  }
  .col-lg-11 {
    width: 91.66666667%;
  }
  .col-lg-10 {
    width: 83.33333333%;
  }
  .col-lg-9 {
    width: 75%;
  }
  .col-lg-8 {
    width: 66.66666667%;
  }
  .col-lg-7 {
    width: 58.33333333%;
  }
  .col-lg-6 {
    width: 50%;
  }
  .col-lg-5 {
    width: 41.66666667%;
  }
  .col-lg-4 {
    width: 33.33333333%;
  }
  .col-lg-3 {
    width: 25%;
  }
  .col-lg-2 {
    width: 16.66666667%;
  }
  .col-lg-1 {
    width: 8.33333333%;
  }
  .col-lg-pull-12 {
    right: 100%;
  }
  .col-lg-pull-11 {
    right: 91.66666667%;
  }
  .col-lg-pull-10 {
    right: 83.33333333%;
  }
  .col-lg-pull-9 {
    right: 75%;
  }
  .col-lg-pull-8 {
    right: 66.66666667%;
  }
  .col-lg-pull-7 {
    right: 58.33333333%;
  }
  .col-lg-pull-6 {
    right: 50%;
  }
  .col-lg-pull-5 {
    right: 41.66666667%;
  }
  .col-lg-pull-4 {
    right: 33.33333333%;
  }
  .col-lg-pull-3 {
    right: 25%;
  }
  .col-lg-pull-2 {
    right: 16.66666667%;
  }
  .col-lg-pull-1 {
    right: 8.33333333%;
  }
  .col-lg-pull-0 {
    right: auto;
  }
  .col-lg-push-12 {
    left: 100%;
  }
  .col-lg-push-11 {
    left: 91.66666667%;
  }
  .col-lg-push-10 {
    left: 83.33333333%;
  }
  .col-lg-push-9 {
    left: 75%;
  }
  .col-lg-push-8 {
    left: 66.66666667%;
  }
  .col-lg-push-7 {
    left: 58.33333333%;
  }
  .col-lg-push-6 {
    left: 50%;
  }
  .col-lg-push-5 {
    left: 41.66666667%;
  }
  .col-lg-push-4 {
    left: 33.33333333%;
  }
  .col-lg-push-3 {
    left: 25%;
  }
  .col-lg-push-2 {
    left: 16.66666667%;
  }
  .col-lg-push-1 {
    left: 8.33333333%;
  }
  .col-lg-push-0 {
    left: auto;
  }
  .col-lg-offset-12 {
    margin-left: 100%;
  }
  .col-lg-offset-11 {
    margin-left: 91.66666667%;
  }
  .col-lg-offset-10 {
    margin-left: 83.33333333%;
  }
  .col-lg-offset-9 {
    margin-left: 75%;
  }
  .col-lg-offset-8 {
    margin-left: 66.66666667%;
  }
  .col-lg-offset-7 {
    margin-left: 58.33333333%;
  }
  .col-lg-offset-6 {
    margin-left: 50%;
  }
  .col-lg-offset-5 {
    margin-left: 41.66666667%;
  }
  .col-lg-offset-4 {
    margin-left: 33.33333333%;
  }
  .col-lg-offset-3 {
    margin-left: 25%;
  }
  .col-lg-offset-2 {
    margin-left: 16.66666667%;
  }
  .col-lg-offset-1 {
    margin-left: 8.33333333%;
  }
  .col-lg-offset-0 {
    margin-left: 0%;
  }
}
table {
  background-color: transparent;
}
caption {
  padding-top: 8px;
  padding-bottom: 8px;
  color: #777777;
  text-align: left;
}
th {
  text-align: left;
}
.table {
  width: 100%;
  max-width: 100%;
  margin-bottom: 18px;
}
.table > thead > tr > th,
.table > tbody > tr > th,
.table > tfoot > tr > th,
.table > thead > tr > td,
.table > tbody > tr > td,
.table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: top;
  border-top: 1px solid #ddd;
}
.table > thead > tr > th {
  vertical-align: bottom;
  border-bottom: 2px solid #ddd;
}
.table > caption + thead > tr:first-child > th,
.table > colgroup + thead > tr:first-child > th,
.table > thead:first-child > tr:first-child > th,
.table > caption + thead > tr:first-child > td,
.table > colgroup + thead > tr:first-child > td,
.table > thead:first-child > tr:first-child > td {
  border-top: 0;
}
.table > tbody + tbody {
  border-top: 2px solid #ddd;
}
.table .table {
  background-color: #fff;
}
.table-condensed > thead > tr > th,
.table-condensed > tbody > tr > th,
.table-condensed > tfoot > tr > th,
.table-condensed > thead > tr > td,
.table-condensed > tbody > tr > td,
.table-condensed > tfoot > tr > td {
  padding: 5px;
}
.table-bordered {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > tbody > tr > th,
.table-bordered > tfoot > tr > th,
.table-bordered > thead > tr > td,
.table-bordered > tbody > tr > td,
.table-bordered > tfoot > tr > td {
  border: 1px solid #ddd;
}
.table-bordered > thead > tr > th,
.table-bordered > thead > tr > td {
  border-bottom-width: 2px;
}
.table-striped > tbody > tr:nth-of-type(odd) {
  background-color: #f9f9f9;
}
.table-hover > tbody > tr:hover {
  background-color: #f5f5f5;
}
table col[class*="col-"] {
  position: static;
  float: none;
  display: table-column;
}
table td[class*="col-"],
table th[class*="col-"] {
  position: static;
  float: none;
  display: table-cell;
}
.table > thead > tr > td.active,
.table > tbody > tr > td.active,
.table > tfoot > tr > td.active,
.table > thead > tr > th.active,
.table > tbody > tr > th.active,
.table > tfoot > tr > th.active,
.table > thead > tr.active > td,
.table > tbody > tr.active > td,
.table > tfoot > tr.active > td,
.table > thead > tr.active > th,
.table > tbody > tr.active > th,
.table > tfoot > tr.active > th {
  background-color: #f5f5f5;
}
.table-hover > tbody > tr > td.active:hover,
.table-hover > tbody > tr > th.active:hover,
.table-hover > tbody > tr.active:hover > td,
.table-hover > tbody > tr:hover > .active,
.table-hover > tbody > tr.active:hover > th {
  background-color: #e8e8e8;
}
.table > thead > tr > td.success,
.table > tbody > tr > td.success,
.table > tfoot > tr > td.success,
.table > thead > tr > th.success,
.table > tbody > tr > th.success,
.table > tfoot > tr > th.success,
.table > thead > tr.success > td,
.table > tbody > tr.success > td,
.table > tfoot > tr.success > td,
.table > thead > tr.success > th,
.table > tbody > tr.success > th,
.table > tfoot > tr.success > th {
  background-color: #dff0d8;
}
.table-hover > tbody > tr > td.success:hover,
.table-hover > tbody > tr > th.success:hover,
.table-hover > tbody > tr.success:hover > td,
.table-hover > tbody > tr:hover > .success,
.table-hover > tbody > tr.success:hover > th {
  background-color: #d0e9c6;
}
.table > thead > tr > td.info,
.table > tbody > tr > td.info,
.table > tfoot > tr > td.info,
.table > thead > tr > th.info,
.table > tbody > tr > th.info,
.table > tfoot > tr > th.info,
.table > thead > tr.info > td,
.table > tbody > tr.info > td,
.table > tfoot > tr.info > td,
.table > thead > tr.info > th,
.table > tbody > tr.info > th,
.table > tfoot > tr.info > th {
  background-color: #d9edf7;
}
.table-hover > tbody > tr > td.info:hover,
.table-hover > tbody > tr > th.info:hover,
.table-hover > tbody > tr.info:hover > td,
.table-hover > tbody > tr:hover > .info,
.table-hover > tbody > tr.info:hover > th {
  background-color: #c4e3f3;
}
.table > thead > tr > td.warning,
.table > tbody > tr > td.warning,
.table > tfoot > tr > td.warning,
.table > thead > tr > th.warning,
.table > tbody > tr > th.warning,
.table > tfoot > tr > th.warning,
.table > thead > tr.warning > td,
.table > tbody > tr.warning > td,
.table > tfoot > tr.warning > td,
.table > thead > tr.warning > th,
.table > tbody > tr.warning > th,
.table > tfoot > tr.warning > th {
  background-color: #fcf8e3;
}
.table-hover > tbody > tr > td.warning:hover,
.table-hover > tbody > tr > th.warning:hover,
.table-hover > tbody > tr.warning:hover > td,
.table-hover > tbody > tr:hover > .warning,
.table-hover > tbody > tr.warning:hover > th {
  background-color: #faf2cc;
}
.table > thead > tr > td.danger,
.table > tbody > tr > td.danger,
.table > tfoot > tr > td.danger,
.table > thead > tr > th.danger,
.table > tbody > tr > th.danger,
.table > tfoot > tr > th.danger,
.table > thead > tr.danger > td,
.table > tbody > tr.danger > td,
.table > tfoot > tr.danger > td,
.table > thead > tr.danger > th,
.table > tbody > tr.danger > th,
.table > tfoot > tr.danger > th {
  background-color: #f2dede;
}
.table-hover > tbody > tr > td.danger:hover,
.table-hover > tbody > tr > th.danger:hover,
.table-hover > tbody > tr.danger:hover > td,
.table-hover > tbody > tr:hover > .danger,
.table-hover > tbody > tr.danger:hover > th {
  background-color: #ebcccc;
}
.table-responsive {
  overflow-x: auto;
  min-height: 0.01%;
}
@media screen and (max-width: 767px) {
  .table-responsive {
    width: 100%;
    margin-bottom: 13.5px;
    overflow-y: hidden;
    -ms-overflow-style: -ms-autohiding-scrollbar;
    border: 1px solid #ddd;
  }
  .table-responsive > .table {
    margin-bottom: 0;
  }
  .table-responsive > .table > thead > tr > th,
  .table-responsive > .table > tbody > tr > th,
  .table-responsive > .table > tfoot > tr > th,
  .table-responsive > .table > thead > tr > td,
  .table-responsive > .table > tbody > tr > td,
  .table-responsive > .table > tfoot > tr > td {
    white-space: nowrap;
  }
  .table-responsive > .table-bordered {
    border: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:first-child,
  .table-responsive > .table-bordered > tbody > tr > th:first-child,
  .table-responsive > .table-bordered > tfoot > tr > th:first-child,
  .table-responsive > .table-bordered > thead > tr > td:first-child,
  .table-responsive > .table-bordered > tbody > tr > td:first-child,
  .table-responsive > .table-bordered > tfoot > tr > td:first-child {
    border-left: 0;
  }
  .table-responsive > .table-bordered > thead > tr > th:last-child,
  .table-responsive > .table-bordered > tbody > tr > th:last-child,
  .table-responsive > .table-bordered > tfoot > tr > th:last-child,
  .table-responsive > .table-bordered > thead > tr > td:last-child,
  .table-responsive > .table-bordered > tbody > tr > td:last-child,
  .table-responsive > .table-bordered > tfoot > tr > td:last-child {
    border-right: 0;
  }
  .table-responsive > .table-bordered > tbody > tr:last-child > th,
  .table-responsive > .table-bordered > tfoot > tr:last-child > th,
  .table-responsive > .table-bordered > tbody > tr:last-child > td,
  .table-responsive > .table-bordered > tfoot > tr:last-child > td {
    border-bottom: 0;
  }
}
fieldset {
  padding: 0;
  margin: 0;
  border: 0;
  min-width: 0;
}
legend {
  display: block;
  width: 100%;
  padding: 0;
  margin-bottom: 18px;
  font-size: 19.5px;
  line-height: inherit;
  color: #333333;
  border: 0;
  border-bottom: 1px solid #e5e5e5;
}
label {
  display: inline-block;
  max-width: 100%;
  margin-bottom: 5px;
  font-weight: bold;
}
input[type="search"] {
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
input[type="radio"],
input[type="checkbox"] {
  margin: 4px 0 0;
  margin-top: 1px \9;
  line-height: normal;
}
input[type="file"] {
  display: block;
}
input[type="range"] {
  display: block;
  width: 100%;
}
select[multiple],
select[size] {
  height: auto;
}
input[type="file"]:focus,
input[type="radio"]:focus,
input[type="checkbox"]:focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
output {
  display: block;
  padding-top: 7px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
}
.form-control {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
}
.form-control:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.form-control::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.form-control:-ms-input-placeholder {
  color: #999;
}
.form-control::-webkit-input-placeholder {
  color: #999;
}
.form-control::-ms-expand {
  border: 0;
  background-color: transparent;
}
.form-control[disabled],
.form-control[readonly],
fieldset[disabled] .form-control {
  background-color: #eeeeee;
  opacity: 1;
}
.form-control[disabled],
fieldset[disabled] .form-control {
  cursor: not-allowed;
}
textarea.form-control {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: none;
}
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  input[type="date"].form-control,
  input[type="time"].form-control,
  input[type="datetime-local"].form-control,
  input[type="month"].form-control {
    line-height: 32px;
  }
  input[type="date"].input-sm,
  input[type="time"].input-sm,
  input[type="datetime-local"].input-sm,
  input[type="month"].input-sm,
  .input-group-sm input[type="date"],
  .input-group-sm input[type="time"],
  .input-group-sm input[type="datetime-local"],
  .input-group-sm input[type="month"] {
    line-height: 30px;
  }
  input[type="date"].input-lg,
  input[type="time"].input-lg,
  input[type="datetime-local"].input-lg,
  input[type="month"].input-lg,
  .input-group-lg input[type="date"],
  .input-group-lg input[type="time"],
  .input-group-lg input[type="datetime-local"],
  .input-group-lg input[type="month"] {
    line-height: 45px;
  }
}
.form-group {
  margin-bottom: 15px;
}
.radio,
.checkbox {
  position: relative;
  display: block;
  margin-top: 10px;
  margin-bottom: 10px;
}
.radio label,
.checkbox label {
  min-height: 18px;
  padding-left: 20px;
  margin-bottom: 0;
  font-weight: normal;
  cursor: pointer;
}
.radio input[type="radio"],
.radio-inline input[type="radio"],
.checkbox input[type="checkbox"],
.checkbox-inline input[type="checkbox"] {
  position: absolute;
  margin-left: -20px;
  margin-top: 4px \9;
}
.radio + .radio,
.checkbox + .checkbox {
  margin-top: -5px;
}
.radio-inline,
.checkbox-inline {
  position: relative;
  display: inline-block;
  padding-left: 20px;
  margin-bottom: 0;
  vertical-align: middle;
  font-weight: normal;
  cursor: pointer;
}
.radio-inline + .radio-inline,
.checkbox-inline + .checkbox-inline {
  margin-top: 0;
  margin-left: 10px;
}
input[type="radio"][disabled],
input[type="checkbox"][disabled],
input[type="radio"].disabled,
input[type="checkbox"].disabled,
fieldset[disabled] input[type="radio"],
fieldset[disabled] input[type="checkbox"] {
  cursor: not-allowed;
}
.radio-inline.disabled,
.checkbox-inline.disabled,
fieldset[disabled] .radio-inline,
fieldset[disabled] .checkbox-inline {
  cursor: not-allowed;
}
.radio.disabled label,
.checkbox.disabled label,
fieldset[disabled] .radio label,
fieldset[disabled] .checkbox label {
  cursor: not-allowed;
}
.form-control-static {
  padding-top: 7px;
  padding-bottom: 7px;
  margin-bottom: 0;
  min-height: 31px;
}
.form-control-static.input-lg,
.form-control-static.input-sm {
  padding-left: 0;
  padding-right: 0;
}
.input-sm {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-sm {
  height: 30px;
  line-height: 30px;
}
textarea.input-sm,
select[multiple].input-sm {
  height: auto;
}
.form-group-sm .form-control {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.form-group-sm select.form-control {
  height: 30px;
  line-height: 30px;
}
.form-group-sm textarea.form-control,
.form-group-sm select[multiple].form-control {
  height: auto;
}
.form-group-sm .form-control-static {
  height: 30px;
  min-height: 30px;
  padding: 6px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.input-lg {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-lg {
  height: 45px;
  line-height: 45px;
}
textarea.input-lg,
select[multiple].input-lg {
  height: auto;
}
.form-group-lg .form-control {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.form-group-lg select.form-control {
  height: 45px;
  line-height: 45px;
}
.form-group-lg textarea.form-control,
.form-group-lg select[multiple].form-control {
  height: auto;
}
.form-group-lg .form-control-static {
  height: 45px;
  min-height: 35px;
  padding: 11px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.has-feedback {
  position: relative;
}
.has-feedback .form-control {
  padding-right: 40px;
}
.form-control-feedback {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 2;
  display: block;
  width: 32px;
  height: 32px;
  line-height: 32px;
  text-align: center;
  pointer-events: none;
}
.input-lg + .form-control-feedback,
.input-group-lg + .form-control-feedback,
.form-group-lg .form-control + .form-control-feedback {
  width: 45px;
  height: 45px;
  line-height: 45px;
}
.input-sm + .form-control-feedback,
.input-group-sm + .form-control-feedback,
.form-group-sm .form-control + .form-control-feedback {
  width: 30px;
  height: 30px;
  line-height: 30px;
}
.has-success .help-block,
.has-success .control-label,
.has-success .radio,
.has-success .checkbox,
.has-success .radio-inline,
.has-success .checkbox-inline,
.has-success.radio label,
.has-success.checkbox label,
.has-success.radio-inline label,
.has-success.checkbox-inline label {
  color: #3c763d;
}
.has-success .form-control {
  border-color: #3c763d;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-success .form-control:focus {
  border-color: #2b542c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #67b168;
}
.has-success .input-group-addon {
  color: #3c763d;
  border-color: #3c763d;
  background-color: #dff0d8;
}
.has-success .form-control-feedback {
  color: #3c763d;
}
.has-warning .help-block,
.has-warning .control-label,
.has-warning .radio,
.has-warning .checkbox,
.has-warning .radio-inline,
.has-warning .checkbox-inline,
.has-warning.radio label,
.has-warning.checkbox label,
.has-warning.radio-inline label,
.has-warning.checkbox-inline label {
  color: #8a6d3b;
}
.has-warning .form-control {
  border-color: #8a6d3b;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-warning .form-control:focus {
  border-color: #66512c;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #c0a16b;
}
.has-warning .input-group-addon {
  color: #8a6d3b;
  border-color: #8a6d3b;
  background-color: #fcf8e3;
}
.has-warning .form-control-feedback {
  color: #8a6d3b;
}
.has-error .help-block,
.has-error .control-label,
.has-error .radio,
.has-error .checkbox,
.has-error .radio-inline,
.has-error .checkbox-inline,
.has-error.radio label,
.has-error.checkbox label,
.has-error.radio-inline label,
.has-error.checkbox-inline label {
  color: #a94442;
}
.has-error .form-control {
  border-color: #a94442;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
}
.has-error .form-control:focus {
  border-color: #843534;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 6px #ce8483;
}
.has-error .input-group-addon {
  color: #a94442;
  border-color: #a94442;
  background-color: #f2dede;
}
.has-error .form-control-feedback {
  color: #a94442;
}
.has-feedback label ~ .form-control-feedback {
  top: 23px;
}
.has-feedback label.sr-only ~ .form-control-feedback {
  top: 0;
}
.help-block {
  display: block;
  margin-top: 5px;
  margin-bottom: 10px;
  color: #404040;
}
@media (min-width: 768px) {
  .form-inline .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .form-inline .form-control-static {
    display: inline-block;
  }
  .form-inline .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .form-inline .input-group .input-group-addon,
  .form-inline .input-group .input-group-btn,
  .form-inline .input-group .form-control {
    width: auto;
  }
  .form-inline .input-group > .form-control {
    width: 100%;
  }
  .form-inline .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio,
  .form-inline .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .form-inline .radio label,
  .form-inline .checkbox label {
    padding-left: 0;
  }
  .form-inline .radio input[type="radio"],
  .form-inline .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .form-inline .has-feedback .form-control-feedback {
    top: 0;
  }
}
.form-horizontal .radio,
.form-horizontal .checkbox,
.form-horizontal .radio-inline,
.form-horizontal .checkbox-inline {
  margin-top: 0;
  margin-bottom: 0;
  padding-top: 7px;
}
.form-horizontal .radio,
.form-horizontal .checkbox {
  min-height: 25px;
}
.form-horizontal .form-group {
  margin-left: 0px;
  margin-right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .control-label {
    text-align: right;
    margin-bottom: 0;
    padding-top: 7px;
  }
}
.form-horizontal .has-feedback .form-control-feedback {
  right: 0px;
}
@media (min-width: 768px) {
  .form-horizontal .form-group-lg .control-label {
    padding-top: 11px;
    font-size: 17px;
  }
}
@media (min-width: 768px) {
  .form-horizontal .form-group-sm .control-label {
    padding-top: 6px;
    font-size: 12px;
  }
}
.btn {
  display: inline-block;
  margin-bottom: 0;
  font-weight: normal;
  text-align: center;
  vertical-align: middle;
  touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  white-space: nowrap;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  border-radius: 2px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #333;
  text-decoration: none;
}
.btn:active,
.btn.active {
  outline: 0;
  background-image: none;
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  opacity: 0.65;
  filter: alpha(opacity=65);
  -webkit-box-shadow: none;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.btn-default:focus,
.btn-default.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.btn-default:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.btn-default:active:hover,
.btn-default.active:hover,
.open > .dropdown-toggle.btn-default:hover,
.btn-default:active:focus,
.btn-default.active:focus,
.open > .dropdown-toggle.btn-default:focus,
.btn-default:active.focus,
.btn-default.active.focus,
.open > .dropdown-toggle.btn-default.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.btn-default:active,
.btn-default.active,
.open > .dropdown-toggle.btn-default {
  background-image: none;
}
.btn-default.disabled:hover,
.btn-default[disabled]:hover,
fieldset[disabled] .btn-default:hover,
.btn-default.disabled:focus,
.btn-default[disabled]:focus,
fieldset[disabled] .btn-default:focus,
.btn-default.disabled.focus,
.btn-default[disabled].focus,
fieldset[disabled] .btn-default.focus {
  background-color: #fff;
  border-color: #ccc;
}
.btn-default .badge {
  color: #fff;
  background-color: #333;
}
.btn-primary {
  color: #fff;
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary:focus,
.btn-primary.focus {
  color: #fff;
  background-color: #286090;
  border-color: #122b40;
}
.btn-primary:hover {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  color: #fff;
  background-color: #286090;
  border-color: #204d74;
}
.btn-primary:active:hover,
.btn-primary.active:hover,
.open > .dropdown-toggle.btn-primary:hover,
.btn-primary:active:focus,
.btn-primary.active:focus,
.open > .dropdown-toggle.btn-primary:focus,
.btn-primary:active.focus,
.btn-primary.active.focus,
.open > .dropdown-toggle.btn-primary.focus {
  color: #fff;
  background-color: #204d74;
  border-color: #122b40;
}
.btn-primary:active,
.btn-primary.active,
.open > .dropdown-toggle.btn-primary {
  background-image: none;
}
.btn-primary.disabled:hover,
.btn-primary[disabled]:hover,
fieldset[disabled] .btn-primary:hover,
.btn-primary.disabled:focus,
.btn-primary[disabled]:focus,
fieldset[disabled] .btn-primary:focus,
.btn-primary.disabled.focus,
.btn-primary[disabled].focus,
fieldset[disabled] .btn-primary.focus {
  background-color: #337ab7;
  border-color: #2e6da4;
}
.btn-primary .badge {
  color: #337ab7;
  background-color: #fff;
}
.btn-success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success:focus,
.btn-success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.btn-success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.btn-success:active:hover,
.btn-success.active:hover,
.open > .dropdown-toggle.btn-success:hover,
.btn-success:active:focus,
.btn-success.active:focus,
.open > .dropdown-toggle.btn-success:focus,
.btn-success:active.focus,
.btn-success.active.focus,
.open > .dropdown-toggle.btn-success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.btn-success:active,
.btn-success.active,
.open > .dropdown-toggle.btn-success {
  background-image: none;
}
.btn-success.disabled:hover,
.btn-success[disabled]:hover,
fieldset[disabled] .btn-success:hover,
.btn-success.disabled:focus,
.btn-success[disabled]:focus,
fieldset[disabled] .btn-success:focus,
.btn-success.disabled.focus,
.btn-success[disabled].focus,
fieldset[disabled] .btn-success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.btn-success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.btn-info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info:focus,
.btn-info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.btn-info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.btn-info:active:hover,
.btn-info.active:hover,
.open > .dropdown-toggle.btn-info:hover,
.btn-info:active:focus,
.btn-info.active:focus,
.open > .dropdown-toggle.btn-info:focus,
.btn-info:active.focus,
.btn-info.active.focus,
.open > .dropdown-toggle.btn-info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.btn-info:active,
.btn-info.active,
.open > .dropdown-toggle.btn-info {
  background-image: none;
}
.btn-info.disabled:hover,
.btn-info[disabled]:hover,
fieldset[disabled] .btn-info:hover,
.btn-info.disabled:focus,
.btn-info[disabled]:focus,
fieldset[disabled] .btn-info:focus,
.btn-info.disabled.focus,
.btn-info[disabled].focus,
fieldset[disabled] .btn-info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.btn-info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.btn-warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning:focus,
.btn-warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.btn-warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.btn-warning:active:hover,
.btn-warning.active:hover,
.open > .dropdown-toggle.btn-warning:hover,
.btn-warning:active:focus,
.btn-warning.active:focus,
.open > .dropdown-toggle.btn-warning:focus,
.btn-warning:active.focus,
.btn-warning.active.focus,
.open > .dropdown-toggle.btn-warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.btn-warning:active,
.btn-warning.active,
.open > .dropdown-toggle.btn-warning {
  background-image: none;
}
.btn-warning.disabled:hover,
.btn-warning[disabled]:hover,
fieldset[disabled] .btn-warning:hover,
.btn-warning.disabled:focus,
.btn-warning[disabled]:focus,
fieldset[disabled] .btn-warning:focus,
.btn-warning.disabled.focus,
.btn-warning[disabled].focus,
fieldset[disabled] .btn-warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.btn-warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.btn-danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger:focus,
.btn-danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.btn-danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.btn-danger:active:hover,
.btn-danger.active:hover,
.open > .dropdown-toggle.btn-danger:hover,
.btn-danger:active:focus,
.btn-danger.active:focus,
.open > .dropdown-toggle.btn-danger:focus,
.btn-danger:active.focus,
.btn-danger.active.focus,
.open > .dropdown-toggle.btn-danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.btn-danger:active,
.btn-danger.active,
.open > .dropdown-toggle.btn-danger {
  background-image: none;
}
.btn-danger.disabled:hover,
.btn-danger[disabled]:hover,
fieldset[disabled] .btn-danger:hover,
.btn-danger.disabled:focus,
.btn-danger[disabled]:focus,
fieldset[disabled] .btn-danger:focus,
.btn-danger.disabled.focus,
.btn-danger[disabled].focus,
fieldset[disabled] .btn-danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.btn-danger .badge {
  color: #d9534f;
  background-color: #fff;
}
.btn-link {
  color: #337ab7;
  font-weight: normal;
  border-radius: 0;
}
.btn-link,
.btn-link:active,
.btn-link.active,
.btn-link[disabled],
fieldset[disabled] .btn-link {
  background-color: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn-link,
.btn-link:hover,
.btn-link:focus,
.btn-link:active {
  border-color: transparent;
}
.btn-link:hover,
.btn-link:focus {
  color: #23527c;
  text-decoration: underline;
  background-color: transparent;
}
.btn-link[disabled]:hover,
fieldset[disabled] .btn-link:hover,
.btn-link[disabled]:focus,
fieldset[disabled] .btn-link:focus {
  color: #777777;
  text-decoration: none;
}
.btn-lg,
.btn-group-lg > .btn {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
.btn-sm,
.btn-group-sm > .btn {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-xs,
.btn-group-xs > .btn {
  padding: 1px 5px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
.btn-block {
  display: block;
  width: 100%;
}
.btn-block + .btn-block {
  margin-top: 5px;
}
input[type="submit"].btn-block,
input[type="reset"].btn-block,
input[type="button"].btn-block {
  width: 100%;
}
.fade {
  opacity: 0;
  -webkit-transition: opacity 0.15s linear;
  -o-transition: opacity 0.15s linear;
  transition: opacity 0.15s linear;
}
.fade.in {
  opacity: 1;
}
.collapse {
  display: none;
}
.collapse.in {
  display: block;
}
tr.collapse.in {
  display: table-row;
}
tbody.collapse.in {
  display: table-row-group;
}
.collapsing {
  position: relative;
  height: 0;
  overflow: hidden;
  -webkit-transition-property: height, visibility;
  transition-property: height, visibility;
  -webkit-transition-duration: 0.35s;
  transition-duration: 0.35s;
  -webkit-transition-timing-function: ease;
  transition-timing-function: ease;
}
.caret {
  display: inline-block;
  width: 0;
  height: 0;
  margin-left: 2px;
  vertical-align: middle;
  border-top: 4px dashed;
  border-top: 4px solid \9;
  border-right: 4px solid transparent;
  border-left: 4px solid transparent;
}
.dropup,
.dropdown {
  position: relative;
}
.dropdown-toggle:focus {
  outline: 0;
}
.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  float: left;
  min-width: 160px;
  padding: 5px 0;
  margin: 2px 0 0;
  list-style: none;
  font-size: 13px;
  text-align: left;
  background-color: #fff;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175);
  background-clip: padding-box;
}
.dropdown-menu.pull-right {
  right: 0;
  left: auto;
}
.dropdown-menu .divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: normal;
  line-height: 1.42857143;
  color: #333333;
  white-space: nowrap;
}
.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  text-decoration: none;
  color: #262626;
  background-color: #f5f5f5;
}
.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #fff;
  text-decoration: none;
  outline: 0;
  background-color: #337ab7;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #777777;
}
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  cursor: not-allowed;
}
.open > .dropdown-menu {
  display: block;
}
.open > a {
  outline: 0;
}
.dropdown-menu-right {
  left: auto;
  right: 0;
}
.dropdown-menu-left {
  left: 0;
  right: auto;
}
.dropdown-header {
  display: block;
  padding: 3px 20px;
  font-size: 12px;
  line-height: 1.42857143;
  color: #777777;
  white-space: nowrap;
}
.dropdown-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 990;
}
.pull-right > .dropdown-menu {
  right: 0;
  left: auto;
}
.dropup .caret,
.navbar-fixed-bottom .dropdown .caret {
  border-top: 0;
  border-bottom: 4px dashed;
  border-bottom: 4px solid \9;
  content: "";
}
.dropup .dropdown-menu,
.navbar-fixed-bottom .dropdown .dropdown-menu {
  top: auto;
  bottom: 100%;
  margin-bottom: 2px;
}
@media (min-width: 541px) {
  .navbar-right .dropdown-menu {
    left: auto;
    right: 0;
  }
  .navbar-right .dropdown-menu-left {
    left: 0;
    right: auto;
  }
}
.btn-group,
.btn-group-vertical {
  position: relative;
  display: inline-block;
  vertical-align: middle;
}
.btn-group > .btn,
.btn-group-vertical > .btn {
  position: relative;
  float: left;
}
.btn-group > .btn:hover,
.btn-group-vertical > .btn:hover,
.btn-group > .btn:focus,
.btn-group-vertical > .btn:focus,
.btn-group > .btn:active,
.btn-group-vertical > .btn:active,
.btn-group > .btn.active,
.btn-group-vertical > .btn.active {
  z-index: 2;
}
.btn-group .btn + .btn,
.btn-group .btn + .btn-group,
.btn-group .btn-group + .btn,
.btn-group .btn-group + .btn-group {
  margin-left: -1px;
}
.btn-toolbar {
  margin-left: -5px;
}
.btn-toolbar .btn,
.btn-toolbar .btn-group,
.btn-toolbar .input-group {
  float: left;
}
.btn-toolbar > .btn,
.btn-toolbar > .btn-group,
.btn-toolbar > .input-group {
  margin-left: 5px;
}
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-left: 8px;
  padding-right: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-left: 12px;
  padding-right: 12px;
}
.btn-group.open .dropdown-toggle {
  -webkit-box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  -webkit-box-shadow: none;
  box-shadow: none;
}
.btn .caret {
  margin-left: 0;
}
.btn-lg .caret {
  border-width: 5px 5px 0;
  border-bottom-width: 0;
}
.dropup .btn-lg .caret {
  border-width: 0 5px 5px;
}
.btn-group-vertical > .btn,
.btn-group-vertical > .btn-group,
.btn-group-vertical > .btn-group > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
}
.btn-group-vertical > .btn-group > .btn {
  float: none;
}
.btn-group-vertical > .btn + .btn,
.btn-group-vertical > .btn + .btn-group,
.btn-group-vertical > .btn-group + .btn,
.btn-group-vertical > .btn-group + .btn-group {
  margin-top: -1px;
  margin-left: 0;
}
.btn-group-vertical > .btn:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.btn-group-vertical > .btn:first-child:not(:last-child) {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn:last-child:not(:first-child) {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
.btn-group-vertical > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group-vertical > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group-vertical > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.btn-group-justified {
  display: table;
  width: 100%;
  table-layout: fixed;
  border-collapse: separate;
}
.btn-group-justified > .btn,
.btn-group-justified > .btn-group {
  float: none;
  display: table-cell;
  width: 1%;
}
.btn-group-justified > .btn-group .btn {
  width: 100%;
}
.btn-group-justified > .btn-group .dropdown-menu {
  left: auto;
}
[data-toggle="buttons"] > .btn input[type="radio"],
[data-toggle="buttons"] > .btn-group > .btn input[type="radio"],
[data-toggle="buttons"] > .btn input[type="checkbox"],
[data-toggle="buttons"] > .btn-group > .btn input[type="checkbox"] {
  position: absolute;
  clip: rect(0, 0, 0, 0);
  pointer-events: none;
}
.input-group {
  position: relative;
  display: table;
  border-collapse: separate;
}
.input-group[class*="col-"] {
  float: none;
  padding-left: 0;
  padding-right: 0;
}
.input-group .form-control {
  position: relative;
  z-index: 2;
  float: left;
  width: 100%;
  margin-bottom: 0;
}
.input-group .form-control:focus {
  z-index: 3;
}
.input-group-lg > .form-control,
.input-group-lg > .input-group-addon,
.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
  border-radius: 3px;
}
select.input-group-lg > .form-control,
select.input-group-lg > .input-group-addon,
select.input-group-lg > .input-group-btn > .btn {
  height: 45px;
  line-height: 45px;
}
textarea.input-group-lg > .form-control,
textarea.input-group-lg > .input-group-addon,
textarea.input-group-lg > .input-group-btn > .btn,
select[multiple].input-group-lg > .form-control,
select[multiple].input-group-lg > .input-group-addon,
select[multiple].input-group-lg > .input-group-btn > .btn {
  height: auto;
}
.input-group-sm > .form-control,
.input-group-sm > .input-group-addon,
.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
}
select.input-group-sm > .form-control,
select.input-group-sm > .input-group-addon,
select.input-group-sm > .input-group-btn > .btn {
  height: 30px;
  line-height: 30px;
}
textarea.input-group-sm > .form-control,
textarea.input-group-sm > .input-group-addon,
textarea.input-group-sm > .input-group-btn > .btn,
select[multiple].input-group-sm > .form-control,
select[multiple].input-group-sm > .input-group-addon,
select[multiple].input-group-sm > .input-group-btn > .btn {
  height: auto;
}
.input-group-addon,
.input-group-btn,
.input-group .form-control {
  display: table-cell;
}
.input-group-addon:not(:first-child):not(:last-child),
.input-group-btn:not(:first-child):not(:last-child),
.input-group .form-control:not(:first-child):not(:last-child) {
  border-radius: 0;
}
.input-group-addon,
.input-group-btn {
  width: 1%;
  white-space: nowrap;
  vertical-align: middle;
}
.input-group-addon {
  padding: 6px 12px;
  font-size: 13px;
  font-weight: normal;
  line-height: 1;
  color: #555555;
  text-align: center;
  background-color: #eeeeee;
  border: 1px solid #ccc;
  border-radius: 2px;
}
.input-group-addon.input-sm {
  padding: 5px 10px;
  font-size: 12px;
  border-radius: 1px;
}
.input-group-addon.input-lg {
  padding: 10px 16px;
  font-size: 17px;
  border-radius: 3px;
}
.input-group-addon input[type="radio"],
.input-group-addon input[type="checkbox"] {
  margin-top: 0;
}
.input-group .form-control:first-child,
.input-group-addon:first-child,
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group > .btn,
.input-group-btn:first-child > .dropdown-toggle,
.input-group-btn:last-child > .btn:not(:last-child):not(.dropdown-toggle),
.input-group-btn:last-child > .btn-group:not(:last-child) > .btn {
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
.input-group-addon:first-child {
  border-right: 0;
}
.input-group .form-control:last-child,
.input-group-addon:last-child,
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group > .btn,
.input-group-btn:last-child > .dropdown-toggle,
.input-group-btn:first-child > .btn:not(:first-child),
.input-group-btn:first-child > .btn-group:not(:first-child) > .btn {
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
.input-group-addon:last-child {
  border-left: 0;
}
.input-group-btn {
  position: relative;
  font-size: 0;
  white-space: nowrap;
}
.input-group-btn > .btn {
  position: relative;
}
.input-group-btn > .btn + .btn {
  margin-left: -1px;
}
.input-group-btn > .btn:hover,
.input-group-btn > .btn:focus,
.input-group-btn > .btn:active {
  z-index: 2;
}
.input-group-btn:first-child > .btn,
.input-group-btn:first-child > .btn-group {
  margin-right: -1px;
}
.input-group-btn:last-child > .btn,
.input-group-btn:last-child > .btn-group {
  z-index: 2;
  margin-left: -1px;
}
.nav {
  margin-bottom: 0;
  padding-left: 0;
  list-style: none;
}
.nav > li {
  position: relative;
  display: block;
}
.nav > li > a {
  position: relative;
  display: block;
  padding: 10px 15px;
}
.nav > li > a:hover,
.nav > li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.nav > li.disabled > a {
  color: #777777;
}
.nav > li.disabled > a:hover,
.nav > li.disabled > a:focus {
  color: #777777;
  text-decoration: none;
  background-color: transparent;
  cursor: not-allowed;
}
.nav .open > a,
.nav .open > a:hover,
.nav .open > a:focus {
  background-color: #eeeeee;
  border-color: #337ab7;
}
.nav .nav-divider {
  height: 1px;
  margin: 8px 0;
  overflow: hidden;
  background-color: #e5e5e5;
}
.nav > li > a > img {
  max-width: none;
}
.nav-tabs {
  border-bottom: 1px solid #ddd;
}
.nav-tabs > li {
  float: left;
  margin-bottom: -1px;
}
.nav-tabs > li > a {
  margin-right: 2px;
  line-height: 1.42857143;
  border: 1px solid transparent;
  border-radius: 2px 2px 0 0;
}
.nav-tabs > li > a:hover {
  border-color: #eeeeee #eeeeee #ddd;
}
.nav-tabs > li.active > a,
.nav-tabs > li.active > a:hover,
.nav-tabs > li.active > a:focus {
  color: #555555;
  background-color: #fff;
  border: 1px solid #ddd;
  border-bottom-color: transparent;
  cursor: default;
}
.nav-tabs.nav-justified {
  width: 100%;
  border-bottom: 0;
}
.nav-tabs.nav-justified > li {
  float: none;
}
.nav-tabs.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-tabs.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-tabs.nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs.nav-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs.nav-justified > .active > a,
.nav-tabs.nav-justified > .active > a:hover,
.nav-tabs.nav-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs.nav-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs.nav-justified > .active > a,
  .nav-tabs.nav-justified > .active > a:hover,
  .nav-tabs.nav-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.nav-pills > li {
  float: left;
}
.nav-pills > li > a {
  border-radius: 2px;
}
.nav-pills > li + li {
  margin-left: 2px;
}
.nav-pills > li.active > a,
.nav-pills > li.active > a:hover,
.nav-pills > li.active > a:focus {
  color: #fff;
  background-color: #337ab7;
}
.nav-stacked > li {
  float: none;
}
.nav-stacked > li + li {
  margin-top: 2px;
  margin-left: 0;
}
.nav-justified {
  width: 100%;
}
.nav-justified > li {
  float: none;
}
.nav-justified > li > a {
  text-align: center;
  margin-bottom: 5px;
}
.nav-justified > .dropdown .dropdown-menu {
  top: auto;
  left: auto;
}
@media (min-width: 768px) {
  .nav-justified > li {
    display: table-cell;
    width: 1%;
  }
  .nav-justified > li > a {
    margin-bottom: 0;
  }
}
.nav-tabs-justified {
  border-bottom: 0;
}
.nav-tabs-justified > li > a {
  margin-right: 0;
  border-radius: 2px;
}
.nav-tabs-justified > .active > a,
.nav-tabs-justified > .active > a:hover,
.nav-tabs-justified > .active > a:focus {
  border: 1px solid #ddd;
}
@media (min-width: 768px) {
  .nav-tabs-justified > li > a {
    border-bottom: 1px solid #ddd;
    border-radius: 2px 2px 0 0;
  }
  .nav-tabs-justified > .active > a,
  .nav-tabs-justified > .active > a:hover,
  .nav-tabs-justified > .active > a:focus {
    border-bottom-color: #fff;
  }
}
.tab-content > .tab-pane {
  display: none;
}
.tab-content > .active {
  display: block;
}
.nav-tabs .dropdown-menu {
  margin-top: -1px;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar {
  position: relative;
  min-height: 30px;
  margin-bottom: 18px;
  border: 1px solid transparent;
}
@media (min-width: 541px) {
  .navbar {
    border-radius: 2px;
  }
}
@media (min-width: 541px) {
  .navbar-header {
    float: left;
  }
}
.navbar-collapse {
  overflow-x: visible;
  padding-right: 0px;
  padding-left: 0px;
  border-top: 1px solid transparent;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
  -webkit-overflow-scrolling: touch;
}
.navbar-collapse.in {
  overflow-y: auto;
}
@media (min-width: 541px) {
  .navbar-collapse {
    width: auto;
    border-top: 0;
    box-shadow: none;
  }
  .navbar-collapse.collapse {
    display: block !important;
    height: auto !important;
    padding-bottom: 0;
    overflow: visible !important;
  }
  .navbar-collapse.in {
    overflow-y: visible;
  }
  .navbar-fixed-top .navbar-collapse,
  .navbar-static-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    padding-left: 0;
    padding-right: 0;
  }
}
.navbar-fixed-top .navbar-collapse,
.navbar-fixed-bottom .navbar-collapse {
  max-height: 340px;
}
@media (max-device-width: 540px) and (orientation: landscape) {
  .navbar-fixed-top .navbar-collapse,
  .navbar-fixed-bottom .navbar-collapse {
    max-height: 200px;
  }
}
.container > .navbar-header,
.container-fluid > .navbar-header,
.container > .navbar-collapse,
.container-fluid > .navbar-collapse {
  margin-right: 0px;
  margin-left: 0px;
}
@media (min-width: 541px) {
  .container > .navbar-header,
  .container-fluid > .navbar-header,
  .container > .navbar-collapse,
  .container-fluid > .navbar-collapse {
    margin-right: 0;
    margin-left: 0;
  }
}
.navbar-static-top {
  z-index: 1000;
  border-width: 0 0 1px;
}
@media (min-width: 541px) {
  .navbar-static-top {
    border-radius: 0;
  }
}
.navbar-fixed-top,
.navbar-fixed-bottom {
  position: fixed;
  right: 0;
  left: 0;
  z-index: 1030;
}
@media (min-width: 541px) {
  .navbar-fixed-top,
  .navbar-fixed-bottom {
    border-radius: 0;
  }
}
.navbar-fixed-top {
  top: 0;
  border-width: 0 0 1px;
}
.navbar-fixed-bottom {
  bottom: 0;
  margin-bottom: 0;
  border-width: 1px 0 0;
}
.navbar-brand {
  float: left;
  padding: 6px 0px;
  font-size: 17px;
  line-height: 18px;
  height: 30px;
}
.navbar-brand:hover,
.navbar-brand:focus {
  text-decoration: none;
}
.navbar-brand > img {
  display: block;
}
@media (min-width: 541px) {
  .navbar > .container .navbar-brand,
  .navbar > .container-fluid .navbar-brand {
    margin-left: 0px;
  }
}
.navbar-toggle {
  position: relative;
  float: right;
  margin-right: 0px;
  padding: 9px 10px;
  margin-top: -2px;
  margin-bottom: -2px;
  background-color: transparent;
  background-image: none;
  border: 1px solid transparent;
  border-radius: 2px;
}
.navbar-toggle:focus {
  outline: 0;
}
.navbar-toggle .icon-bar {
  display: block;
  width: 22px;
  height: 2px;
  border-radius: 1px;
}
.navbar-toggle .icon-bar + .icon-bar {
  margin-top: 4px;
}
@media (min-width: 541px) {
  .navbar-toggle {
    display: none;
  }
}
.navbar-nav {
  margin: 3px 0px;
}
.navbar-nav > li > a {
  padding-top: 10px;
  padding-bottom: 10px;
  line-height: 18px;
}
@media (max-width: 540px) {
  .navbar-nav .open .dropdown-menu {
    position: static;
    float: none;
    width: auto;
    margin-top: 0;
    background-color: transparent;
    border: 0;
    box-shadow: none;
  }
  .navbar-nav .open .dropdown-menu > li > a,
  .navbar-nav .open .dropdown-menu .dropdown-header {
    padding: 5px 15px 5px 25px;
  }
  .navbar-nav .open .dropdown-menu > li > a {
    line-height: 18px;
  }
  .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-nav .open .dropdown-menu > li > a:focus {
    background-image: none;
  }
}
@media (min-width: 541px) {
  .navbar-nav {
    float: left;
    margin: 0;
  }
  .navbar-nav > li {
    float: left;
  }
  .navbar-nav > li > a {
    padding-top: 6px;
    padding-bottom: 6px;
  }
}
.navbar-form {
  margin-left: 0px;
  margin-right: 0px;
  padding: 10px 0px;
  border-top: 1px solid transparent;
  border-bottom: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.1);
  margin-top: -1px;
  margin-bottom: -1px;
}
@media (min-width: 768px) {
  .navbar-form .form-group {
    display: inline-block;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .form-control {
    display: inline-block;
    width: auto;
    vertical-align: middle;
  }
  .navbar-form .form-control-static {
    display: inline-block;
  }
  .navbar-form .input-group {
    display: inline-table;
    vertical-align: middle;
  }
  .navbar-form .input-group .input-group-addon,
  .navbar-form .input-group .input-group-btn,
  .navbar-form .input-group .form-control {
    width: auto;
  }
  .navbar-form .input-group > .form-control {
    width: 100%;
  }
  .navbar-form .control-label {
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio,
  .navbar-form .checkbox {
    display: inline-block;
    margin-top: 0;
    margin-bottom: 0;
    vertical-align: middle;
  }
  .navbar-form .radio label,
  .navbar-form .checkbox label {
    padding-left: 0;
  }
  .navbar-form .radio input[type="radio"],
  .navbar-form .checkbox input[type="checkbox"] {
    position: relative;
    margin-left: 0;
  }
  .navbar-form .has-feedback .form-control-feedback {
    top: 0;
  }
}
@media (max-width: 540px) {
  .navbar-form .form-group {
    margin-bottom: 5px;
  }
  .navbar-form .form-group:last-child {
    margin-bottom: 0;
  }
}
@media (min-width: 541px) {
  .navbar-form {
    width: auto;
    border: 0;
    margin-left: 0;
    margin-right: 0;
    padding-top: 0;
    padding-bottom: 0;
    -webkit-box-shadow: none;
    box-shadow: none;
  }
}
.navbar-nav > li > .dropdown-menu {
  margin-top: 0;
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.navbar-fixed-bottom .navbar-nav > li > .dropdown-menu {
  margin-bottom: 0;
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.navbar-btn {
  margin-top: -1px;
  margin-bottom: -1px;
}
.navbar-btn.btn-sm {
  margin-top: 0px;
  margin-bottom: 0px;
}
.navbar-btn.btn-xs {
  margin-top: 4px;
  margin-bottom: 4px;
}
.navbar-text {
  margin-top: 6px;
  margin-bottom: 6px;
}
@media (min-width: 541px) {
  .navbar-text {
    float: left;
    margin-left: 0px;
    margin-right: 0px;
  }
}
@media (min-width: 541px) {
  .navbar-left {
    float: left !important;
    float: left;
  }
  .navbar-right {
    float: right !important;
    float: right;
    margin-right: 0px;
  }
  .navbar-right ~ .navbar-right {
    margin-right: 0;
  }
}
.navbar-default {
  background-color: #f8f8f8;
  border-color: #e7e7e7;
}
.navbar-default .navbar-brand {
  color: #777;
}
.navbar-default .navbar-brand:hover,
.navbar-default .navbar-brand:focus {
  color: #5e5e5e;
  background-color: transparent;
}
.navbar-default .navbar-text {
  color: #777;
}
.navbar-default .navbar-nav > li > a {
  color: #777;
}
.navbar-default .navbar-nav > li > a:hover,
.navbar-default .navbar-nav > li > a:focus {
  color: #333;
  background-color: transparent;
}
.navbar-default .navbar-nav > .active > a,
.navbar-default .navbar-nav > .active > a:hover,
.navbar-default .navbar-nav > .active > a:focus {
  color: #555;
  background-color: #e7e7e7;
}
.navbar-default .navbar-nav > .disabled > a,
.navbar-default .navbar-nav > .disabled > a:hover,
.navbar-default .navbar-nav > .disabled > a:focus {
  color: #ccc;
  background-color: transparent;
}
.navbar-default .navbar-toggle {
  border-color: #ddd;
}
.navbar-default .navbar-toggle:hover,
.navbar-default .navbar-toggle:focus {
  background-color: #ddd;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #888;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #e7e7e7;
}
.navbar-default .navbar-nav > .open > a,
.navbar-default .navbar-nav > .open > a:hover,
.navbar-default .navbar-nav > .open > a:focus {
  background-color: #e7e7e7;
  color: #555;
}
@media (max-width: 540px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #777;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #333;
    background-color: transparent;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #555;
    background-color: #e7e7e7;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-default .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #ccc;
    background-color: transparent;
  }
}
.navbar-default .navbar-link {
  color: #777;
}
.navbar-default .navbar-link:hover {
  color: #333;
}
.navbar-default .btn-link {
  color: #777;
}
.navbar-default .btn-link:hover,
.navbar-default .btn-link:focus {
  color: #333;
}
.navbar-default .btn-link[disabled]:hover,
fieldset[disabled] .navbar-default .btn-link:hover,
.navbar-default .btn-link[disabled]:focus,
fieldset[disabled] .navbar-default .btn-link:focus {
  color: #ccc;
}
.navbar-inverse {
  background-color: #222;
  border-color: #080808;
}
.navbar-inverse .navbar-brand {
  color: #9d9d9d;
}
.navbar-inverse .navbar-brand:hover,
.navbar-inverse .navbar-brand:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-text {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a {
  color: #9d9d9d;
}
.navbar-inverse .navbar-nav > li > a:hover,
.navbar-inverse .navbar-nav > li > a:focus {
  color: #fff;
  background-color: transparent;
}
.navbar-inverse .navbar-nav > .active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus {
  color: #fff;
  background-color: #080808;
}
.navbar-inverse .navbar-nav > .disabled > a,
.navbar-inverse .navbar-nav > .disabled > a:hover,
.navbar-inverse .navbar-nav > .disabled > a:focus {
  color: #444;
  background-color: transparent;
}
.navbar-inverse .navbar-toggle {
  border-color: #333;
}
.navbar-inverse .navbar-toggle:hover,
.navbar-inverse .navbar-toggle:focus {
  background-color: #333;
}
.navbar-inverse .navbar-toggle .icon-bar {
  background-color: #fff;
}
.navbar-inverse .navbar-collapse,
.navbar-inverse .navbar-form {
  border-color: #101010;
}
.navbar-inverse .navbar-nav > .open > a,
.navbar-inverse .navbar-nav > .open > a:hover,
.navbar-inverse .navbar-nav > .open > a:focus {
  background-color: #080808;
  color: #fff;
}
@media (max-width: 540px) {
  .navbar-inverse .navbar-nav .open .dropdown-menu > .dropdown-header {
    border-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu .divider {
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a {
    color: #9d9d9d;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #fff;
    background-color: transparent;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #fff;
    background-color: #080808;
  }
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:hover,
  .navbar-inverse .navbar-nav .open .dropdown-menu > .disabled > a:focus {
    color: #444;
    background-color: transparent;
  }
}
.navbar-inverse .navbar-link {
  color: #9d9d9d;
}
.navbar-inverse .navbar-link:hover {
  color: #fff;
}
.navbar-inverse .btn-link {
  color: #9d9d9d;
}
.navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link:focus {
  color: #fff;
}
.navbar-inverse .btn-link[disabled]:hover,
fieldset[disabled] .navbar-inverse .btn-link:hover,
.navbar-inverse .btn-link[disabled]:focus,
fieldset[disabled] .navbar-inverse .btn-link:focus {
  color: #444;
}
.breadcrumb {
  padding: 8px 15px;
  margin-bottom: 18px;
  list-style: none;
  background-color: #f5f5f5;
  border-radius: 2px;
}
.breadcrumb > li {
  display: inline-block;
}
.breadcrumb > li + li:before {
  content: "/\00a0";
  padding: 0 5px;
  color: #5e5e5e;
}
.breadcrumb > .active {
  color: #777777;
}
.pagination {
  display: inline-block;
  padding-left: 0;
  margin: 18px 0;
  border-radius: 2px;
}
.pagination > li {
  display: inline;
}
.pagination > li > a,
.pagination > li > span {
  position: relative;
  float: left;
  padding: 6px 12px;
  line-height: 1.42857143;
  text-decoration: none;
  color: #337ab7;
  background-color: #fff;
  border: 1px solid #ddd;
  margin-left: -1px;
}
.pagination > li:first-child > a,
.pagination > li:first-child > span {
  margin-left: 0;
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.pagination > li:last-child > a,
.pagination > li:last-child > span {
  border-bottom-right-radius: 2px;
  border-top-right-radius: 2px;
}
.pagination > li > a:hover,
.pagination > li > span:hover,
.pagination > li > a:focus,
.pagination > li > span:focus {
  z-index: 2;
  color: #23527c;
  background-color: #eeeeee;
  border-color: #ddd;
}
.pagination > .active > a,
.pagination > .active > span,
.pagination > .active > a:hover,
.pagination > .active > span:hover,
.pagination > .active > a:focus,
.pagination > .active > span:focus {
  z-index: 3;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
  cursor: default;
}
.pagination > .disabled > span,
.pagination > .disabled > span:hover,
.pagination > .disabled > span:focus,
.pagination > .disabled > a,
.pagination > .disabled > a:hover,
.pagination > .disabled > a:focus {
  color: #777777;
  background-color: #fff;
  border-color: #ddd;
  cursor: not-allowed;
}
.pagination-lg > li > a,
.pagination-lg > li > span {
  padding: 10px 16px;
  font-size: 17px;
  line-height: 1.3333333;
}
.pagination-lg > li:first-child > a,
.pagination-lg > li:first-child > span {
  border-bottom-left-radius: 3px;
  border-top-left-radius: 3px;
}
.pagination-lg > li:last-child > a,
.pagination-lg > li:last-child > span {
  border-bottom-right-radius: 3px;
  border-top-right-radius: 3px;
}
.pagination-sm > li > a,
.pagination-sm > li > span {
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
}
.pagination-sm > li:first-child > a,
.pagination-sm > li:first-child > span {
  border-bottom-left-radius: 1px;
  border-top-left-radius: 1px;
}
.pagination-sm > li:last-child > a,
.pagination-sm > li:last-child > span {
  border-bottom-right-radius: 1px;
  border-top-right-radius: 1px;
}
.pager {
  padding-left: 0;
  margin: 18px 0;
  list-style: none;
  text-align: center;
}
.pager li {
  display: inline;
}
.pager li > a,
.pager li > span {
  display: inline-block;
  padding: 5px 14px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 15px;
}
.pager li > a:hover,
.pager li > a:focus {
  text-decoration: none;
  background-color: #eeeeee;
}
.pager .next > a,
.pager .next > span {
  float: right;
}
.pager .previous > a,
.pager .previous > span {
  float: left;
}
.pager .disabled > a,
.pager .disabled > a:hover,
.pager .disabled > a:focus,
.pager .disabled > span {
  color: #777777;
  background-color: #fff;
  cursor: not-allowed;
}
.label {
  display: inline;
  padding: .2em .6em .3em;
  font-size: 75%;
  font-weight: bold;
  line-height: 1;
  color: #fff;
  text-align: center;
  white-space: nowrap;
  vertical-align: baseline;
  border-radius: .25em;
}
a.label:hover,
a.label:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.label:empty {
  display: none;
}
.btn .label {
  position: relative;
  top: -1px;
}
.label-default {
  background-color: #777777;
}
.label-default[href]:hover,
.label-default[href]:focus {
  background-color: #5e5e5e;
}
.label-primary {
  background-color: #337ab7;
}
.label-primary[href]:hover,
.label-primary[href]:focus {
  background-color: #286090;
}
.label-success {
  background-color: #5cb85c;
}
.label-success[href]:hover,
.label-success[href]:focus {
  background-color: #449d44;
}
.label-info {
  background-color: #5bc0de;
}
.label-info[href]:hover,
.label-info[href]:focus {
  background-color: #31b0d5;
}
.label-warning {
  background-color: #f0ad4e;
}
.label-warning[href]:hover,
.label-warning[href]:focus {
  background-color: #ec971f;
}
.label-danger {
  background-color: #d9534f;
}
.label-danger[href]:hover,
.label-danger[href]:focus {
  background-color: #c9302c;
}
.badge {
  display: inline-block;
  min-width: 10px;
  padding: 3px 7px;
  font-size: 12px;
  font-weight: bold;
  color: #fff;
  line-height: 1;
  vertical-align: middle;
  white-space: nowrap;
  text-align: center;
  background-color: #777777;
  border-radius: 10px;
}
.badge:empty {
  display: none;
}
.btn .badge {
  position: relative;
  top: -1px;
}
.btn-xs .badge,
.btn-group-xs > .btn .badge {
  top: 0;
  padding: 1px 5px;
}
a.badge:hover,
a.badge:focus {
  color: #fff;
  text-decoration: none;
  cursor: pointer;
}
.list-group-item.active > .badge,
.nav-pills > .active > a > .badge {
  color: #337ab7;
  background-color: #fff;
}
.list-group-item > .badge {
  float: right;
}
.list-group-item > .badge + .badge {
  margin-right: 5px;
}
.nav-pills > li > a > .badge {
  margin-left: 3px;
}
.jumbotron {
  padding-top: 30px;
  padding-bottom: 30px;
  margin-bottom: 30px;
  color: inherit;
  background-color: #eeeeee;
}
.jumbotron h1,
.jumbotron .h1 {
  color: inherit;
}
.jumbotron p {
  margin-bottom: 15px;
  font-size: 20px;
  font-weight: 200;
}
.jumbotron > hr {
  border-top-color: #d5d5d5;
}
.container .jumbotron,
.container-fluid .jumbotron {
  border-radius: 3px;
  padding-left: 0px;
  padding-right: 0px;
}
.jumbotron .container {
  max-width: 100%;
}
@media screen and (min-width: 768px) {
  .jumbotron {
    padding-top: 48px;
    padding-bottom: 48px;
  }
  .container .jumbotron,
  .container-fluid .jumbotron {
    padding-left: 60px;
    padding-right: 60px;
  }
  .jumbotron h1,
  .jumbotron .h1 {
    font-size: 59px;
  }
}
.thumbnail {
  display: block;
  padding: 4px;
  margin-bottom: 18px;
  line-height: 1.42857143;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 2px;
  -webkit-transition: border 0.2s ease-in-out;
  -o-transition: border 0.2s ease-in-out;
  transition: border 0.2s ease-in-out;
}
.thumbnail > img,
.thumbnail a > img {
  margin-left: auto;
  margin-right: auto;
}
a.thumbnail:hover,
a.thumbnail:focus,
a.thumbnail.active {
  border-color: #337ab7;
}
.thumbnail .caption {
  padding: 9px;
  color: #000;
}
.alert {
  padding: 15px;
  margin-bottom: 18px;
  border: 1px solid transparent;
  border-radius: 2px;
}
.alert h4 {
  margin-top: 0;
  color: inherit;
}
.alert .alert-link {
  font-weight: bold;
}
.alert > p,
.alert > ul {
  margin-bottom: 0;
}
.alert > p + p {
  margin-top: 5px;
}
.alert-dismissable,
.alert-dismissible {
  padding-right: 35px;
}
.alert-dismissable .close,
.alert-dismissible .close {
  position: relative;
  top: -2px;
  right: -21px;
  color: inherit;
}
.alert-success {
  background-color: #dff0d8;
  border-color: #d6e9c6;
  color: #3c763d;
}
.alert-success hr {
  border-top-color: #c9e2b3;
}
.alert-success .alert-link {
  color: #2b542c;
}
.alert-info {
  background-color: #d9edf7;
  border-color: #bce8f1;
  color: #31708f;
}
.alert-info hr {
  border-top-color: #a6e1ec;
}
.alert-info .alert-link {
  color: #245269;
}
.alert-warning {
  background-color: #fcf8e3;
  border-color: #faebcc;
  color: #8a6d3b;
}
.alert-warning hr {
  border-top-color: #f7e1b5;
}
.alert-warning .alert-link {
  color: #66512c;
}
.alert-danger {
  background-color: #f2dede;
  border-color: #ebccd1;
  color: #a94442;
}
.alert-danger hr {
  border-top-color: #e4b9c0;
}
.alert-danger .alert-link {
  color: #843534;
}
@-webkit-keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
@keyframes progress-bar-stripes {
  from {
    background-position: 40px 0;
  }
  to {
    background-position: 0 0;
  }
}
.progress {
  overflow: hidden;
  height: 18px;
  margin-bottom: 18px;
  background-color: #f5f5f5;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
}
.progress-bar {
  float: left;
  width: 0%;
  height: 100%;
  font-size: 12px;
  line-height: 18px;
  color: #fff;
  text-align: center;
  background-color: #337ab7;
  -webkit-box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.15);
  -webkit-transition: width 0.6s ease;
  -o-transition: width 0.6s ease;
  transition: width 0.6s ease;
}
.progress-striped .progress-bar,
.progress-bar-striped {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-size: 40px 40px;
}
.progress.active .progress-bar,
.progress-bar.active {
  -webkit-animation: progress-bar-stripes 2s linear infinite;
  -o-animation: progress-bar-stripes 2s linear infinite;
  animation: progress-bar-stripes 2s linear infinite;
}
.progress-bar-success {
  background-color: #5cb85c;
}
.progress-striped .progress-bar-success {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-info {
  background-color: #5bc0de;
}
.progress-striped .progress-bar-info {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-warning {
  background-color: #f0ad4e;
}
.progress-striped .progress-bar-warning {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.progress-bar-danger {
  background-color: #d9534f;
}
.progress-striped .progress-bar-danger {
  background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: -o-linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
  background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
}
.media {
  margin-top: 15px;
}
.media:first-child {
  margin-top: 0;
}
.media,
.media-body {
  zoom: 1;
  overflow: hidden;
}
.media-body {
  width: 10000px;
}
.media-object {
  display: block;
}
.media-object.img-thumbnail {
  max-width: none;
}
.media-right,
.media > .pull-right {
  padding-left: 10px;
}
.media-left,
.media > .pull-left {
  padding-right: 10px;
}
.media-left,
.media-right,
.media-body {
  display: table-cell;
  vertical-align: top;
}
.media-middle {
  vertical-align: middle;
}
.media-bottom {
  vertical-align: bottom;
}
.media-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.media-list {
  padding-left: 0;
  list-style: none;
}
.list-group {
  margin-bottom: 20px;
  padding-left: 0;
}
.list-group-item {
  position: relative;
  display: block;
  padding: 10px 15px;
  margin-bottom: -1px;
  background-color: #fff;
  border: 1px solid #ddd;
}
.list-group-item:first-child {
  border-top-right-radius: 2px;
  border-top-left-radius: 2px;
}
.list-group-item:last-child {
  margin-bottom: 0;
  border-bottom-right-radius: 2px;
  border-bottom-left-radius: 2px;
}
a.list-group-item,
button.list-group-item {
  color: #555;
}
a.list-group-item .list-group-item-heading,
button.list-group-item .list-group-item-heading {
  color: #333;
}
a.list-group-item:hover,
button.list-group-item:hover,
a.list-group-item:focus,
button.list-group-item:focus {
  text-decoration: none;
  color: #555;
  background-color: #f5f5f5;
}
button.list-group-item {
  width: 100%;
  text-align: left;
}
.list-group-item.disabled,
.list-group-item.disabled:hover,
.list-group-item.disabled:focus {
  background-color: #eeeeee;
  color: #777777;
  cursor: not-allowed;
}
.list-group-item.disabled .list-group-item-heading,
.list-group-item.disabled:hover .list-group-item-heading,
.list-group-item.disabled:focus .list-group-item-heading {
  color: inherit;
}
.list-group-item.disabled .list-group-item-text,
.list-group-item.disabled:hover .list-group-item-text,
.list-group-item.disabled:focus .list-group-item-text {
  color: #777777;
}
.list-group-item.active,
.list-group-item.active:hover,
.list-group-item.active:focus {
  z-index: 2;
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.list-group-item.active .list-group-item-heading,
.list-group-item.active:hover .list-group-item-heading,
.list-group-item.active:focus .list-group-item-heading,
.list-group-item.active .list-group-item-heading > small,
.list-group-item.active:hover .list-group-item-heading > small,
.list-group-item.active:focus .list-group-item-heading > small,
.list-group-item.active .list-group-item-heading > .small,
.list-group-item.active:hover .list-group-item-heading > .small,
.list-group-item.active:focus .list-group-item-heading > .small {
  color: inherit;
}
.list-group-item.active .list-group-item-text,
.list-group-item.active:hover .list-group-item-text,
.list-group-item.active:focus .list-group-item-text {
  color: #c7ddef;
}
.list-group-item-success {
  color: #3c763d;
  background-color: #dff0d8;
}
a.list-group-item-success,
button.list-group-item-success {
  color: #3c763d;
}
a.list-group-item-success .list-group-item-heading,
button.list-group-item-success .list-group-item-heading {
  color: inherit;
}
a.list-group-item-success:hover,
button.list-group-item-success:hover,
a.list-group-item-success:focus,
button.list-group-item-success:focus {
  color: #3c763d;
  background-color: #d0e9c6;
}
a.list-group-item-success.active,
button.list-group-item-success.active,
a.list-group-item-success.active:hover,
button.list-group-item-success.active:hover,
a.list-group-item-success.active:focus,
button.list-group-item-success.active:focus {
  color: #fff;
  background-color: #3c763d;
  border-color: #3c763d;
}
.list-group-item-info {
  color: #31708f;
  background-color: #d9edf7;
}
a.list-group-item-info,
button.list-group-item-info {
  color: #31708f;
}
a.list-group-item-info .list-group-item-heading,
button.list-group-item-info .list-group-item-heading {
  color: inherit;
}
a.list-group-item-info:hover,
button.list-group-item-info:hover,
a.list-group-item-info:focus,
button.list-group-item-info:focus {
  color: #31708f;
  background-color: #c4e3f3;
}
a.list-group-item-info.active,
button.list-group-item-info.active,
a.list-group-item-info.active:hover,
button.list-group-item-info.active:hover,
a.list-group-item-info.active:focus,
button.list-group-item-info.active:focus {
  color: #fff;
  background-color: #31708f;
  border-color: #31708f;
}
.list-group-item-warning {
  color: #8a6d3b;
  background-color: #fcf8e3;
}
a.list-group-item-warning,
button.list-group-item-warning {
  color: #8a6d3b;
}
a.list-group-item-warning .list-group-item-heading,
button.list-group-item-warning .list-group-item-heading {
  color: inherit;
}
a.list-group-item-warning:hover,
button.list-group-item-warning:hover,
a.list-group-item-warning:focus,
button.list-group-item-warning:focus {
  color: #8a6d3b;
  background-color: #faf2cc;
}
a.list-group-item-warning.active,
button.list-group-item-warning.active,
a.list-group-item-warning.active:hover,
button.list-group-item-warning.active:hover,
a.list-group-item-warning.active:focus,
button.list-group-item-warning.active:focus {
  color: #fff;
  background-color: #8a6d3b;
  border-color: #8a6d3b;
}
.list-group-item-danger {
  color: #a94442;
  background-color: #f2dede;
}
a.list-group-item-danger,
button.list-group-item-danger {
  color: #a94442;
}
a.list-group-item-danger .list-group-item-heading,
button.list-group-item-danger .list-group-item-heading {
  color: inherit;
}
a.list-group-item-danger:hover,
button.list-group-item-danger:hover,
a.list-group-item-danger:focus,
button.list-group-item-danger:focus {
  color: #a94442;
  background-color: #ebcccc;
}
a.list-group-item-danger.active,
button.list-group-item-danger.active,
a.list-group-item-danger.active:hover,
button.list-group-item-danger.active:hover,
a.list-group-item-danger.active:focus,
button.list-group-item-danger.active:focus {
  color: #fff;
  background-color: #a94442;
  border-color: #a94442;
}
.list-group-item-heading {
  margin-top: 0;
  margin-bottom: 5px;
}
.list-group-item-text {
  margin-bottom: 0;
  line-height: 1.3;
}
.panel {
  margin-bottom: 18px;
  background-color: #fff;
  border: 1px solid transparent;
  border-radius: 2px;
  -webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.05);
}
.panel-body {
  padding: 15px;
}
.panel-heading {
  padding: 10px 15px;
  border-bottom: 1px solid transparent;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel-heading > .dropdown .dropdown-toggle {
  color: inherit;
}
.panel-title {
  margin-top: 0;
  margin-bottom: 0;
  font-size: 15px;
  color: inherit;
}
.panel-title > a,
.panel-title > small,
.panel-title > .small,
.panel-title > small > a,
.panel-title > .small > a {
  color: inherit;
}
.panel-footer {
  padding: 10px 15px;
  background-color: #f5f5f5;
  border-top: 1px solid #ddd;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .list-group,
.panel > .panel-collapse > .list-group {
  margin-bottom: 0;
}
.panel > .list-group .list-group-item,
.panel > .panel-collapse > .list-group .list-group-item {
  border-width: 1px 0;
  border-radius: 0;
}
.panel > .list-group:first-child .list-group-item:first-child,
.panel > .panel-collapse > .list-group:first-child .list-group-item:first-child {
  border-top: 0;
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .list-group:last-child .list-group-item:last-child,
.panel > .panel-collapse > .list-group:last-child .list-group-item:last-child {
  border-bottom: 0;
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .panel-heading + .panel-collapse > .list-group .list-group-item:first-child {
  border-top-right-radius: 0;
  border-top-left-radius: 0;
}
.panel-heading + .list-group .list-group-item:first-child {
  border-top-width: 0;
}
.list-group + .panel-footer {
  border-top-width: 0;
}
.panel > .table,
.panel > .table-responsive > .table,
.panel > .panel-collapse > .table {
  margin-bottom: 0;
}
.panel > .table caption,
.panel > .table-responsive > .table caption,
.panel > .panel-collapse > .table caption {
  padding-left: 15px;
  padding-right: 15px;
}
.panel > .table:first-child,
.panel > .table-responsive:first-child > .table:first-child {
  border-top-right-radius: 1px;
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child {
  border-top-left-radius: 1px;
  border-top-right-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:first-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:first-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:first-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:first-child {
  border-top-left-radius: 1px;
}
.panel > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child td:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child td:last-child,
.panel > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > thead:first-child > tr:first-child th:last-child,
.panel > .table:first-child > tbody:first-child > tr:first-child th:last-child,
.panel > .table-responsive:first-child > .table:first-child > tbody:first-child > tr:first-child th:last-child {
  border-top-right-radius: 1px;
}
.panel > .table:last-child,
.panel > .table-responsive:last-child > .table:last-child {
  border-bottom-right-radius: 1px;
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child {
  border-bottom-left-radius: 1px;
  border-bottom-right-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:first-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:first-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:first-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:first-child {
  border-bottom-left-radius: 1px;
}
.panel > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child td:last-child,
.panel > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tbody:last-child > tr:last-child th:last-child,
.panel > .table:last-child > tfoot:last-child > tr:last-child th:last-child,
.panel > .table-responsive:last-child > .table:last-child > tfoot:last-child > tr:last-child th:last-child {
  border-bottom-right-radius: 1px;
}
.panel > .panel-body + .table,
.panel > .panel-body + .table-responsive,
.panel > .table + .panel-body,
.panel > .table-responsive + .panel-body {
  border-top: 1px solid #ddd;
}
.panel > .table > tbody:first-child > tr:first-child th,
.panel > .table > tbody:first-child > tr:first-child td {
  border-top: 0;
}
.panel > .table-bordered,
.panel > .table-responsive > .table-bordered {
  border: 0;
}
.panel > .table-bordered > thead > tr > th:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:first-child,
.panel > .table-bordered > tbody > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:first-child,
.panel > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:first-child,
.panel > .table-bordered > thead > tr > td:first-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:first-child,
.panel > .table-bordered > tbody > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:first-child,
.panel > .table-bordered > tfoot > tr > td:first-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:first-child {
  border-left: 0;
}
.panel > .table-bordered > thead > tr > th:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > th:last-child,
.panel > .table-bordered > tbody > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > th:last-child,
.panel > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > th:last-child,
.panel > .table-bordered > thead > tr > td:last-child,
.panel > .table-responsive > .table-bordered > thead > tr > td:last-child,
.panel > .table-bordered > tbody > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tbody > tr > td:last-child,
.panel > .table-bordered > tfoot > tr > td:last-child,
.panel > .table-responsive > .table-bordered > tfoot > tr > td:last-child {
  border-right: 0;
}
.panel > .table-bordered > thead > tr:first-child > td,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > td,
.panel > .table-bordered > tbody > tr:first-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > td,
.panel > .table-bordered > thead > tr:first-child > th,
.panel > .table-responsive > .table-bordered > thead > tr:first-child > th,
.panel > .table-bordered > tbody > tr:first-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:first-child > th {
  border-bottom: 0;
}
.panel > .table-bordered > tbody > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > td,
.panel > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > td,
.panel > .table-bordered > tbody > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tbody > tr:last-child > th,
.panel > .table-bordered > tfoot > tr:last-child > th,
.panel > .table-responsive > .table-bordered > tfoot > tr:last-child > th {
  border-bottom: 0;
}
.panel > .table-responsive {
  border: 0;
  margin-bottom: 0;
}
.panel-group {
  margin-bottom: 18px;
}
.panel-group .panel {
  margin-bottom: 0;
  border-radius: 2px;
}
.panel-group .panel + .panel {
  margin-top: 5px;
}
.panel-group .panel-heading {
  border-bottom: 0;
}
.panel-group .panel-heading + .panel-collapse > .panel-body,
.panel-group .panel-heading + .panel-collapse > .list-group {
  border-top: 1px solid #ddd;
}
.panel-group .panel-footer {
  border-top: 0;
}
.panel-group .panel-footer + .panel-collapse .panel-body {
  border-bottom: 1px solid #ddd;
}
.panel-default {
  border-color: #ddd;
}
.panel-default > .panel-heading {
  color: #333333;
  background-color: #f5f5f5;
  border-color: #ddd;
}
.panel-default > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ddd;
}
.panel-default > .panel-heading .badge {
  color: #f5f5f5;
  background-color: #333333;
}
.panel-default > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ddd;
}
.panel-primary {
  border-color: #337ab7;
}
.panel-primary > .panel-heading {
  color: #fff;
  background-color: #337ab7;
  border-color: #337ab7;
}
.panel-primary > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #337ab7;
}
.panel-primary > .panel-heading .badge {
  color: #337ab7;
  background-color: #fff;
}
.panel-primary > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #337ab7;
}
.panel-success {
  border-color: #d6e9c6;
}
.panel-success > .panel-heading {
  color: #3c763d;
  background-color: #dff0d8;
  border-color: #d6e9c6;
}
.panel-success > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #d6e9c6;
}
.panel-success > .panel-heading .badge {
  color: #dff0d8;
  background-color: #3c763d;
}
.panel-success > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #d6e9c6;
}
.panel-info {
  border-color: #bce8f1;
}
.panel-info > .panel-heading {
  color: #31708f;
  background-color: #d9edf7;
  border-color: #bce8f1;
}
.panel-info > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #bce8f1;
}
.panel-info > .panel-heading .badge {
  color: #d9edf7;
  background-color: #31708f;
}
.panel-info > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #bce8f1;
}
.panel-warning {
  border-color: #faebcc;
}
.panel-warning > .panel-heading {
  color: #8a6d3b;
  background-color: #fcf8e3;
  border-color: #faebcc;
}
.panel-warning > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #faebcc;
}
.panel-warning > .panel-heading .badge {
  color: #fcf8e3;
  background-color: #8a6d3b;
}
.panel-warning > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #faebcc;
}
.panel-danger {
  border-color: #ebccd1;
}
.panel-danger > .panel-heading {
  color: #a94442;
  background-color: #f2dede;
  border-color: #ebccd1;
}
.panel-danger > .panel-heading + .panel-collapse > .panel-body {
  border-top-color: #ebccd1;
}
.panel-danger > .panel-heading .badge {
  color: #f2dede;
  background-color: #a94442;
}
.panel-danger > .panel-footer + .panel-collapse > .panel-body {
  border-bottom-color: #ebccd1;
}
.embed-responsive {
  position: relative;
  display: block;
  height: 0;
  padding: 0;
  overflow: hidden;
}
.embed-responsive .embed-responsive-item,
.embed-responsive iframe,
.embed-responsive embed,
.embed-responsive object,
.embed-responsive video {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  height: 100%;
  width: 100%;
  border: 0;
}
.embed-responsive-16by9 {
  padding-bottom: 56.25%;
}
.embed-responsive-4by3 {
  padding-bottom: 75%;
}
.well {
  min-height: 20px;
  padding: 19px;
  margin-bottom: 20px;
  background-color: #f5f5f5;
  border: 1px solid #e3e3e3;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.05);
}
.well blockquote {
  border-color: #ddd;
  border-color: rgba(0, 0, 0, 0.15);
}
.well-lg {
  padding: 24px;
  border-radius: 3px;
}
.well-sm {
  padding: 9px;
  border-radius: 1px;
}
.close {
  float: right;
  font-size: 19.5px;
  font-weight: bold;
  line-height: 1;
  color: #000;
  text-shadow: 0 1px 0 #fff;
  opacity: 0.2;
  filter: alpha(opacity=20);
}
.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
  opacity: 0.5;
  filter: alpha(opacity=50);
}
button.close {
  padding: 0;
  cursor: pointer;
  background: transparent;
  border: 0;
  -webkit-appearance: none;
}
.modal-open {
  overflow: hidden;
}
.modal {
  display: none;
  overflow: hidden;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1050;
  -webkit-overflow-scrolling: touch;
  outline: 0;
}
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, -25%);
  -ms-transform: translate(0, -25%);
  -o-transform: translate(0, -25%);
  transform: translate(0, -25%);
  -webkit-transition: -webkit-transform 0.3s ease-out;
  -moz-transition: -moz-transform 0.3s ease-out;
  -o-transition: -o-transform 0.3s ease-out;
  transition: transform 0.3s ease-out;
}
.modal.in .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
.modal-open .modal {
  overflow-x: hidden;
  overflow-y: auto;
}
.modal-dialog {
  position: relative;
  width: auto;
  margin: 10px;
}
.modal-content {
  position: relative;
  background-color: #fff;
  border: 1px solid #999;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);
  background-clip: padding-box;
  outline: 0;
}
.modal-backdrop {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 1040;
  background-color: #000;
}
.modal-backdrop.fade {
  opacity: 0;
  filter: alpha(opacity=0);
}
.modal-backdrop.in {
  opacity: 0.5;
  filter: alpha(opacity=50);
}
.modal-header {
  padding: 15px;
  border-bottom: 1px solid #e5e5e5;
}
.modal-header .close {
  margin-top: -2px;
}
.modal-title {
  margin: 0;
  line-height: 1.42857143;
}
.modal-body {
  position: relative;
  padding: 15px;
}
.modal-footer {
  padding: 15px;
  text-align: right;
  border-top: 1px solid #e5e5e5;
}
.modal-footer .btn + .btn {
  margin-left: 5px;
  margin-bottom: 0;
}
.modal-footer .btn-group .btn + .btn {
  margin-left: -1px;
}
.modal-footer .btn-block + .btn-block {
  margin-left: 0;
}
.modal-scrollbar-measure {
  position: absolute;
  top: -9999px;
  width: 50px;
  height: 50px;
  overflow: scroll;
}
@media (min-width: 768px) {
  .modal-dialog {
    width: 600px;
    margin: 30px auto;
  }
  .modal-content {
    -webkit-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  }
  .modal-sm {
    width: 300px;
  }
}
@media (min-width: 992px) {
  .modal-lg {
    width: 900px;
  }
}
.tooltip {
  position: absolute;
  z-index: 1070;
  display: block;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 12px;
  opacity: 0;
  filter: alpha(opacity=0);
}
.tooltip.in {
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.tooltip.top {
  margin-top: -3px;
  padding: 5px 0;
}
.tooltip.right {
  margin-left: 3px;
  padding: 0 5px;
}
.tooltip.bottom {
  margin-top: 3px;
  padding: 5px 0;
}
.tooltip.left {
  margin-left: -3px;
  padding: 0 5px;
}
.tooltip-inner {
  max-width: 200px;
  padding: 3px 8px;
  color: #fff;
  text-align: center;
  background-color: #000;
  border-radius: 2px;
}
.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-left .tooltip-arrow {
  bottom: 0;
  right: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.top-right .tooltip-arrow {
  bottom: 0;
  left: 5px;
  margin-bottom: -5px;
  border-width: 5px 5px 0;
  border-top-color: #000;
}
.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-width: 5px 5px 5px 0;
  border-right-color: #000;
}
.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-width: 5px 0 5px 5px;
  border-left-color: #000;
}
.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-left .tooltip-arrow {
  top: 0;
  right: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.tooltip.bottom-right .tooltip-arrow {
  top: 0;
  left: 5px;
  margin-top: -5px;
  border-width: 0 5px 5px;
  border-bottom-color: #000;
}
.popover {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1060;
  display: none;
  max-width: 276px;
  padding: 1px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-style: normal;
  font-weight: normal;
  letter-spacing: normal;
  line-break: auto;
  line-height: 1.42857143;
  text-align: left;
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  white-space: normal;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  font-size: 13px;
  background-color: #fff;
  background-clip: padding-box;
  border: 1px solid #ccc;
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 3px;
  -webkit-box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
  box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
}
.popover.top {
  margin-top: -10px;
}
.popover.right {
  margin-left: 10px;
}
.popover.bottom {
  margin-top: 10px;
}
.popover.left {
  margin-left: -10px;
}
.popover-title {
  margin: 0;
  padding: 8px 14px;
  font-size: 13px;
  background-color: #f7f7f7;
  border-bottom: 1px solid #ebebeb;
  border-radius: 2px 2px 0 0;
}
.popover-content {
  padding: 9px 14px;
}
.popover > .arrow,
.popover > .arrow:after {
  position: absolute;
  display: block;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}
.popover > .arrow {
  border-width: 11px;
}
.popover > .arrow:after {
  border-width: 10px;
  content: "";
}
.popover.top > .arrow {
  left: 50%;
  margin-left: -11px;
  border-bottom-width: 0;
  border-top-color: #999999;
  border-top-color: rgba(0, 0, 0, 0.25);
  bottom: -11px;
}
.popover.top > .arrow:after {
  content: " ";
  bottom: 1px;
  margin-left: -10px;
  border-bottom-width: 0;
  border-top-color: #fff;
}
.popover.right > .arrow {
  top: 50%;
  left: -11px;
  margin-top: -11px;
  border-left-width: 0;
  border-right-color: #999999;
  border-right-color: rgba(0, 0, 0, 0.25);
}
.popover.right > .arrow:after {
  content: " ";
  left: 1px;
  bottom: -10px;
  border-left-width: 0;
  border-right-color: #fff;
}
.popover.bottom > .arrow {
  left: 50%;
  margin-left: -11px;
  border-top-width: 0;
  border-bottom-color: #999999;
  border-bottom-color: rgba(0, 0, 0, 0.25);
  top: -11px;
}
.popover.bottom > .arrow:after {
  content: " ";
  top: 1px;
  margin-left: -10px;
  border-top-width: 0;
  border-bottom-color: #fff;
}
.popover.left > .arrow {
  top: 50%;
  right: -11px;
  margin-top: -11px;
  border-right-width: 0;
  border-left-color: #999999;
  border-left-color: rgba(0, 0, 0, 0.25);
}
.popover.left > .arrow:after {
  content: " ";
  right: 1px;
  border-right-width: 0;
  border-left-color: #fff;
  bottom: -10px;
}
.carousel {
  position: relative;
}
.carousel-inner {
  position: relative;
  overflow: hidden;
  width: 100%;
}
.carousel-inner > .item {
  display: none;
  position: relative;
  -webkit-transition: 0.6s ease-in-out left;
  -o-transition: 0.6s ease-in-out left;
  transition: 0.6s ease-in-out left;
}
.carousel-inner > .item > img,
.carousel-inner > .item > a > img {
  line-height: 1;
}
@media all and (transform-3d), (-webkit-transform-3d) {
  .carousel-inner > .item {
    -webkit-transition: -webkit-transform 0.6s ease-in-out;
    -moz-transition: -moz-transform 0.6s ease-in-out;
    -o-transition: -o-transform 0.6s ease-in-out;
    transition: transform 0.6s ease-in-out;
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    backface-visibility: hidden;
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    perspective: 1000px;
  }
  .carousel-inner > .item.next,
  .carousel-inner > .item.active.right {
    -webkit-transform: translate3d(100%, 0, 0);
    transform: translate3d(100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.prev,
  .carousel-inner > .item.active.left {
    -webkit-transform: translate3d(-100%, 0, 0);
    transform: translate3d(-100%, 0, 0);
    left: 0;
  }
  .carousel-inner > .item.next.left,
  .carousel-inner > .item.prev.right,
  .carousel-inner > .item.active {
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
    left: 0;
  }
}
.carousel-inner > .active,
.carousel-inner > .next,
.carousel-inner > .prev {
  display: block;
}
.carousel-inner > .active {
  left: 0;
}
.carousel-inner > .next,
.carousel-inner > .prev {
  position: absolute;
  top: 0;
  width: 100%;
}
.carousel-inner > .next {
  left: 100%;
}
.carousel-inner > .prev {
  left: -100%;
}
.carousel-inner > .next.left,
.carousel-inner > .prev.right {
  left: 0;
}
.carousel-inner > .active.left {
  left: -100%;
}
.carousel-inner > .active.right {
  left: 100%;
}
.carousel-control {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: 15%;
  opacity: 0.5;
  filter: alpha(opacity=50);
  font-size: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  background-color: rgba(0, 0, 0, 0);
}
.carousel-control.left {
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.5) 0%, rgba(0, 0, 0, 0.0001) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#80000000', endColorstr='#00000000', GradientType=1);
}
.carousel-control.right {
  left: auto;
  right: 0;
  background-image: -webkit-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: -o-linear-gradient(left, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-image: linear-gradient(to right, rgba(0, 0, 0, 0.0001) 0%, rgba(0, 0, 0, 0.5) 100%);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#00000000', endColorstr='#80000000', GradientType=1);
}
.carousel-control:hover,
.carousel-control:focus {
  outline: 0;
  color: #fff;
  text-decoration: none;
  opacity: 0.9;
  filter: alpha(opacity=90);
}
.carousel-control .icon-prev,
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-left,
.carousel-control .glyphicon-chevron-right {
  position: absolute;
  top: 50%;
  margin-top: -10px;
  z-index: 5;
  display: inline-block;
}
.carousel-control .icon-prev,
.carousel-control .glyphicon-chevron-left {
  left: 50%;
  margin-left: -10px;
}
.carousel-control .icon-next,
.carousel-control .glyphicon-chevron-right {
  right: 50%;
  margin-right: -10px;
}
.carousel-control .icon-prev,
.carousel-control .icon-next {
  width: 20px;
  height: 20px;
  line-height: 1;
  font-family: serif;
}
.carousel-control .icon-prev:before {
  content: '\2039';
}
.carousel-control .icon-next:before {
  content: '\203a';
}
.carousel-indicators {
  position: absolute;
  bottom: 10px;
  left: 50%;
  z-index: 15;
  width: 60%;
  margin-left: -30%;
  padding-left: 0;
  list-style: none;
  text-align: center;
}
.carousel-indicators li {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 1px;
  text-indent: -999px;
  border: 1px solid #fff;
  border-radius: 10px;
  cursor: pointer;
  background-color: #000 \9;
  background-color: rgba(0, 0, 0, 0);
}
.carousel-indicators .active {
  margin: 0;
  width: 12px;
  height: 12px;
  background-color: #fff;
}
.carousel-caption {
  position: absolute;
  left: 15%;
  right: 15%;
  bottom: 20px;
  z-index: 10;
  padding-top: 20px;
  padding-bottom: 20px;
  color: #fff;
  text-align: center;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}
.carousel-caption .btn {
  text-shadow: none;
}
@media screen and (min-width: 768px) {
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-prev,
  .carousel-control .icon-next {
    width: 30px;
    height: 30px;
    margin-top: -10px;
    font-size: 30px;
  }
  .carousel-control .glyphicon-chevron-left,
  .carousel-control .icon-prev {
    margin-left: -10px;
  }
  .carousel-control .glyphicon-chevron-right,
  .carousel-control .icon-next {
    margin-right: -10px;
  }
  .carousel-caption {
    left: 20%;
    right: 20%;
    padding-bottom: 30px;
  }
  .carousel-indicators {
    bottom: 20px;
  }
}
.clearfix:before,
.clearfix:after,
.dl-horizontal dd:before,
.dl-horizontal dd:after,
.container:before,
.container:after,
.container-fluid:before,
.container-fluid:after,
.row:before,
.row:after,
.form-horizontal .form-group:before,
.form-horizontal .form-group:after,
.btn-toolbar:before,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:before,
.btn-group-vertical > .btn-group:after,
.nav:before,
.nav:after,
.navbar:before,
.navbar:after,
.navbar-header:before,
.navbar-header:after,
.navbar-collapse:before,
.navbar-collapse:after,
.pager:before,
.pager:after,
.panel-body:before,
.panel-body:after,
.modal-header:before,
.modal-header:after,
.modal-footer:before,
.modal-footer:after,
.item_buttons:before,
.item_buttons:after {
  content: " ";
  display: table;
}
.clearfix:after,
.dl-horizontal dd:after,
.container:after,
.container-fluid:after,
.row:after,
.form-horizontal .form-group:after,
.btn-toolbar:after,
.btn-group-vertical > .btn-group:after,
.nav:after,
.navbar:after,
.navbar-header:after,
.navbar-collapse:after,
.pager:after,
.panel-body:after,
.modal-header:after,
.modal-footer:after,
.item_buttons:after {
  clear: both;
}
.center-block {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.pull-right {
  float: right !important;
}
.pull-left {
  float: left !important;
}
.hide {
  display: none !important;
}
.show {
  display: block !important;
}
.invisible {
  visibility: hidden;
}
.text-hide {
  font: 0/0 a;
  color: transparent;
  text-shadow: none;
  background-color: transparent;
  border: 0;
}
.hidden {
  display: none !important;
}
.affix {
  position: fixed;
}
@-ms-viewport {
  width: device-width;
}
.visible-xs,
.visible-sm,
.visible-md,
.visible-lg {
  display: none !important;
}
.visible-xs-block,
.visible-xs-inline,
.visible-xs-inline-block,
.visible-sm-block,
.visible-sm-inline,
.visible-sm-inline-block,
.visible-md-block,
.visible-md-inline,
.visible-md-inline-block,
.visible-lg-block,
.visible-lg-inline,
.visible-lg-inline-block {
  display: none !important;
}
@media (max-width: 767px) {
  .visible-xs {
    display: block !important;
  }
  table.visible-xs {
    display: table !important;
  }
  tr.visible-xs {
    display: table-row !important;
  }
  th.visible-xs,
  td.visible-xs {
    display: table-cell !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-block {
    display: block !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline {
    display: inline !important;
  }
}
@media (max-width: 767px) {
  .visible-xs-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm {
    display: block !important;
  }
  table.visible-sm {
    display: table !important;
  }
  tr.visible-sm {
    display: table-row !important;
  }
  th.visible-sm,
  td.visible-sm {
    display: table-cell !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-block {
    display: block !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline {
    display: inline !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .visible-sm-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md {
    display: block !important;
  }
  table.visible-md {
    display: table !important;
  }
  tr.visible-md {
    display: table-row !important;
  }
  th.visible-md,
  td.visible-md {
    display: table-cell !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-block {
    display: block !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline {
    display: inline !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .visible-md-inline-block {
    display: inline-block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg {
    display: block !important;
  }
  table.visible-lg {
    display: table !important;
  }
  tr.visible-lg {
    display: table-row !important;
  }
  th.visible-lg,
  td.visible-lg {
    display: table-cell !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-block {
    display: block !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline {
    display: inline !important;
  }
}
@media (min-width: 1200px) {
  .visible-lg-inline-block {
    display: inline-block !important;
  }
}
@media (max-width: 767px) {
  .hidden-xs {
    display: none !important;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  .hidden-sm {
    display: none !important;
  }
}
@media (min-width: 992px) and (max-width: 1199px) {
  .hidden-md {
    display: none !important;
  }
}
@media (min-width: 1200px) {
  .hidden-lg {
    display: none !important;
  }
}
.visible-print {
  display: none !important;
}
@media print {
  .visible-print {
    display: block !important;
  }
  table.visible-print {
    display: table !important;
  }
  tr.visible-print {
    display: table-row !important;
  }
  th.visible-print,
  td.visible-print {
    display: table-cell !important;
  }
}
.visible-print-block {
  display: none !important;
}
@media print {
  .visible-print-block {
    display: block !important;
  }
}
.visible-print-inline {
  display: none !important;
}
@media print {
  .visible-print-inline {
    display: inline !important;
  }
}
.visible-print-inline-block {
  display: none !important;
}
@media print {
  .visible-print-inline-block {
    display: inline-block !important;
  }
}
@media print {
  .hidden-print {
    display: none !important;
  }
}
/*!
*
* Font Awesome
*
*/
/*!
 *  Font Awesome 4.7.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */
/* FONT PATH
 * -------------------------- */
@font-face {
  font-family: 'FontAwesome';
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?v=4.7.0');
  src: url('../components/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('../components/font-awesome/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('../components/font-awesome/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('../components/font-awesome/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('../components/font-awesome/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
/* makes the font 33% larger relative to the icon container */
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  vertical-align: -15%;
}
.fa-2x {
  font-size: 2em;
}
.fa-3x {
  font-size: 3em;
}
.fa-4x {
  font-size: 4em;
}
.fa-5x {
  font-size: 5em;
}
.fa-fw {
  width: 1.28571429em;
  text-align: center;
}
.fa-ul {
  padding-left: 0;
  margin-left: 2.14285714em;
  list-style-type: none;
}
.fa-ul > li {
  position: relative;
}
.fa-li {
  position: absolute;
  left: -2.14285714em;
  width: 2.14285714em;
  top: 0.14285714em;
  text-align: center;
}
.fa-li.fa-lg {
  left: -1.85714286em;
}
.fa-border {
  padding: .2em .25em .15em;
  border: solid 0.08em #eee;
  border-radius: .1em;
}
.fa-pull-left {
  float: left;
}
.fa-pull-right {
  float: right;
}
.fa.fa-pull-left {
  margin-right: .3em;
}
.fa.fa-pull-right {
  margin-left: .3em;
}
/* Deprecated as of 4.4.0 */
.pull-right {
  float: right;
}
.pull-left {
  float: left;
}
.fa.pull-left {
  margin-right: .3em;
}
.fa.pull-right {
  margin-left: .3em;
}
.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
  animation: fa-spin 2s infinite linear;
}
.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
  animation: fa-spin 1s infinite steps(8);
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
    transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(359deg);
    transform: rotate(359deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
  -ms-transform: rotate(90deg);
  transform: rotate(90deg);
}
.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
  -ms-transform: rotate(180deg);
  transform: rotate(180deg);
}
.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
  -ms-transform: rotate(270deg);
  transform: rotate(270deg);
}
.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
  -ms-transform: scale(-1, 1);
  transform: scale(-1, 1);
}
.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
  -ms-transform: scale(1, -1);
  transform: scale(1, -1);
}
:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical {
  filter: none;
}
.fa-stack {
  position: relative;
  display: inline-block;
  width: 2em;
  height: 2em;
  line-height: 2em;
  vertical-align: middle;
}
.fa-stack-1x,
.fa-stack-2x {
  position: absolute;
  left: 0;
  width: 100%;
  text-align: center;
}
.fa-stack-1x {
  line-height: inherit;
}
.fa-stack-2x {
  font-size: 2em;
}
.fa-inverse {
  color: #fff;
}
/* Font Awesome uses the Unicode Private Use Area (PUA) to ensure screen
   readers do not read off random characters that represent icons */
.fa-glass:before {
  content: "\f000";
}
.fa-music:before {
  content: "\f001";
}
.fa-search:before {
  content: "\f002";
}
.fa-envelope-o:before {
  content: "\f003";
}
.fa-heart:before {
  content: "\f004";
}
.fa-star:before {
  content: "\f005";
}
.fa-star-o:before {
  content: "\f006";
}
.fa-user:before {
  content: "\f007";
}
.fa-film:before {
  content: "\f008";
}
.fa-th-large:before {
  content: "\f009";
}
.fa-th:before {
  content: "\f00a";
}
.fa-th-list:before {
  content: "\f00b";
}
.fa-check:before {
  content: "\f00c";
}
.fa-remove:before,
.fa-close:before,
.fa-times:before {
  content: "\f00d";
}
.fa-search-plus:before {
  content: "\f00e";
}
.fa-search-minus:before {
  content: "\f010";
}
.fa-power-off:before {
  content: "\f011";
}
.fa-signal:before {
  content: "\f012";
}
.fa-gear:before,
.fa-cog:before {
  content: "\f013";
}
.fa-trash-o:before {
  content: "\f014";
}
.fa-home:before {
  content: "\f015";
}
.fa-file-o:before {
  content: "\f016";
}
.fa-clock-o:before {
  content: "\f017";
}
.fa-road:before {
  content: "\f018";
}
.fa-download:before {
  content: "\f019";
}
.fa-arrow-circle-o-down:before {
  content: "\f01a";
}
.fa-arrow-circle-o-up:before {
  content: "\f01b";
}
.fa-inbox:before {
  content: "\f01c";
}
.fa-play-circle-o:before {
  content: "\f01d";
}
.fa-rotate-right:before,
.fa-repeat:before {
  content: "\f01e";
}
.fa-refresh:before {
  content: "\f021";
}
.fa-list-alt:before {
  content: "\f022";
}
.fa-lock:before {
  content: "\f023";
}
.fa-flag:before {
  content: "\f024";
}
.fa-headphones:before {
  content: "\f025";
}
.fa-volume-off:before {
  content: "\f026";
}
.fa-volume-down:before {
  content: "\f027";
}
.fa-volume-up:before {
  content: "\f028";
}
.fa-qrcode:before {
  content: "\f029";
}
.fa-barcode:before {
  content: "\f02a";
}
.fa-tag:before {
  content: "\f02b";
}
.fa-tags:before {
  content: "\f02c";
}
.fa-book:before {
  content: "\f02d";
}
.fa-bookmark:before {
  content: "\f02e";
}
.fa-print:before {
  content: "\f02f";
}
.fa-camera:before {
  content: "\f030";
}
.fa-font:before {
  content: "\f031";
}
.fa-bold:before {
  content: "\f032";
}
.fa-italic:before {
  content: "\f033";
}
.fa-text-height:before {
  content: "\f034";
}
.fa-text-width:before {
  content: "\f035";
}
.fa-align-left:before {
  content: "\f036";
}
.fa-align-center:before {
  content: "\f037";
}
.fa-align-right:before {
  content: "\f038";
}
.fa-align-justify:before {
  content: "\f039";
}
.fa-list:before {
  content: "\f03a";
}
.fa-dedent:before,
.fa-outdent:before {
  content: "\f03b";
}
.fa-indent:before {
  content: "\f03c";
}
.fa-video-camera:before {
  content: "\f03d";
}
.fa-photo:before,
.fa-image:before,
.fa-picture-o:before {
  content: "\f03e";
}
.fa-pencil:before {
  content: "\f040";
}
.fa-map-marker:before {
  content: "\f041";
}
.fa-adjust:before {
  content: "\f042";
}
.fa-tint:before {
  content: "\f043";
}
.fa-edit:before,
.fa-pencil-square-o:before {
  content: "\f044";
}
.fa-share-square-o:before {
  content: "\f045";
}
.fa-check-square-o:before {
  content: "\f046";
}
.fa-arrows:before {
  content: "\f047";
}
.fa-step-backward:before {
  content: "\f048";
}
.fa-fast-backward:before {
  content: "\f049";
}
.fa-backward:before {
  content: "\f04a";
}
.fa-play:before {
  content: "\f04b";
}
.fa-pause:before {
  content: "\f04c";
}
.fa-stop:before {
  content: "\f04d";
}
.fa-forward:before {
  content: "\f04e";
}
.fa-fast-forward:before {
  content: "\f050";
}
.fa-step-forward:before {
  content: "\f051";
}
.fa-eject:before {
  content: "\f052";
}
.fa-chevron-left:before {
  content: "\f053";
}
.fa-chevron-right:before {
  content: "\f054";
}
.fa-plus-circle:before {
  content: "\f055";
}
.fa-minus-circle:before {
  content: "\f056";
}
.fa-times-circle:before {
  content: "\f057";
}
.fa-check-circle:before {
  content: "\f058";
}
.fa-question-circle:before {
  content: "\f059";
}
.fa-info-circle:before {
  content: "\f05a";
}
.fa-crosshairs:before {
  content: "\f05b";
}
.fa-times-circle-o:before {
  content: "\f05c";
}
.fa-check-circle-o:before {
  content: "\f05d";
}
.fa-ban:before {
  content: "\f05e";
}
.fa-arrow-left:before {
  content: "\f060";
}
.fa-arrow-right:before {
  content: "\f061";
}
.fa-arrow-up:before {
  content: "\f062";
}
.fa-arrow-down:before {
  content: "\f063";
}
.fa-mail-forward:before,
.fa-share:before {
  content: "\f064";
}
.fa-expand:before {
  content: "\f065";
}
.fa-compress:before {
  content: "\f066";
}
.fa-plus:before {
  content: "\f067";
}
.fa-minus:before {
  content: "\f068";
}
.fa-asterisk:before {
  content: "\f069";
}
.fa-exclamation-circle:before {
  content: "\f06a";
}
.fa-gift:before {
  content: "\f06b";
}
.fa-leaf:before {
  content: "\f06c";
}
.fa-fire:before {
  content: "\f06d";
}
.fa-eye:before {
  content: "\f06e";
}
.fa-eye-slash:before {
  content: "\f070";
}
.fa-warning:before,
.fa-exclamation-triangle:before {
  content: "\f071";
}
.fa-plane:before {
  content: "\f072";
}
.fa-calendar:before {
  content: "\f073";
}
.fa-random:before {
  content: "\f074";
}
.fa-comment:before {
  content: "\f075";
}
.fa-magnet:before {
  content: "\f076";
}
.fa-chevron-up:before {
  content: "\f077";
}
.fa-chevron-down:before {
  content: "\f078";
}
.fa-retweet:before {
  content: "\f079";
}
.fa-shopping-cart:before {
  content: "\f07a";
}
.fa-folder:before {
  content: "\f07b";
}
.fa-folder-open:before {
  content: "\f07c";
}
.fa-arrows-v:before {
  content: "\f07d";
}
.fa-arrows-h:before {
  content: "\f07e";
}
.fa-bar-chart-o:before,
.fa-bar-chart:before {
  content: "\f080";
}
.fa-twitter-square:before {
  content: "\f081";
}
.fa-facebook-square:before {
  content: "\f082";
}
.fa-camera-retro:before {
  content: "\f083";
}
.fa-key:before {
  content: "\f084";
}
.fa-gears:before,
.fa-cogs:before {
  content: "\f085";
}
.fa-comments:before {
  content: "\f086";
}
.fa-thumbs-o-up:before {
  content: "\f087";
}
.fa-thumbs-o-down:before {
  content: "\f088";
}
.fa-star-half:before {
  content: "\f089";
}
.fa-heart-o:before {
  content: "\f08a";
}
.fa-sign-out:before {
  content: "\f08b";
}
.fa-linkedin-square:before {
  content: "\f08c";
}
.fa-thumb-tack:before {
  content: "\f08d";
}
.fa-external-link:before {
  content: "\f08e";
}
.fa-sign-in:before {
  content: "\f090";
}
.fa-trophy:before {
  content: "\f091";
}
.fa-github-square:before {
  content: "\f092";
}
.fa-upload:before {
  content: "\f093";
}
.fa-lemon-o:before {
  content: "\f094";
}
.fa-phone:before {
  content: "\f095";
}
.fa-square-o:before {
  content: "\f096";
}
.fa-bookmark-o:before {
  content: "\f097";
}
.fa-phone-square:before {
  content: "\f098";
}
.fa-twitter:before {
  content: "\f099";
}
.fa-facebook-f:before,
.fa-facebook:before {
  content: "\f09a";
}
.fa-github:before {
  content: "\f09b";
}
.fa-unlock:before {
  content: "\f09c";
}
.fa-credit-card:before {
  content: "\f09d";
}
.fa-feed:before,
.fa-rss:before {
  content: "\f09e";
}
.fa-hdd-o:before {
  content: "\f0a0";
}
.fa-bullhorn:before {
  content: "\f0a1";
}
.fa-bell:before {
  content: "\f0f3";
}
.fa-certificate:before {
  content: "\f0a3";
}
.fa-hand-o-right:before {
  content: "\f0a4";
}
.fa-hand-o-left:before {
  content: "\f0a5";
}
.fa-hand-o-up:before {
  content: "\f0a6";
}
.fa-hand-o-down:before {
  content: "\f0a7";
}
.fa-arrow-circle-left:before {
  content: "\f0a8";
}
.fa-arrow-circle-right:before {
  content: "\f0a9";
}
.fa-arrow-circle-up:before {
  content: "\f0aa";
}
.fa-arrow-circle-down:before {
  content: "\f0ab";
}
.fa-globe:before {
  content: "\f0ac";
}
.fa-wrench:before {
  content: "\f0ad";
}
.fa-tasks:before {
  content: "\f0ae";
}
.fa-filter:before {
  content: "\f0b0";
}
.fa-briefcase:before {
  content: "\f0b1";
}
.fa-arrows-alt:before {
  content: "\f0b2";
}
.fa-group:before,
.fa-users:before {
  content: "\f0c0";
}
.fa-chain:before,
.fa-link:before {
  content: "\f0c1";
}
.fa-cloud:before {
  content: "\f0c2";
}
.fa-flask:before {
  content: "\f0c3";
}
.fa-cut:before,
.fa-scissors:before {
  content: "\f0c4";
}
.fa-copy:before,
.fa-files-o:before {
  content: "\f0c5";
}
.fa-paperclip:before {
  content: "\f0c6";
}
.fa-save:before,
.fa-floppy-o:before {
  content: "\f0c7";
}
.fa-square:before {
  content: "\f0c8";
}
.fa-navicon:before,
.fa-reorder:before,
.fa-bars:before {
  content: "\f0c9";
}
.fa-list-ul:before {
  content: "\f0ca";
}
.fa-list-ol:before {
  content: "\f0cb";
}
.fa-strikethrough:before {
  content: "\f0cc";
}
.fa-underline:before {
  content: "\f0cd";
}
.fa-table:before {
  content: "\f0ce";
}
.fa-magic:before {
  content: "\f0d0";
}
.fa-truck:before {
  content: "\f0d1";
}
.fa-pinterest:before {
  content: "\f0d2";
}
.fa-pinterest-square:before {
  content: "\f0d3";
}
.fa-google-plus-square:before {
  content: "\f0d4";
}
.fa-google-plus:before {
  content: "\f0d5";
}
.fa-money:before {
  content: "\f0d6";
}
.fa-caret-down:before {
  content: "\f0d7";
}
.fa-caret-up:before {
  content: "\f0d8";
}
.fa-caret-left:before {
  content: "\f0d9";
}
.fa-caret-right:before {
  content: "\f0da";
}
.fa-columns:before {
  content: "\f0db";
}
.fa-unsorted:before,
.fa-sort:before {
  content: "\f0dc";
}
.fa-sort-down:before,
.fa-sort-desc:before {
  content: "\f0dd";
}
.fa-sort-up:before,
.fa-sort-asc:before {
  content: "\f0de";
}
.fa-envelope:before {
  content: "\f0e0";
}
.fa-linkedin:before {
  content: "\f0e1";
}
.fa-rotate-left:before,
.fa-undo:before {
  content: "\f0e2";
}
.fa-legal:before,
.fa-gavel:before {
  content: "\f0e3";
}
.fa-dashboard:before,
.fa-tachometer:before {
  content: "\f0e4";
}
.fa-comment-o:before {
  content: "\f0e5";
}
.fa-comments-o:before {
  content: "\f0e6";
}
.fa-flash:before,
.fa-bolt:before {
  content: "\f0e7";
}
.fa-sitemap:before {
  content: "\f0e8";
}
.fa-umbrella:before {
  content: "\f0e9";
}
.fa-paste:before,
.fa-clipboard:before {
  content: "\f0ea";
}
.fa-lightbulb-o:before {
  content: "\f0eb";
}
.fa-exchange:before {
  content: "\f0ec";
}
.fa-cloud-download:before {
  content: "\f0ed";
}
.fa-cloud-upload:before {
  content: "\f0ee";
}
.fa-user-md:before {
  content: "\f0f0";
}
.fa-stethoscope:before {
  content: "\f0f1";
}
.fa-suitcase:before {
  content: "\f0f2";
}
.fa-bell-o:before {
  content: "\f0a2";
}
.fa-coffee:before {
  content: "\f0f4";
}
.fa-cutlery:before {
  content: "\f0f5";
}
.fa-file-text-o:before {
  content: "\f0f6";
}
.fa-building-o:before {
  content: "\f0f7";
}
.fa-hospital-o:before {
  content: "\f0f8";
}
.fa-ambulance:before {
  content: "\f0f9";
}
.fa-medkit:before {
  content: "\f0fa";
}
.fa-fighter-jet:before {
  content: "\f0fb";
}
.fa-beer:before {
  content: "\f0fc";
}
.fa-h-square:before {
  content: "\f0fd";
}
.fa-plus-square:before {
  content: "\f0fe";
}
.fa-angle-double-left:before {
  content: "\f100";
}
.fa-angle-double-right:before {
  content: "\f101";
}
.fa-angle-double-up:before {
  content: "\f102";
}
.fa-angle-double-down:before {
  content: "\f103";
}
.fa-angle-left:before {
  content: "\f104";
}
.fa-angle-right:before {
  content: "\f105";
}
.fa-angle-up:before {
  content: "\f106";
}
.fa-angle-down:before {
  content: "\f107";
}
.fa-desktop:before {
  content: "\f108";
}
.fa-laptop:before {
  content: "\f109";
}
.fa-tablet:before {
  content: "\f10a";
}
.fa-mobile-phone:before,
.fa-mobile:before {
  content: "\f10b";
}
.fa-circle-o:before {
  content: "\f10c";
}
.fa-quote-left:before {
  content: "\f10d";
}
.fa-quote-right:before {
  content: "\f10e";
}
.fa-spinner:before {
  content: "\f110";
}
.fa-circle:before {
  content: "\f111";
}
.fa-mail-reply:before,
.fa-reply:before {
  content: "\f112";
}
.fa-github-alt:before {
  content: "\f113";
}
.fa-folder-o:before {
  content: "\f114";
}
.fa-folder-open-o:before {
  content: "\f115";
}
.fa-smile-o:before {
  content: "\f118";
}
.fa-frown-o:before {
  content: "\f119";
}
.fa-meh-o:before {
  content: "\f11a";
}
.fa-gamepad:before {
  content: "\f11b";
}
.fa-keyboard-o:before {
  content: "\f11c";
}
.fa-flag-o:before {
  content: "\f11d";
}
.fa-flag-checkered:before {
  content: "\f11e";
}
.fa-terminal:before {
  content: "\f120";
}
.fa-code:before {
  content: "\f121";
}
.fa-mail-reply-all:before,
.fa-reply-all:before {
  content: "\f122";
}
.fa-star-half-empty:before,
.fa-star-half-full:before,
.fa-star-half-o:before {
  content: "\f123";
}
.fa-location-arrow:before {
  content: "\f124";
}
.fa-crop:before {
  content: "\f125";
}
.fa-code-fork:before {
  content: "\f126";
}
.fa-unlink:before,
.fa-chain-broken:before {
  content: "\f127";
}
.fa-question:before {
  content: "\f128";
}
.fa-info:before {
  content: "\f129";
}
.fa-exclamation:before {
  content: "\f12a";
}
.fa-superscript:before {
  content: "\f12b";
}
.fa-subscript:before {
  content: "\f12c";
}
.fa-eraser:before {
  content: "\f12d";
}
.fa-puzzle-piece:before {
  content: "\f12e";
}
.fa-microphone:before {
  content: "\f130";
}
.fa-microphone-slash:before {
  content: "\f131";
}
.fa-shield:before {
  content: "\f132";
}
.fa-calendar-o:before {
  content: "\f133";
}
.fa-fire-extinguisher:before {
  content: "\f134";
}
.fa-rocket:before {
  content: "\f135";
}
.fa-maxcdn:before {
  content: "\f136";
}
.fa-chevron-circle-left:before {
  content: "\f137";
}
.fa-chevron-circle-right:before {
  content: "\f138";
}
.fa-chevron-circle-up:before {
  content: "\f139";
}
.fa-chevron-circle-down:before {
  content: "\f13a";
}
.fa-html5:before {
  content: "\f13b";
}
.fa-css3:before {
  content: "\f13c";
}
.fa-anchor:before {
  content: "\f13d";
}
.fa-unlock-alt:before {
  content: "\f13e";
}
.fa-bullseye:before {
  content: "\f140";
}
.fa-ellipsis-h:before {
  content: "\f141";
}
.fa-ellipsis-v:before {
  content: "\f142";
}
.fa-rss-square:before {
  content: "\f143";
}
.fa-play-circle:before {
  content: "\f144";
}
.fa-ticket:before {
  content: "\f145";
}
.fa-minus-square:before {
  content: "\f146";
}
.fa-minus-square-o:before {
  content: "\f147";
}
.fa-level-up:before {
  content: "\f148";
}
.fa-level-down:before {
  content: "\f149";
}
.fa-check-square:before {
  content: "\f14a";
}
.fa-pencil-square:before {
  content: "\f14b";
}
.fa-external-link-square:before {
  content: "\f14c";
}
.fa-share-square:before {
  content: "\f14d";
}
.fa-compass:before {
  content: "\f14e";
}
.fa-toggle-down:before,
.fa-caret-square-o-down:before {
  content: "\f150";
}
.fa-toggle-up:before,
.fa-caret-square-o-up:before {
  content: "\f151";
}
.fa-toggle-right:before,
.fa-caret-square-o-right:before {
  content: "\f152";
}
.fa-euro:before,
.fa-eur:before {
  content: "\f153";
}
.fa-gbp:before {
  content: "\f154";
}
.fa-dollar:before,
.fa-usd:before {
  content: "\f155";
}
.fa-rupee:before,
.fa-inr:before {
  content: "\f156";
}
.fa-cny:before,
.fa-rmb:before,
.fa-yen:before,
.fa-jpy:before {
  content: "\f157";
}
.fa-ruble:before,
.fa-rouble:before,
.fa-rub:before {
  content: "\f158";
}
.fa-won:before,
.fa-krw:before {
  content: "\f159";
}
.fa-bitcoin:before,
.fa-btc:before {
  content: "\f15a";
}
.fa-file:before {
  content: "\f15b";
}
.fa-file-text:before {
  content: "\f15c";
}
.fa-sort-alpha-asc:before {
  content: "\f15d";
}
.fa-sort-alpha-desc:before {
  content: "\f15e";
}
.fa-sort-amount-asc:before {
  content: "\f160";
}
.fa-sort-amount-desc:before {
  content: "\f161";
}
.fa-sort-numeric-asc:before {
  content: "\f162";
}
.fa-sort-numeric-desc:before {
  content: "\f163";
}
.fa-thumbs-up:before {
  content: "\f164";
}
.fa-thumbs-down:before {
  content: "\f165";
}
.fa-youtube-square:before {
  content: "\f166";
}
.fa-youtube:before {
  content: "\f167";
}
.fa-xing:before {
  content: "\f168";
}
.fa-xing-square:before {
  content: "\f169";
}
.fa-youtube-play:before {
  content: "\f16a";
}
.fa-dropbox:before {
  content: "\f16b";
}
.fa-stack-overflow:before {
  content: "\f16c";
}
.fa-instagram:before {
  content: "\f16d";
}
.fa-flickr:before {
  content: "\f16e";
}
.fa-adn:before {
  content: "\f170";
}
.fa-bitbucket:before {
  content: "\f171";
}
.fa-bitbucket-square:before {
  content: "\f172";
}
.fa-tumblr:before {
  content: "\f173";
}
.fa-tumblr-square:before {
  content: "\f174";
}
.fa-long-arrow-down:before {
  content: "\f175";
}
.fa-long-arrow-up:before {
  content: "\f176";
}
.fa-long-arrow-left:before {
  content: "\f177";
}
.fa-long-arrow-right:before {
  content: "\f178";
}
.fa-apple:before {
  content: "\f179";
}
.fa-windows:before {
  content: "\f17a";
}
.fa-android:before {
  content: "\f17b";
}
.fa-linux:before {
  content: "\f17c";
}
.fa-dribbble:before {
  content: "\f17d";
}
.fa-skype:before {
  content: "\f17e";
}
.fa-foursquare:before {
  content: "\f180";
}
.fa-trello:before {
  content: "\f181";
}
.fa-female:before {
  content: "\f182";
}
.fa-male:before {
  content: "\f183";
}
.fa-gittip:before,
.fa-gratipay:before {
  content: "\f184";
}
.fa-sun-o:before {
  content: "\f185";
}
.fa-moon-o:before {
  content: "\f186";
}
.fa-archive:before {
  content: "\f187";
}
.fa-bug:before {
  content: "\f188";
}
.fa-vk:before {
  content: "\f189";
}
.fa-weibo:before {
  content: "\f18a";
}
.fa-renren:before {
  content: "\f18b";
}
.fa-pagelines:before {
  content: "\f18c";
}
.fa-stack-exchange:before {
  content: "\f18d";
}
.fa-arrow-circle-o-right:before {
  content: "\f18e";
}
.fa-arrow-circle-o-left:before {
  content: "\f190";
}
.fa-toggle-left:before,
.fa-caret-square-o-left:before {
  content: "\f191";
}
.fa-dot-circle-o:before {
  content: "\f192";
}
.fa-wheelchair:before {
  content: "\f193";
}
.fa-vimeo-square:before {
  content: "\f194";
}
.fa-turkish-lira:before,
.fa-try:before {
  content: "\f195";
}
.fa-plus-square-o:before {
  content: "\f196";
}
.fa-space-shuttle:before {
  content: "\f197";
}
.fa-slack:before {
  content: "\f198";
}
.fa-envelope-square:before {
  content: "\f199";
}
.fa-wordpress:before {
  content: "\f19a";
}
.fa-openid:before {
  content: "\f19b";
}
.fa-institution:before,
.fa-bank:before,
.fa-university:before {
  content: "\f19c";
}
.fa-mortar-board:before,
.fa-graduation-cap:before {
  content: "\f19d";
}
.fa-yahoo:before {
  content: "\f19e";
}
.fa-google:before {
  content: "\f1a0";
}
.fa-reddit:before {
  content: "\f1a1";
}
.fa-reddit-square:before {
  content: "\f1a2";
}
.fa-stumbleupon-circle:before {
  content: "\f1a3";
}
.fa-stumbleupon:before {
  content: "\f1a4";
}
.fa-delicious:before {
  content: "\f1a5";
}
.fa-digg:before {
  content: "\f1a6";
}
.fa-pied-piper-pp:before {
  content: "\f1a7";
}
.fa-pied-piper-alt:before {
  content: "\f1a8";
}
.fa-drupal:before {
  content: "\f1a9";
}
.fa-joomla:before {
  content: "\f1aa";
}
.fa-language:before {
  content: "\f1ab";
}
.fa-fax:before {
  content: "\f1ac";
}
.fa-building:before {
  content: "\f1ad";
}
.fa-child:before {
  content: "\f1ae";
}
.fa-paw:before {
  content: "\f1b0";
}
.fa-spoon:before {
  content: "\f1b1";
}
.fa-cube:before {
  content: "\f1b2";
}
.fa-cubes:before {
  content: "\f1b3";
}
.fa-behance:before {
  content: "\f1b4";
}
.fa-behance-square:before {
  content: "\f1b5";
}
.fa-steam:before {
  content: "\f1b6";
}
.fa-steam-square:before {
  content: "\f1b7";
}
.fa-recycle:before {
  content: "\f1b8";
}
.fa-automobile:before,
.fa-car:before {
  content: "\f1b9";
}
.fa-cab:before,
.fa-taxi:before {
  content: "\f1ba";
}
.fa-tree:before {
  content: "\f1bb";
}
.fa-spotify:before {
  content: "\f1bc";
}
.fa-deviantart:before {
  content: "\f1bd";
}
.fa-soundcloud:before {
  content: "\f1be";
}
.fa-database:before {
  content: "\f1c0";
}
.fa-file-pdf-o:before {
  content: "\f1c1";
}
.fa-file-word-o:before {
  content: "\f1c2";
}
.fa-file-excel-o:before {
  content: "\f1c3";
}
.fa-file-powerpoint-o:before {
  content: "\f1c4";
}
.fa-file-photo-o:before,
.fa-file-picture-o:before,
.fa-file-image-o:before {
  content: "\f1c5";
}
.fa-file-zip-o:before,
.fa-file-archive-o:before {
  content: "\f1c6";
}
.fa-file-sound-o:before,
.fa-file-audio-o:before {
  content: "\f1c7";
}
.fa-file-movie-o:before,
.fa-file-video-o:before {
  content: "\f1c8";
}
.fa-file-code-o:before {
  content: "\f1c9";
}
.fa-vine:before {
  content: "\f1ca";
}
.fa-codepen:before {
  content: "\f1cb";
}
.fa-jsfiddle:before {
  content: "\f1cc";
}
.fa-life-bouy:before,
.fa-life-buoy:before,
.fa-life-saver:before,
.fa-support:before,
.fa-life-ring:before {
  content: "\f1cd";
}
.fa-circle-o-notch:before {
  content: "\f1ce";
}
.fa-ra:before,
.fa-resistance:before,
.fa-rebel:before {
  content: "\f1d0";
}
.fa-ge:before,
.fa-empire:before {
  content: "\f1d1";
}
.fa-git-square:before {
  content: "\f1d2";
}
.fa-git:before {
  content: "\f1d3";
}
.fa-y-combinator-square:before,
.fa-yc-square:before,
.fa-hacker-news:before {
  content: "\f1d4";
}
.fa-tencent-weibo:before {
  content: "\f1d5";
}
.fa-qq:before {
  content: "\f1d6";
}
.fa-wechat:before,
.fa-weixin:before {
  content: "\f1d7";
}
.fa-send:before,
.fa-paper-plane:before {
  content: "\f1d8";
}
.fa-send-o:before,
.fa-paper-plane-o:before {
  content: "\f1d9";
}
.fa-history:before {
  content: "\f1da";
}
.fa-circle-thin:before {
  content: "\f1db";
}
.fa-header:before {
  content: "\f1dc";
}
.fa-paragraph:before {
  content: "\f1dd";
}
.fa-sliders:before {
  content: "\f1de";
}
.fa-share-alt:before {
  content: "\f1e0";
}
.fa-share-alt-square:before {
  content: "\f1e1";
}
.fa-bomb:before {
  content: "\f1e2";
}
.fa-soccer-ball-o:before,
.fa-futbol-o:before {
  content: "\f1e3";
}
.fa-tty:before {
  content: "\f1e4";
}
.fa-binoculars:before {
  content: "\f1e5";
}
.fa-plug:before {
  content: "\f1e6";
}
.fa-slideshare:before {
  content: "\f1e7";
}
.fa-twitch:before {
  content: "\f1e8";
}
.fa-yelp:before {
  content: "\f1e9";
}
.fa-newspaper-o:before {
  content: "\f1ea";
}
.fa-wifi:before {
  content: "\f1eb";
}
.fa-calculator:before {
  content: "\f1ec";
}
.fa-paypal:before {
  content: "\f1ed";
}
.fa-google-wallet:before {
  content: "\f1ee";
}
.fa-cc-visa:before {
  content: "\f1f0";
}
.fa-cc-mastercard:before {
  content: "\f1f1";
}
.fa-cc-discover:before {
  content: "\f1f2";
}
.fa-cc-amex:before {
  content: "\f1f3";
}
.fa-cc-paypal:before {
  content: "\f1f4";
}
.fa-cc-stripe:before {
  content: "\f1f5";
}
.fa-bell-slash:before {
  content: "\f1f6";
}
.fa-bell-slash-o:before {
  content: "\f1f7";
}
.fa-trash:before {
  content: "\f1f8";
}
.fa-copyright:before {
  content: "\f1f9";
}
.fa-at:before {
  content: "\f1fa";
}
.fa-eyedropper:before {
  content: "\f1fb";
}
.fa-paint-brush:before {
  content: "\f1fc";
}
.fa-birthday-cake:before {
  content: "\f1fd";
}
.fa-area-chart:before {
  content: "\f1fe";
}
.fa-pie-chart:before {
  content: "\f200";
}
.fa-line-chart:before {
  content: "\f201";
}
.fa-lastfm:before {
  content: "\f202";
}
.fa-lastfm-square:before {
  content: "\f203";
}
.fa-toggle-off:before {
  content: "\f204";
}
.fa-toggle-on:before {
  content: "\f205";
}
.fa-bicycle:before {
  content: "\f206";
}
.fa-bus:before {
  content: "\f207";
}
.fa-ioxhost:before {
  content: "\f208";
}
.fa-angellist:before {
  content: "\f209";
}
.fa-cc:before {
  content: "\f20a";
}
.fa-shekel:before,
.fa-sheqel:before,
.fa-ils:before {
  content: "\f20b";
}
.fa-meanpath:before {
  content: "\f20c";
}
.fa-buysellads:before {
  content: "\f20d";
}
.fa-connectdevelop:before {
  content: "\f20e";
}
.fa-dashcube:before {
  content: "\f210";
}
.fa-forumbee:before {
  content: "\f211";
}
.fa-leanpub:before {
  content: "\f212";
}
.fa-sellsy:before {
  content: "\f213";
}
.fa-shirtsinbulk:before {
  content: "\f214";
}
.fa-simplybuilt:before {
  content: "\f215";
}
.fa-skyatlas:before {
  content: "\f216";
}
.fa-cart-plus:before {
  content: "\f217";
}
.fa-cart-arrow-down:before {
  content: "\f218";
}
.fa-diamond:before {
  content: "\f219";
}
.fa-ship:before {
  content: "\f21a";
}
.fa-user-secret:before {
  content: "\f21b";
}
.fa-motorcycle:before {
  content: "\f21c";
}
.fa-street-view:before {
  content: "\f21d";
}
.fa-heartbeat:before {
  content: "\f21e";
}
.fa-venus:before {
  content: "\f221";
}
.fa-mars:before {
  content: "\f222";
}
.fa-mercury:before {
  content: "\f223";
}
.fa-intersex:before,
.fa-transgender:before {
  content: "\f224";
}
.fa-transgender-alt:before {
  content: "\f225";
}
.fa-venus-double:before {
  content: "\f226";
}
.fa-mars-double:before {
  content: "\f227";
}
.fa-venus-mars:before {
  content: "\f228";
}
.fa-mars-stroke:before {
  content: "\f229";
}
.fa-mars-stroke-v:before {
  content: "\f22a";
}
.fa-mars-stroke-h:before {
  content: "\f22b";
}
.fa-neuter:before {
  content: "\f22c";
}
.fa-genderless:before {
  content: "\f22d";
}
.fa-facebook-official:before {
  content: "\f230";
}
.fa-pinterest-p:before {
  content: "\f231";
}
.fa-whatsapp:before {
  content: "\f232";
}
.fa-server:before {
  content: "\f233";
}
.fa-user-plus:before {
  content: "\f234";
}
.fa-user-times:before {
  content: "\f235";
}
.fa-hotel:before,
.fa-bed:before {
  content: "\f236";
}
.fa-viacoin:before {
  content: "\f237";
}
.fa-train:before {
  content: "\f238";
}
.fa-subway:before {
  content: "\f239";
}
.fa-medium:before {
  content: "\f23a";
}
.fa-yc:before,
.fa-y-combinator:before {
  content: "\f23b";
}
.fa-optin-monster:before {
  content: "\f23c";
}
.fa-opencart:before {
  content: "\f23d";
}
.fa-expeditedssl:before {
  content: "\f23e";
}
.fa-battery-4:before,
.fa-battery:before,
.fa-battery-full:before {
  content: "\f240";
}
.fa-battery-3:before,
.fa-battery-three-quarters:before {
  content: "\f241";
}
.fa-battery-2:before,
.fa-battery-half:before {
  content: "\f242";
}
.fa-battery-1:before,
.fa-battery-quarter:before {
  content: "\f243";
}
.fa-battery-0:before,
.fa-battery-empty:before {
  content: "\f244";
}
.fa-mouse-pointer:before {
  content: "\f245";
}
.fa-i-cursor:before {
  content: "\f246";
}
.fa-object-group:before {
  content: "\f247";
}
.fa-object-ungroup:before {
  content: "\f248";
}
.fa-sticky-note:before {
  content: "\f249";
}
.fa-sticky-note-o:before {
  content: "\f24a";
}
.fa-cc-jcb:before {
  content: "\f24b";
}
.fa-cc-diners-club:before {
  content: "\f24c";
}
.fa-clone:before {
  content: "\f24d";
}
.fa-balance-scale:before {
  content: "\f24e";
}
.fa-hourglass-o:before {
  content: "\f250";
}
.fa-hourglass-1:before,
.fa-hourglass-start:before {
  content: "\f251";
}
.fa-hourglass-2:before,
.fa-hourglass-half:before {
  content: "\f252";
}
.fa-hourglass-3:before,
.fa-hourglass-end:before {
  content: "\f253";
}
.fa-hourglass:before {
  content: "\f254";
}
.fa-hand-grab-o:before,
.fa-hand-rock-o:before {
  content: "\f255";
}
.fa-hand-stop-o:before,
.fa-hand-paper-o:before {
  content: "\f256";
}
.fa-hand-scissors-o:before {
  content: "\f257";
}
.fa-hand-lizard-o:before {
  content: "\f258";
}
.fa-hand-spock-o:before {
  content: "\f259";
}
.fa-hand-pointer-o:before {
  content: "\f25a";
}
.fa-hand-peace-o:before {
  content: "\f25b";
}
.fa-trademark:before {
  content: "\f25c";
}
.fa-registered:before {
  content: "\f25d";
}
.fa-creative-commons:before {
  content: "\f25e";
}
.fa-gg:before {
  content: "\f260";
}
.fa-gg-circle:before {
  content: "\f261";
}
.fa-tripadvisor:before {
  content: "\f262";
}
.fa-odnoklassniki:before {
  content: "\f263";
}
.fa-odnoklassniki-square:before {
  content: "\f264";
}
.fa-get-pocket:before {
  content: "\f265";
}
.fa-wikipedia-w:before {
  content: "\f266";
}
.fa-safari:before {
  content: "\f267";
}
.fa-chrome:before {
  content: "\f268";
}
.fa-firefox:before {
  content: "\f269";
}
.fa-opera:before {
  content: "\f26a";
}
.fa-internet-explorer:before {
  content: "\f26b";
}
.fa-tv:before,
.fa-television:before {
  content: "\f26c";
}
.fa-contao:before {
  content: "\f26d";
}
.fa-500px:before {
  content: "\f26e";
}
.fa-amazon:before {
  content: "\f270";
}
.fa-calendar-plus-o:before {
  content: "\f271";
}
.fa-calendar-minus-o:before {
  content: "\f272";
}
.fa-calendar-times-o:before {
  content: "\f273";
}
.fa-calendar-check-o:before {
  content: "\f274";
}
.fa-industry:before {
  content: "\f275";
}
.fa-map-pin:before {
  content: "\f276";
}
.fa-map-signs:before {
  content: "\f277";
}
.fa-map-o:before {
  content: "\f278";
}
.fa-map:before {
  content: "\f279";
}
.fa-commenting:before {
  content: "\f27a";
}
.fa-commenting-o:before {
  content: "\f27b";
}
.fa-houzz:before {
  content: "\f27c";
}
.fa-vimeo:before {
  content: "\f27d";
}
.fa-black-tie:before {
  content: "\f27e";
}
.fa-fonticons:before {
  content: "\f280";
}
.fa-reddit-alien:before {
  content: "\f281";
}
.fa-edge:before {
  content: "\f282";
}
.fa-credit-card-alt:before {
  content: "\f283";
}
.fa-codiepie:before {
  content: "\f284";
}
.fa-modx:before {
  content: "\f285";
}
.fa-fort-awesome:before {
  content: "\f286";
}
.fa-usb:before {
  content: "\f287";
}
.fa-product-hunt:before {
  content: "\f288";
}
.fa-mixcloud:before {
  content: "\f289";
}
.fa-scribd:before {
  content: "\f28a";
}
.fa-pause-circle:before {
  content: "\f28b";
}
.fa-pause-circle-o:before {
  content: "\f28c";
}
.fa-stop-circle:before {
  content: "\f28d";
}
.fa-stop-circle-o:before {
  content: "\f28e";
}
.fa-shopping-bag:before {
  content: "\f290";
}
.fa-shopping-basket:before {
  content: "\f291";
}
.fa-hashtag:before {
  content: "\f292";
}
.fa-bluetooth:before {
  content: "\f293";
}
.fa-bluetooth-b:before {
  content: "\f294";
}
.fa-percent:before {
  content: "\f295";
}
.fa-gitlab:before {
  content: "\f296";
}
.fa-wpbeginner:before {
  content: "\f297";
}
.fa-wpforms:before {
  content: "\f298";
}
.fa-envira:before {
  content: "\f299";
}
.fa-universal-access:before {
  content: "\f29a";
}
.fa-wheelchair-alt:before {
  content: "\f29b";
}
.fa-question-circle-o:before {
  content: "\f29c";
}
.fa-blind:before {
  content: "\f29d";
}
.fa-audio-description:before {
  content: "\f29e";
}
.fa-volume-control-phone:before {
  content: "\f2a0";
}
.fa-braille:before {
  content: "\f2a1";
}
.fa-assistive-listening-systems:before {
  content: "\f2a2";
}
.fa-asl-interpreting:before,
.fa-american-sign-language-interpreting:before {
  content: "\f2a3";
}
.fa-deafness:before,
.fa-hard-of-hearing:before,
.fa-deaf:before {
  content: "\f2a4";
}
.fa-glide:before {
  content: "\f2a5";
}
.fa-glide-g:before {
  content: "\f2a6";
}
.fa-signing:before,
.fa-sign-language:before {
  content: "\f2a7";
}
.fa-low-vision:before {
  content: "\f2a8";
}
.fa-viadeo:before {
  content: "\f2a9";
}
.fa-viadeo-square:before {
  content: "\f2aa";
}
.fa-snapchat:before {
  content: "\f2ab";
}
.fa-snapchat-ghost:before {
  content: "\f2ac";
}
.fa-snapchat-square:before {
  content: "\f2ad";
}
.fa-pied-piper:before {
  content: "\f2ae";
}
.fa-first-order:before {
  content: "\f2b0";
}
.fa-yoast:before {
  content: "\f2b1";
}
.fa-themeisle:before {
  content: "\f2b2";
}
.fa-google-plus-circle:before,
.fa-google-plus-official:before {
  content: "\f2b3";
}
.fa-fa:before,
.fa-font-awesome:before {
  content: "\f2b4";
}
.fa-handshake-o:before {
  content: "\f2b5";
}
.fa-envelope-open:before {
  content: "\f2b6";
}
.fa-envelope-open-o:before {
  content: "\f2b7";
}
.fa-linode:before {
  content: "\f2b8";
}
.fa-address-book:before {
  content: "\f2b9";
}
.fa-address-book-o:before {
  content: "\f2ba";
}
.fa-vcard:before,
.fa-address-card:before {
  content: "\f2bb";
}
.fa-vcard-o:before,
.fa-address-card-o:before {
  content: "\f2bc";
}
.fa-user-circle:before {
  content: "\f2bd";
}
.fa-user-circle-o:before {
  content: "\f2be";
}
.fa-user-o:before {
  content: "\f2c0";
}
.fa-id-badge:before {
  content: "\f2c1";
}
.fa-drivers-license:before,
.fa-id-card:before {
  content: "\f2c2";
}
.fa-drivers-license-o:before,
.fa-id-card-o:before {
  content: "\f2c3";
}
.fa-quora:before {
  content: "\f2c4";
}
.fa-free-code-camp:before {
  content: "\f2c5";
}
.fa-telegram:before {
  content: "\f2c6";
}
.fa-thermometer-4:before,
.fa-thermometer:before,
.fa-thermometer-full:before {
  content: "\f2c7";
}
.fa-thermometer-3:before,
.fa-thermometer-three-quarters:before {
  content: "\f2c8";
}
.fa-thermometer-2:before,
.fa-thermometer-half:before {
  content: "\f2c9";
}
.fa-thermometer-1:before,
.fa-thermometer-quarter:before {
  content: "\f2ca";
}
.fa-thermometer-0:before,
.fa-thermometer-empty:before {
  content: "\f2cb";
}
.fa-shower:before {
  content: "\f2cc";
}
.fa-bathtub:before,
.fa-s15:before,
.fa-bath:before {
  content: "\f2cd";
}
.fa-podcast:before {
  content: "\f2ce";
}
.fa-window-maximize:before {
  content: "\f2d0";
}
.fa-window-minimize:before {
  content: "\f2d1";
}
.fa-window-restore:before {
  content: "\f2d2";
}
.fa-times-rectangle:before,
.fa-window-close:before {
  content: "\f2d3";
}
.fa-times-rectangle-o:before,
.fa-window-close-o:before {
  content: "\f2d4";
}
.fa-bandcamp:before {
  content: "\f2d5";
}
.fa-grav:before {
  content: "\f2d6";
}
.fa-etsy:before {
  content: "\f2d7";
}
.fa-imdb:before {
  content: "\f2d8";
}
.fa-ravelry:before {
  content: "\f2d9";
}
.fa-eercast:before {
  content: "\f2da";
}
.fa-microchip:before {
  content: "\f2db";
}
.fa-snowflake-o:before {
  content: "\f2dc";
}
.fa-superpowers:before {
  content: "\f2dd";
}
.fa-wpexplorer:before {
  content: "\f2de";
}
.fa-meetup:before {
  content: "\f2e0";
}
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  border: 0;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static;
  width: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  clip: auto;
}
/*!
*
* IPython base
*
*/
.modal.fade .modal-dialog {
  -webkit-transform: translate(0, 0);
  -ms-transform: translate(0, 0);
  -o-transform: translate(0, 0);
  transform: translate(0, 0);
}
code {
  color: #000;
}
pre {
  font-size: inherit;
  line-height: inherit;
}
label {
  font-weight: normal;
}
/* Make the page background atleast 100% the height of the view port */
/* Make the page itself atleast 70% the height of the view port */
.border-box-sizing {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.corner-all {
  border-radius: 2px;
}
.no-padding {
  padding: 0px;
}
/* Flexible box model classes */
/* Taken from Alex Russell http://infrequently.org/2009/08/css-3-progress/ */
/* This file is a compatability layer.  It allows the usage of flexible box 
model layouts accross multiple browsers, including older browsers.  The newest,
universal implementation of the flexible box model is used when available (see
`Modern browsers` comments below).  Browsers that are known to implement this 
new spec completely include:

    Firefox 28.0+
    Chrome 29.0+
    Internet Explorer 11+ 
    Opera 17.0+

Browsers not listed, including Safari, are supported via the styling under the
`Old browsers` comments below.
*/
.hbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
.hbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.vbox {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
.vbox > * {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
}
.hbox.reverse,
.vbox.reverse,
.reverse {
  /* Old browsers */
  -webkit-box-direction: reverse;
  -moz-box-direction: reverse;
  box-direction: reverse;
  /* Modern browsers */
  flex-direction: row-reverse;
}
.hbox.box-flex0,
.vbox.box-flex0,
.box-flex0 {
  /* Old browsers */
  -webkit-box-flex: 0;
  -moz-box-flex: 0;
  box-flex: 0;
  /* Modern browsers */
  flex: none;
  width: auto;
}
.hbox.box-flex1,
.vbox.box-flex1,
.box-flex1 {
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex,
.vbox.box-flex,
.box-flex {
  /* Old browsers */
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
.hbox.box-flex2,
.vbox.box-flex2,
.box-flex2 {
  /* Old browsers */
  -webkit-box-flex: 2;
  -moz-box-flex: 2;
  box-flex: 2;
  /* Modern browsers */
  flex: 2;
}
.box-group1 {
  /*  Deprecated */
  -webkit-box-flex-group: 1;
  -moz-box-flex-group: 1;
  box-flex-group: 1;
}
.box-group2 {
  /* Deprecated */
  -webkit-box-flex-group: 2;
  -moz-box-flex-group: 2;
  box-flex-group: 2;
}
.hbox.start,
.vbox.start,
.start {
  /* Old browsers */
  -webkit-box-pack: start;
  -moz-box-pack: start;
  box-pack: start;
  /* Modern browsers */
  justify-content: flex-start;
}
.hbox.end,
.vbox.end,
.end {
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
}
.hbox.center,
.vbox.center,
.center {
  /* Old browsers */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  box-pack: center;
  /* Modern browsers */
  justify-content: center;
}
.hbox.baseline,
.vbox.baseline,
.baseline {
  /* Old browsers */
  -webkit-box-pack: baseline;
  -moz-box-pack: baseline;
  box-pack: baseline;
  /* Modern browsers */
  justify-content: baseline;
}
.hbox.stretch,
.vbox.stretch,
.stretch {
  /* Old browsers */
  -webkit-box-pack: stretch;
  -moz-box-pack: stretch;
  box-pack: stretch;
  /* Modern browsers */
  justify-content: stretch;
}
.hbox.align-start,
.vbox.align-start,
.align-start {
  /* Old browsers */
  -webkit-box-align: start;
  -moz-box-align: start;
  box-align: start;
  /* Modern browsers */
  align-items: flex-start;
}
.hbox.align-end,
.vbox.align-end,
.align-end {
  /* Old browsers */
  -webkit-box-align: end;
  -moz-box-align: end;
  box-align: end;
  /* Modern browsers */
  align-items: flex-end;
}
.hbox.align-center,
.vbox.align-center,
.align-center {
  /* Old browsers */
  -webkit-box-align: center;
  -moz-box-align: center;
  box-align: center;
  /* Modern browsers */
  align-items: center;
}
.hbox.align-baseline,
.vbox.align-baseline,
.align-baseline {
  /* Old browsers */
  -webkit-box-align: baseline;
  -moz-box-align: baseline;
  box-align: baseline;
  /* Modern browsers */
  align-items: baseline;
}
.hbox.align-stretch,
.vbox.align-stretch,
.align-stretch {
  /* Old browsers */
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  box-align: stretch;
  /* Modern browsers */
  align-items: stretch;
}
div.error {
  margin: 2em;
  text-align: center;
}
div.error > h1 {
  font-size: 500%;
  line-height: normal;
}
div.error > p {
  font-size: 200%;
  line-height: normal;
}
div.traceback-wrapper {
  text-align: left;
  max-width: 800px;
  margin: auto;
}
div.traceback-wrapper pre.traceback {
  max-height: 600px;
  overflow: auto;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
body {
  background-color: #fff;
  /* This makes sure that the body covers the entire window and needs to
       be in a different element than the display: box in wrapper below */
  position: absolute;
  left: 0px;
  right: 0px;
  top: 0px;
  bottom: 0px;
  overflow: visible;
}
body > #header {
  /* Initially hidden to prevent FLOUC */
  display: none;
  background-color: #fff;
  /* Display over codemirror */
  position: relative;
  z-index: 100;
}
body > #header #header-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  padding: 5px;
  padding-bottom: 5px;
  padding-top: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
body > #header .header-bar {
  width: 100%;
  height: 1px;
  background: #e7e7e7;
  margin-bottom: -1px;
}
@media print {
  body > #header {
    display: none !important;
  }
}
#header-spacer {
  width: 100%;
  visibility: hidden;
}
@media print {
  #header-spacer {
    display: none;
  }
}
#ipython_notebook {
  padding-left: 0px;
  padding-top: 1px;
  padding-bottom: 1px;
}
[dir="rtl"] #ipython_notebook {
  margin-right: 10px;
  margin-left: 0;
}
[dir="rtl"] #ipython_notebook.pull-left {
  float: right !important;
  float: right;
}
.flex-spacer {
  flex: 1;
}
#noscript {
  width: auto;
  padding-top: 16px;
  padding-bottom: 16px;
  text-align: center;
  font-size: 22px;
  color: red;
  font-weight: bold;
}
#ipython_notebook img {
  height: 28px;
}
#site {
  width: 100%;
  display: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  overflow: auto;
}
@media print {
  #site {
    height: auto !important;
  }
}
/* Smaller buttons */
.ui-button .ui-button-text {
  padding: 0.2em 0.8em;
  font-size: 77%;
}
input.ui-button {
  padding: 0.3em 0.9em;
}
span#kernel_logo_widget {
  margin: 0 10px;
}
span#login_widget {
  float: right;
}
[dir="rtl"] span#login_widget {
  float: left;
}
span#login_widget > .button,
#logout {
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button:focus,
#logout:focus,
span#login_widget > .button.focus,
#logout.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
span#login_widget > .button:hover,
#logout:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
span#login_widget > .button:active:hover,
#logout:active:hover,
span#login_widget > .button.active:hover,
#logout.active:hover,
.open > .dropdown-togglespan#login_widget > .button:hover,
.open > .dropdown-toggle#logout:hover,
span#login_widget > .button:active:focus,
#logout:active:focus,
span#login_widget > .button.active:focus,
#logout.active:focus,
.open > .dropdown-togglespan#login_widget > .button:focus,
.open > .dropdown-toggle#logout:focus,
span#login_widget > .button:active.focus,
#logout:active.focus,
span#login_widget > .button.active.focus,
#logout.active.focus,
.open > .dropdown-togglespan#login_widget > .button.focus,
.open > .dropdown-toggle#logout.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
span#login_widget > .button:active,
#logout:active,
span#login_widget > .button.active,
#logout.active,
.open > .dropdown-togglespan#login_widget > .button,
.open > .dropdown-toggle#logout {
  background-image: none;
}
span#login_widget > .button.disabled:hover,
#logout.disabled:hover,
span#login_widget > .button[disabled]:hover,
#logout[disabled]:hover,
fieldset[disabled] span#login_widget > .button:hover,
fieldset[disabled] #logout:hover,
span#login_widget > .button.disabled:focus,
#logout.disabled:focus,
span#login_widget > .button[disabled]:focus,
#logout[disabled]:focus,
fieldset[disabled] span#login_widget > .button:focus,
fieldset[disabled] #logout:focus,
span#login_widget > .button.disabled.focus,
#logout.disabled.focus,
span#login_widget > .button[disabled].focus,
#logout[disabled].focus,
fieldset[disabled] span#login_widget > .button.focus,
fieldset[disabled] #logout.focus {
  background-color: #fff;
  border-color: #ccc;
}
span#login_widget > .button .badge,
#logout .badge {
  color: #fff;
  background-color: #333;
}
.nav-header {
  text-transform: none;
}
#header > span {
  margin-top: 10px;
}
.modal_stretch .modal-dialog {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  min-height: 80vh;
}
.modal_stretch .modal-dialog .modal-body {
  max-height: calc(100vh - 200px);
  overflow: auto;
  flex: 1;
}
.modal-header {
  cursor: move;
}
@media (min-width: 768px) {
  .modal .modal-dialog {
    width: 700px;
  }
}
@media (min-width: 768px) {
  select.form-control {
    margin-left: 12px;
    margin-right: 12px;
  }
}
/*!
*
* IPython auth
*
*/
.center-nav {
  display: inline-block;
  margin-bottom: -4px;
}
[dir="rtl"] .center-nav form.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] .center-nav .navbar-text {
  float: right;
}
[dir="rtl"] .navbar-inner {
  text-align: right;
}
[dir="rtl"] div.text-left {
  text-align: right;
}
/*!
*
* IPython tree view
*
*/
/* We need an invisible input field on top of the sentense*/
/* "Drag file onto the list ..." */
.alternate_upload {
  background-color: none;
  display: inline;
}
.alternate_upload.form {
  padding: 0;
  margin: 0;
}
.alternate_upload input.fileinput {
  position: absolute;
  display: block;
  width: 100%;
  height: 100%;
  overflow: hidden;
  cursor: pointer;
  opacity: 0;
  z-index: 2;
}
.alternate_upload .btn-xs > input.fileinput {
  margin: -1px -5px;
}
.alternate_upload .btn-upload {
  position: relative;
  height: 22px;
}
::-webkit-file-upload-button {
  cursor: pointer;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
ul#tabs {
  margin-bottom: 4px;
}
ul#tabs a {
  padding-top: 6px;
  padding-bottom: 4px;
}
[dir="rtl"] ul#tabs.nav-tabs > li {
  float: right;
}
[dir="rtl"] ul#tabs.nav.nav-tabs {
  padding-right: 0;
}
ul.breadcrumb a:focus,
ul.breadcrumb a:hover {
  text-decoration: none;
}
ul.breadcrumb i.icon-home {
  font-size: 16px;
  margin-right: 4px;
}
ul.breadcrumb span {
  color: #5e5e5e;
}
.list_toolbar {
  padding: 4px 0 4px 0;
  vertical-align: middle;
}
.list_toolbar .tree-buttons {
  padding-top: 1px;
}
[dir="rtl"] .list_toolbar .tree-buttons .pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .list_toolbar .col-sm-4,
[dir="rtl"] .list_toolbar .col-sm-8 {
  float: right;
}
.dynamic-buttons {
  padding-top: 3px;
  display: inline-block;
}
.list_toolbar [class*="span"] {
  min-height: 24px;
}
.list_header {
  font-weight: bold;
  background-color: #EEE;
}
.list_placeholder {
  font-weight: bold;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
}
.list_container {
  margin-top: 4px;
  margin-bottom: 20px;
  border: 1px solid #ddd;
  border-radius: 2px;
}
.list_container > div {
  border-bottom: 1px solid #ddd;
}
.list_container > div:hover .list-item {
  background-color: red;
}
.list_container > div:last-child {
  border: none;
}
.list_item:hover .list_item {
  background-color: #ddd;
}
.list_item a {
  text-decoration: none;
}
.list_item:hover {
  background-color: #fafafa;
}
.list_header > div,
.list_item > div {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
.list_header > div input,
.list_item > div input {
  margin-right: 7px;
  margin-left: 14px;
  vertical-align: text-bottom;
  line-height: 22px;
  position: relative;
  top: -1px;
}
.list_header > div .item_link,
.list_item > div .item_link {
  margin-left: -1px;
  vertical-align: baseline;
  line-height: 22px;
}
[dir="rtl"] .list_item > div input {
  margin-right: 0;
}
.new-file input[type=checkbox] {
  visibility: hidden;
}
.item_name {
  line-height: 22px;
  height: 24px;
}
.item_icon {
  font-size: 14px;
  color: #5e5e5e;
  margin-right: 7px;
  margin-left: 7px;
  line-height: 22px;
  vertical-align: baseline;
}
.item_modified {
  margin-right: 7px;
  margin-left: 7px;
}
[dir="rtl"] .item_modified.pull-right {
  float: left !important;
  float: left;
}
.item_buttons {
  line-height: 1em;
  margin-left: -5px;
}
.item_buttons .btn,
.item_buttons .btn-group,
.item_buttons .input-group {
  float: left;
}
.item_buttons > .btn,
.item_buttons > .btn-group,
.item_buttons > .input-group {
  margin-left: 5px;
}
.item_buttons .btn {
  min-width: 13ex;
}
.item_buttons .running-indicator {
  padding-top: 4px;
  color: #5cb85c;
}
.item_buttons .kernel-name {
  padding-top: 4px;
  color: #5bc0de;
  margin-right: 7px;
  float: left;
}
[dir="rtl"] .item_buttons.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .item_buttons .kernel-name {
  margin-left: 7px;
  float: right;
}
.toolbar_info {
  height: 24px;
  line-height: 24px;
}
.list_item input:not([type=checkbox]) {
  padding-top: 3px;
  padding-bottom: 3px;
  height: 22px;
  line-height: 14px;
  margin: 0px;
}
.highlight_text {
  color: blue;
}
#project_name {
  display: inline-block;
  padding-left: 7px;
  margin-left: -2px;
}
#project_name > .breadcrumb {
  padding: 0px;
  margin-bottom: 0px;
  background-color: transparent;
  font-weight: bold;
}
.sort_button {
  display: inline-block;
  padding-left: 7px;
}
[dir="rtl"] .sort_button.pull-right {
  float: left !important;
  float: left;
}
#tree-selector {
  padding-right: 0px;
}
#button-select-all {
  min-width: 50px;
}
[dir="rtl"] #button-select-all.btn {
  float: right ;
}
#select-all {
  margin-left: 7px;
  margin-right: 2px;
  margin-top: 2px;
  height: 16px;
}
[dir="rtl"] #select-all.pull-left {
  float: right !important;
  float: right;
}
.menu_icon {
  margin-right: 2px;
}
.tab-content .row {
  margin-left: 0px;
  margin-right: 0px;
}
.folder_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f114";
}
.folder_icon:before.fa-pull-left {
  margin-right: .3em;
}
.folder_icon:before.fa-pull-right {
  margin-left: .3em;
}
.folder_icon:before.pull-left {
  margin-right: .3em;
}
.folder_icon:before.pull-right {
  margin-left: .3em;
}
.notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
}
.notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.notebook_icon:before.pull-left {
  margin-right: .3em;
}
.notebook_icon:before.pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f02d";
  position: relative;
  top: -1px;
  color: #5cb85c;
}
.running_notebook_icon:before.fa-pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.fa-pull-right {
  margin-left: .3em;
}
.running_notebook_icon:before.pull-left {
  margin-right: .3em;
}
.running_notebook_icon:before.pull-right {
  margin-left: .3em;
}
.file_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f016";
  position: relative;
  top: -2px;
}
.file_icon:before.fa-pull-left {
  margin-right: .3em;
}
.file_icon:before.fa-pull-right {
  margin-left: .3em;
}
.file_icon:before.pull-left {
  margin-right: .3em;
}
.file_icon:before.pull-right {
  margin-left: .3em;
}
#notebook_toolbar .pull-right {
  padding-top: 0px;
  margin-right: -1px;
}
ul#new-menu {
  left: auto;
  right: 0;
}
#new-menu .dropdown-header {
  font-size: 10px;
  border-bottom: 1px solid #e5e5e5;
  padding: 0 0 3px;
  margin: -3px 20px 0;
}
.kernel-menu-icon {
  padding-right: 12px;
  width: 24px;
  content: "\f096";
}
.kernel-menu-icon:before {
  content: "\f096";
}
.kernel-menu-icon-current:before {
  content: "\f00c";
}
#tab_content {
  padding-top: 20px;
}
#running .panel-group .panel {
  margin-top: 3px;
  margin-bottom: 1em;
}
#running .panel-group .panel .panel-heading {
  background-color: #EEE;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 7px;
  padding-right: 7px;
  line-height: 22px;
}
#running .panel-group .panel .panel-heading a:focus,
#running .panel-group .panel .panel-heading a:hover {
  text-decoration: none;
}
#running .panel-group .panel .panel-body {
  padding: 0px;
}
#running .panel-group .panel .panel-body .list_container {
  margin-top: 0px;
  margin-bottom: 0px;
  border: 0px;
  border-radius: 0px;
}
#running .panel-group .panel .panel-body .list_container .list_item {
  border-bottom: 1px solid #ddd;
}
#running .panel-group .panel .panel-body .list_container .list_item:last-child {
  border-bottom: 0px;
}
.delete-button {
  display: none;
}
.duplicate-button {
  display: none;
}
.rename-button {
  display: none;
}
.move-button {
  display: none;
}
.download-button {
  display: none;
}
.shutdown-button {
  display: none;
}
.dynamic-instructions {
  display: inline-block;
  padding-top: 4px;
}
/*!
*
* IPython text editor webapp
*
*/
.selected-keymap i.fa {
  padding: 0px 5px;
}
.selected-keymap i.fa:before {
  content: "\f00c";
}
#mode-menu {
  overflow: auto;
  max-height: 20em;
}
.edit_app #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.edit_app #menubar .navbar {
  /* Use a negative 1 bottom margin, so the border overlaps the border of the
    header */
  margin-bottom: -1px;
}
.dirty-indicator {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator.pull-left {
  margin-right: .3em;
}
.dirty-indicator.pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-dirty.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-dirty.pull-left {
  margin-right: .3em;
}
.dirty-indicator-dirty.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 20px;
}
.dirty-indicator-clean.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean.pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f00c";
}
.dirty-indicator-clean:before.fa-pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.fa-pull-right {
  margin-left: .3em;
}
.dirty-indicator-clean:before.pull-left {
  margin-right: .3em;
}
.dirty-indicator-clean:before.pull-right {
  margin-left: .3em;
}
#filename {
  font-size: 16pt;
  display: table;
  padding: 0px 5px;
}
#current-mode {
  padding-left: 5px;
  padding-right: 5px;
}
#texteditor-backdrop {
  padding-top: 20px;
  padding-bottom: 20px;
}
@media not print {
  #texteditor-backdrop {
    background-color: #EEE;
  }
}
@media print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container .CodeMirror-gutter,
  #texteditor-backdrop #texteditor-container .CodeMirror-gutters {
    background-color: #fff;
  }
}
@media not print {
  #texteditor-backdrop #texteditor-container {
    padding: 0px;
    background-color: #fff;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
.CodeMirror-dialog {
  background-color: #fff;
}
/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area .rendered_html table {
  margin-left: 0;
  margin-right: 0;
}
div.output_area .rendered_html img {
  margin-left: 0;
  margin-right: 0;
}
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}
.rendered_html em {
  font-style: italic;
}
.rendered_html strong {
  font-weight: bold;
}
.rendered_html u {
  text-decoration: underline;
}
.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}
.rendered_html h1 {
  font-size: 185.7%;
  margin: 1.08em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h2 {
  font-size: 157.1%;
  margin: 1.27em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h3 {
  font-size: 128.6%;
  margin: 1.55em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h4 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
}
.rendered_html h5 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h6 {
  font-size: 100%;
  margin: 2em 0 0 0;
  font-weight: bold;
  line-height: 1.0;
  font-style: italic;
}
.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}
.rendered_html ul {
  list-style: disc;
}
.rendered_html ul ul {
  list-style: square;
  margin-top: 0;
}
.rendered_html ul ul ul {
  list-style: circle;
}
.rendered_html ol {
  list-style: decimal;
}
.rendered_html ol ol {
  list-style: upper-alpha;
  margin-top: 0;
}
.rendered_html ol ol ol {
  list-style: lower-alpha;
}
.rendered_html ol ol ol ol {
  list-style: lower-roman;
}
.rendered_html ol ol ol ol ol {
  list-style: decimal;
}
.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}
.rendered_html hr {
  color: black;
  background-color: black;
}
.rendered_html pre {
  margin: 1em 2em;
  padding: 0px;
  background-color: #fff;
}
.rendered_html code {
  background-color: #eff0f1;
}
.rendered_html p code {
  padding: 1px 5px;
}
.rendered_html pre code {
  background-color: #fff;
}
.rendered_html pre,
.rendered_html code {
  border: 0;
  color: #000;
  font-size: 100%;
}
.rendered_html blockquote {
  margin: 1em 2em;
}
.rendered_html table {
  margin-left: auto;
  margin-right: auto;
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.rendered_html tr,
.rendered_html th,
.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.rendered_html th {
  font-weight: bold;
}
.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}
.rendered_html p {
  text-align: left;
}
.rendered_html * + p {
  margin-top: 1em;
}
.rendered_html img {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,
.rendered_html svg {
  max-width: 100%;
  height: auto;
}
.rendered_html img.unconfined,
.rendered_html svg.unconfined {
  max-width: none;
}
.rendered_html .alert {
  margin-bottom: initial;
}
.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] .rendered_html p {
  text-align: right;
}
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered .rendered_html {
  overflow-x: auto;
  overflow-y: hidden;
}
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered .rendered_html td {
  max-width: none;
}
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
/*!
*
* IPython notebook webapp
*
*/
@media (max-width: 767px) {
  .notebook_app {
    padding-left: 0px;
    padding-right: 0px;
  }
}
#ipython-main-app {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook_panel {
  margin: 0px;
  padding: 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  height: 100%;
}
div#notebook {
  font-size: 14px;
  line-height: 20px;
  overflow-y: hidden;
  overflow-x: auto;
  width: 100%;
  /* This spaces the page away from the edge of the notebook area */
  padding-top: 20px;
  margin: 0px;
  outline: none;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  min-height: 100%;
}
@media not print {
  #notebook-container {
    padding: 15px;
    background-color: #fff;
    min-height: 0;
    -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
    box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  }
}
@media print {
  #notebook-container {
    width: 100%;
  }
}
div.ui-widget-content {
  border: 1px solid #ababab;
  outline: none;
}
pre.dialog {
  background-color: #f7f7f7;
  border: 1px solid #ddd;
  border-radius: 2px;
  padding: 0.4em;
  padding-left: 2em;
}
p.dialog {
  padding: 0.2em;
}
/* Word-wrap output correctly.  This is the CSS3 spelling, though Firefox seems
   to not honor it correctly.  Webkit browsers (Chrome, rekonq, Safari) do.
 */
pre,
code,
kbd,
samp {
  white-space: pre-wrap;
}
#fonttest {
  font-family: monospace;
}
p {
  margin-bottom: 0;
}
.end_space {
  min-height: 100px;
  transition: height .2s ease;
}
.notebook_app > #header {
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
@media not print {
  .notebook_app {
    background-color: #EEE;
  }
}
kbd {
  border-style: solid;
  border-width: 1px;
  box-shadow: none;
  margin: 2px;
  padding-left: 2px;
  padding-right: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
.jupyter-keybindings {
  padding: 1px;
  line-height: 24px;
  border-bottom: 1px solid gray;
}
.jupyter-keybindings input {
  margin: 0;
  padding: 0;
  border: none;
}
.jupyter-keybindings i {
  padding: 6px;
}
.well code {
  background-color: #ffffff;
  border-color: #ababab;
  border-width: 1px;
  border-style: solid;
  padding: 2px;
  padding-top: 1px;
  padding-bottom: 1px;
}
/* CSS for the cell toolbar */
.celltoolbar {
  border: thin solid #CFCFCF;
  border-bottom: none;
  background: #EEE;
  border-radius: 2px 2px 0px 0px;
  width: 100%;
  height: 29px;
  padding-right: 4px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-pack: end;
  -moz-box-pack: end;
  box-pack: end;
  /* Modern browsers */
  justify-content: flex-end;
  display: -webkit-flex;
}
@media print {
  .celltoolbar {
    display: none;
  }
}
.ctb_hideshow {
  display: none;
  vertical-align: bottom;
}
/* ctb_show is added to the ctb_hideshow div to show the cell toolbar.
   Cell toolbars are only shown when the ctb_global_show class is also set.
*/
.ctb_global_show .ctb_show.ctb_hideshow {
  display: block;
}
.ctb_global_show .ctb_show + .input_area,
.ctb_global_show .ctb_show + div.text_cell_input,
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border-top-right-radius: 0px;
  border-top-left-radius: 0px;
}
.ctb_global_show .ctb_show ~ div.text_cell_render {
  border: 1px solid #cfcfcf;
}
.celltoolbar {
  font-size: 87%;
  padding-top: 3px;
}
.celltoolbar select {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  width: inherit;
  font-size: inherit;
  height: 22px;
  padding: 0px;
  display: inline-block;
}
.celltoolbar select:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.celltoolbar select::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.celltoolbar select:-ms-input-placeholder {
  color: #999;
}
.celltoolbar select::-webkit-input-placeholder {
  color: #999;
}
.celltoolbar select::-ms-expand {
  border: 0;
  background-color: transparent;
}
.celltoolbar select[disabled],
.celltoolbar select[readonly],
fieldset[disabled] .celltoolbar select {
  background-color: #eeeeee;
  opacity: 1;
}
.celltoolbar select[disabled],
fieldset[disabled] .celltoolbar select {
  cursor: not-allowed;
}
textarea.celltoolbar select {
  height: auto;
}
select.celltoolbar select {
  height: 30px;
  line-height: 30px;
}
textarea.celltoolbar select,
select[multiple].celltoolbar select {
  height: auto;
}
.celltoolbar label {
  margin-left: 5px;
  margin-right: 5px;
}
.tags_button_container {
  width: 100%;
  display: flex;
}
.tag-container {
  display: flex;
  flex-direction: row;
  flex-grow: 1;
  overflow: hidden;
  position: relative;
}
.tag-container > * {
  margin: 0 4px;
}
.remove-tag-btn {
  margin-left: 4px;
}
.tags-input {
  display: flex;
}
.cell-tag:last-child:after {
  content: "";
  position: absolute;
  right: 0;
  width: 40px;
  height: 100%;
  /* Fade to background color of cell toolbar */
  background: linear-gradient(to right, rgba(0, 0, 0, 0), #EEE);
}
.tags-input > * {
  margin-left: 4px;
}
.cell-tag,
.tags-input input,
.tags-input button {
  display: block;
  width: 100%;
  height: 32px;
  padding: 6px 12px;
  font-size: 13px;
  line-height: 1.42857143;
  color: #555555;
  background-color: #fff;
  background-image: none;
  border: 1px solid #ccc;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  -webkit-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
  height: 30px;
  padding: 5px 10px;
  font-size: 12px;
  line-height: 1.5;
  border-radius: 1px;
  box-shadow: none;
  width: inherit;
  font-size: inherit;
  height: 22px;
  line-height: 22px;
  padding: 0px 4px;
  display: inline-block;
}
.cell-tag:focus,
.tags-input input:focus,
.tags-input button:focus {
  border-color: #66afe9;
  outline: 0;
  -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px rgba(102, 175, 233, 0.6);
}
.cell-tag::-moz-placeholder,
.tags-input input::-moz-placeholder,
.tags-input button::-moz-placeholder {
  color: #999;
  opacity: 1;
}
.cell-tag:-ms-input-placeholder,
.tags-input input:-ms-input-placeholder,
.tags-input button:-ms-input-placeholder {
  color: #999;
}
.cell-tag::-webkit-input-placeholder,
.tags-input input::-webkit-input-placeholder,
.tags-input button::-webkit-input-placeholder {
  color: #999;
}
.cell-tag::-ms-expand,
.tags-input input::-ms-expand,
.tags-input button::-ms-expand {
  border: 0;
  background-color: transparent;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
.cell-tag[readonly],
.tags-input input[readonly],
.tags-input button[readonly],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  background-color: #eeeeee;
  opacity: 1;
}
.cell-tag[disabled],
.tags-input input[disabled],
.tags-input button[disabled],
fieldset[disabled] .cell-tag,
fieldset[disabled] .tags-input input,
fieldset[disabled] .tags-input button {
  cursor: not-allowed;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button {
  height: auto;
}
select.cell-tag,
select.tags-input input,
select.tags-input button {
  height: 30px;
  line-height: 30px;
}
textarea.cell-tag,
textarea.tags-input input,
textarea.tags-input button,
select[multiple].cell-tag,
select[multiple].tags-input input,
select[multiple].tags-input button {
  height: auto;
}
.cell-tag,
.tags-input button {
  padding: 0px 4px;
}
.cell-tag {
  background-color: #fff;
  white-space: nowrap;
}
.tags-input input[type=text]:focus {
  outline: none;
  box-shadow: none;
  border-color: #ccc;
}
.completions {
  position: absolute;
  z-index: 110;
  overflow: hidden;
  border: 1px solid #ababab;
  border-radius: 2px;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  line-height: 1;
}
.completions select {
  background: white;
  outline: none;
  border: none;
  padding: 0px;
  margin: 0px;
  overflow: auto;
  font-family: monospace;
  font-size: 110%;
  color: #000;
  width: auto;
}
.completions select option.context {
  color: #286090;
}
#kernel_logo_widget .current_kernel_logo {
  display: none;
  margin-top: -1px;
  margin-bottom: -1px;
  width: 32px;
  height: 32px;
}
[dir="rtl"] #kernel_logo_widget {
  float: left !important;
  float: left;
}
.modal .modal-body .move-path {
  display: flex;
  flex-direction: row;
  justify-content: space;
  align-items: center;
}
.modal .modal-body .move-path .server-root {
  padding-right: 20px;
}
.modal .modal-body .move-path .path-input {
  flex: 1;
}
#menubar {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  margin-top: 1px;
}
#menubar .navbar {
  border-top: 1px;
  border-radius: 0px 0px 2px 2px;
  margin-bottom: 0px;
}
#menubar .navbar-toggle {
  float: left;
  padding-top: 7px;
  padding-bottom: 7px;
  border: none;
}
#menubar .navbar-collapse {
  clear: left;
}
[dir="rtl"] #menubar .navbar-toggle {
  float: right;
}
[dir="rtl"] #menubar .navbar-collapse {
  clear: right;
}
[dir="rtl"] #menubar .navbar-nav {
  float: right;
}
[dir="rtl"] #menubar .nav {
  padding-right: 0px;
}
[dir="rtl"] #menubar .navbar-nav > li {
  float: right;
}
[dir="rtl"] #menubar .navbar-right {
  float: left !important;
}
[dir="rtl"] ul.dropdown-menu {
  text-align: right;
  left: auto;
}
[dir="rtl"] ul#new-menu.dropdown-menu {
  right: auto;
  left: 0;
}
.nav-wrapper {
  border-bottom: 1px solid #e7e7e7;
}
i.menu-icon {
  padding-top: 4px;
}
[dir="rtl"] i.menu-icon.pull-right {
  float: left !important;
  float: left;
}
ul#help_menu li a {
  overflow: hidden;
  padding-right: 2.2em;
}
ul#help_menu li a i {
  margin-right: -1.2em;
}
[dir="rtl"] ul#help_menu li a {
  padding-left: 2.2em;
}
[dir="rtl"] ul#help_menu li a i {
  margin-right: 0;
  margin-left: -1.2em;
}
[dir="rtl"] ul#help_menu li a i.pull-right {
  float: left !important;
  float: left;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu > .dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
}
[dir="rtl"] .dropdown-submenu > .dropdown-menu {
  right: 100%;
  margin-right: -1px;
}
.dropdown-submenu:hover > .dropdown-menu {
  display: block;
}
.dropdown-submenu > a:after {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: block;
  content: "\f0da";
  float: right;
  color: #333333;
  margin-top: 2px;
  margin-right: -10px;
}
.dropdown-submenu > a:after.fa-pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.fa-pull-right {
  margin-left: .3em;
}
.dropdown-submenu > a:after.pull-left {
  margin-right: .3em;
}
.dropdown-submenu > a:after.pull-right {
  margin-left: .3em;
}
[dir="rtl"] .dropdown-submenu > a:after {
  float: left;
  content: "\f0d9";
  margin-right: 0;
  margin-left: -10px;
}
.dropdown-submenu:hover > a:after {
  color: #262626;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left > .dropdown-menu {
  left: -100%;
  margin-left: 10px;
}
#notification_area {
  float: right !important;
  float: right;
  z-index: 10;
}
[dir="rtl"] #notification_area {
  float: left !important;
  float: left;
}
.indicator_area {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] .indicator_area {
  float: left !important;
  float: left;
}
#kernel_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  border-left: 1px solid;
}
#kernel_indicator .kernel_indicator_name {
  padding-left: 5px;
  padding-right: 5px;
}
[dir="rtl"] #kernel_indicator {
  float: left !important;
  float: left;
  border-left: 0;
  border-right: 1px solid;
}
#modal_indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
}
[dir="rtl"] #modal_indicator {
  float: left !important;
  float: left;
}
#readonly-indicator {
  float: right !important;
  float: right;
  color: #777;
  margin-left: 5px;
  margin-right: 5px;
  width: 11px;
  z-index: 10;
  text-align: center;
  width: auto;
  margin-top: 2px;
  margin-bottom: 0px;
  margin-left: 0px;
  margin-right: 0px;
  display: none;
}
.modal_indicator:before {
  width: 1.28571429em;
  text-align: center;
}
.edit_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f040";
}
.edit_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.edit_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.edit_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: ' ';
}
.command_mode .modal_indicator:before.fa-pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.fa-pull-right {
  margin-left: .3em;
}
.command_mode .modal_indicator:before.pull-left {
  margin-right: .3em;
}
.command_mode .modal_indicator:before.pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f10c";
}
.kernel_idle_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_idle_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_idle_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f111";
}
.kernel_busy_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_busy_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_busy_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f1e2";
}
.kernel_dead_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_dead_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_dead_icon:before.pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  content: "\f127";
}
.kernel_disconnected_icon:before.fa-pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.fa-pull-right {
  margin-left: .3em;
}
.kernel_disconnected_icon:before.pull-left {
  margin-right: .3em;
}
.kernel_disconnected_icon:before.pull-right {
  margin-left: .3em;
}
.notification_widget {
  color: #777;
  z-index: 10;
  background: rgba(240, 240, 240, 0.5);
  margin-right: 4px;
  color: #333;
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget:focus,
.notification_widget.focus {
  color: #333;
  background-color: #e6e6e6;
  border-color: #8c8c8c;
}
.notification_widget:hover {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  color: #333;
  background-color: #e6e6e6;
  border-color: #adadad;
}
.notification_widget:active:hover,
.notification_widget.active:hover,
.open > .dropdown-toggle.notification_widget:hover,
.notification_widget:active:focus,
.notification_widget.active:focus,
.open > .dropdown-toggle.notification_widget:focus,
.notification_widget:active.focus,
.notification_widget.active.focus,
.open > .dropdown-toggle.notification_widget.focus {
  color: #333;
  background-color: #d4d4d4;
  border-color: #8c8c8c;
}
.notification_widget:active,
.notification_widget.active,
.open > .dropdown-toggle.notification_widget {
  background-image: none;
}
.notification_widget.disabled:hover,
.notification_widget[disabled]:hover,
fieldset[disabled] .notification_widget:hover,
.notification_widget.disabled:focus,
.notification_widget[disabled]:focus,
fieldset[disabled] .notification_widget:focus,
.notification_widget.disabled.focus,
.notification_widget[disabled].focus,
fieldset[disabled] .notification_widget.focus {
  background-color: #fff;
  border-color: #ccc;
}
.notification_widget .badge {
  color: #fff;
  background-color: #333;
}
.notification_widget.warning {
  color: #fff;
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning:focus,
.notification_widget.warning.focus {
  color: #fff;
  background-color: #ec971f;
  border-color: #985f0d;
}
.notification_widget.warning:hover {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  color: #fff;
  background-color: #ec971f;
  border-color: #d58512;
}
.notification_widget.warning:active:hover,
.notification_widget.warning.active:hover,
.open > .dropdown-toggle.notification_widget.warning:hover,
.notification_widget.warning:active:focus,
.notification_widget.warning.active:focus,
.open > .dropdown-toggle.notification_widget.warning:focus,
.notification_widget.warning:active.focus,
.notification_widget.warning.active.focus,
.open > .dropdown-toggle.notification_widget.warning.focus {
  color: #fff;
  background-color: #d58512;
  border-color: #985f0d;
}
.notification_widget.warning:active,
.notification_widget.warning.active,
.open > .dropdown-toggle.notification_widget.warning {
  background-image: none;
}
.notification_widget.warning.disabled:hover,
.notification_widget.warning[disabled]:hover,
fieldset[disabled] .notification_widget.warning:hover,
.notification_widget.warning.disabled:focus,
.notification_widget.warning[disabled]:focus,
fieldset[disabled] .notification_widget.warning:focus,
.notification_widget.warning.disabled.focus,
.notification_widget.warning[disabled].focus,
fieldset[disabled] .notification_widget.warning.focus {
  background-color: #f0ad4e;
  border-color: #eea236;
}
.notification_widget.warning .badge {
  color: #f0ad4e;
  background-color: #fff;
}
.notification_widget.success {
  color: #fff;
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success:focus,
.notification_widget.success.focus {
  color: #fff;
  background-color: #449d44;
  border-color: #255625;
}
.notification_widget.success:hover {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  color: #fff;
  background-color: #449d44;
  border-color: #398439;
}
.notification_widget.success:active:hover,
.notification_widget.success.active:hover,
.open > .dropdown-toggle.notification_widget.success:hover,
.notification_widget.success:active:focus,
.notification_widget.success.active:focus,
.open > .dropdown-toggle.notification_widget.success:focus,
.notification_widget.success:active.focus,
.notification_widget.success.active.focus,
.open > .dropdown-toggle.notification_widget.success.focus {
  color: #fff;
  background-color: #398439;
  border-color: #255625;
}
.notification_widget.success:active,
.notification_widget.success.active,
.open > .dropdown-toggle.notification_widget.success {
  background-image: none;
}
.notification_widget.success.disabled:hover,
.notification_widget.success[disabled]:hover,
fieldset[disabled] .notification_widget.success:hover,
.notification_widget.success.disabled:focus,
.notification_widget.success[disabled]:focus,
fieldset[disabled] .notification_widget.success:focus,
.notification_widget.success.disabled.focus,
.notification_widget.success[disabled].focus,
fieldset[disabled] .notification_widget.success.focus {
  background-color: #5cb85c;
  border-color: #4cae4c;
}
.notification_widget.success .badge {
  color: #5cb85c;
  background-color: #fff;
}
.notification_widget.info {
  color: #fff;
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info:focus,
.notification_widget.info.focus {
  color: #fff;
  background-color: #31b0d5;
  border-color: #1b6d85;
}
.notification_widget.info:hover {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  color: #fff;
  background-color: #31b0d5;
  border-color: #269abc;
}
.notification_widget.info:active:hover,
.notification_widget.info.active:hover,
.open > .dropdown-toggle.notification_widget.info:hover,
.notification_widget.info:active:focus,
.notification_widget.info.active:focus,
.open > .dropdown-toggle.notification_widget.info:focus,
.notification_widget.info:active.focus,
.notification_widget.info.active.focus,
.open > .dropdown-toggle.notification_widget.info.focus {
  color: #fff;
  background-color: #269abc;
  border-color: #1b6d85;
}
.notification_widget.info:active,
.notification_widget.info.active,
.open > .dropdown-toggle.notification_widget.info {
  background-image: none;
}
.notification_widget.info.disabled:hover,
.notification_widget.info[disabled]:hover,
fieldset[disabled] .notification_widget.info:hover,
.notification_widget.info.disabled:focus,
.notification_widget.info[disabled]:focus,
fieldset[disabled] .notification_widget.info:focus,
.notification_widget.info.disabled.focus,
.notification_widget.info[disabled].focus,
fieldset[disabled] .notification_widget.info.focus {
  background-color: #5bc0de;
  border-color: #46b8da;
}
.notification_widget.info .badge {
  color: #5bc0de;
  background-color: #fff;
}
.notification_widget.danger {
  color: #fff;
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger:focus,
.notification_widget.danger.focus {
  color: #fff;
  background-color: #c9302c;
  border-color: #761c19;
}
.notification_widget.danger:hover {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  color: #fff;
  background-color: #c9302c;
  border-color: #ac2925;
}
.notification_widget.danger:active:hover,
.notification_widget.danger.active:hover,
.open > .dropdown-toggle.notification_widget.danger:hover,
.notification_widget.danger:active:focus,
.notification_widget.danger.active:focus,
.open > .dropdown-toggle.notification_widget.danger:focus,
.notification_widget.danger:active.focus,
.notification_widget.danger.active.focus,
.open > .dropdown-toggle.notification_widget.danger.focus {
  color: #fff;
  background-color: #ac2925;
  border-color: #761c19;
}
.notification_widget.danger:active,
.notification_widget.danger.active,
.open > .dropdown-toggle.notification_widget.danger {
  background-image: none;
}
.notification_widget.danger.disabled:hover,
.notification_widget.danger[disabled]:hover,
fieldset[disabled] .notification_widget.danger:hover,
.notification_widget.danger.disabled:focus,
.notification_widget.danger[disabled]:focus,
fieldset[disabled] .notification_widget.danger:focus,
.notification_widget.danger.disabled.focus,
.notification_widget.danger[disabled].focus,
fieldset[disabled] .notification_widget.danger.focus {
  background-color: #d9534f;
  border-color: #d43f3a;
}
.notification_widget.danger .badge {
  color: #d9534f;
  background-color: #fff;
}
div#pager {
  background-color: #fff;
  font-size: 14px;
  line-height: 20px;
  overflow: hidden;
  display: none;
  position: fixed;
  bottom: 0px;
  width: 100%;
  max-height: 50%;
  padding-top: 8px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  /* Display over codemirror */
  z-index: 100;
  /* Hack which prevents jquery ui resizable from changing top. */
  top: auto !important;
}
div#pager pre {
  line-height: 1.21429em;
  color: #000;
  background-color: #f7f7f7;
  padding: 0.4em;
}
div#pager #pager-button-area {
  position: absolute;
  top: 8px;
  right: 20px;
}
div#pager #pager-contents {
  position: relative;
  overflow: auto;
  width: 100%;
  height: 100%;
}
div#pager #pager-contents #pager-container {
  position: relative;
  padding: 15px 0px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
div#pager .ui-resizable-handle {
  top: 0px;
  height: 8px;
  background: #f7f7f7;
  border-top: 1px solid #cfcfcf;
  border-bottom: 1px solid #cfcfcf;
  /* This injects handle bars (a short, wide = symbol) for 
        the resize handle. */
}
div#pager .ui-resizable-handle::after {
  content: '';
  top: 2px;
  left: 50%;
  height: 3px;
  width: 30px;
  margin-left: -15px;
  position: absolute;
  border-top: 1px solid #cfcfcf;
}
.quickhelp {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
  line-height: 1.8em;
}
.shortcut_key {
  display: inline-block;
  width: 21ex;
  text-align: right;
  font-family: monospace;
}
.shortcut_descr {
  display: inline-block;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
span.save_widget {
  height: 30px;
  margin-top: 4px;
  display: flex;
  justify-content: flex-start;
  align-items: baseline;
  width: 50%;
  flex: 1;
}
span.save_widget span.filename {
  height: 100%;
  line-height: 1em;
  margin-left: 16px;
  border: none;
  font-size: 146.5%;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  border-radius: 2px;
}
span.save_widget span.filename:hover {
  background-color: #e6e6e6;
}
[dir="rtl"] span.save_widget.pull-left {
  float: right !important;
  float: right;
}
[dir="rtl"] span.save_widget span.filename {
  margin-left: 0;
  margin-right: 16px;
}
span.checkpoint_status,
span.autosave_status {
  font-size: small;
  white-space: nowrap;
  padding: 0 5px;
}
@media (max-width: 767px) {
  span.save_widget {
    font-size: small;
    padding: 0 0 0 5px;
  }
  span.checkpoint_status,
  span.autosave_status {
    display: none;
  }
}
@media (min-width: 768px) and (max-width: 991px) {
  span.checkpoint_status {
    display: none;
  }
  span.autosave_status {
    font-size: x-small;
  }
}
.toolbar {
  padding: 0px;
  margin-left: -5px;
  margin-top: 2px;
  margin-bottom: 5px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
.toolbar select,
.toolbar label {
  width: auto;
  vertical-align: middle;
  margin-right: 2px;
  margin-bottom: 0px;
  display: inline;
  font-size: 92%;
  margin-left: 0.3em;
  margin-right: 0.3em;
  padding: 0px;
  padding-top: 3px;
}
.toolbar .btn {
  padding: 2px 8px;
}
.toolbar .btn-group {
  margin-top: 0px;
  margin-left: 5px;
}
.toolbar-btn-label {
  margin-left: 6px;
}
#maintoolbar {
  margin-bottom: -3px;
  margin-top: -8px;
  border: 0px;
  min-height: 27px;
  margin-left: 0px;
  padding-top: 11px;
  padding-bottom: 3px;
}
#maintoolbar .navbar-text {
  float: none;
  vertical-align: middle;
  text-align: right;
  margin-left: 5px;
  margin-right: 0px;
  margin-top: 0px;
}
.select-xs {
  height: 24px;
}
[dir="rtl"] .btn-group > .btn,
.btn-group-vertical > .btn {
  float: right;
}
.pulse,
.dropdown-menu > li > a.pulse,
li.pulse > a.dropdown-toggle,
li.pulse.open > a.dropdown-toggle {
  background-color: #F37626;
  color: white;
}
/**
 * Primary styles
 *
 * Author: Jupyter Development Team
 */
/** WARNING IF YOU ARE EDITTING THIS FILE, if this is a .css file, It has a lot
 * of chance of beeing generated from the ../less/[samename].less file, you can
 * try to get back the less file by reverting somme commit in history
 **/
/*
 * We'll try to get something pretty, so we
 * have some strange css to have the scroll bar on
 * the left with fix button on the top right of the tooltip
 */
@-moz-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-webkit-keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}
@-moz-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
@-webkit-keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}
/*properties of tooltip after "expand"*/
.bigtooltip {
  overflow: auto;
  height: 200px;
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
}
/*properties of tooltip before "expand"*/
.smalltooltip {
  -webkit-transition-property: height;
  -webkit-transition-duration: 500ms;
  -moz-transition-property: height;
  -moz-transition-duration: 500ms;
  transition-property: height;
  transition-duration: 500ms;
  text-overflow: ellipsis;
  overflow: hidden;
  height: 80px;
}
.tooltipbuttons {
  position: absolute;
  padding-right: 15px;
  top: 0px;
  right: 0px;
}
.tooltiptext {
  /*avoid the button to overlap on some docstring*/
  padding-right: 30px;
}
.ipython_tooltip {
  max-width: 700px;
  /*fade-in animation when inserted*/
  -webkit-animation: fadeOut 400ms;
  -moz-animation: fadeOut 400ms;
  animation: fadeOut 400ms;
  -webkit-animation: fadeIn 400ms;
  -moz-animation: fadeIn 400ms;
  animation: fadeIn 400ms;
  vertical-align: middle;
  background-color: #f7f7f7;
  overflow: visible;
  border: #ababab 1px solid;
  outline: none;
  padding: 3px;
  margin: 0px;
  padding-left: 7px;
  font-family: monospace;
  min-height: 50px;
  -moz-box-shadow: 0px 6px 10px -1px #adadad;
  -webkit-box-shadow: 0px 6px 10px -1px #adadad;
  box-shadow: 0px 6px 10px -1px #adadad;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
}
.ipython_tooltip a {
  float: right;
}
.ipython_tooltip .tooltiptext pre {
  border: 0;
  border-radius: 0;
  font-size: 100%;
  background-color: #f7f7f7;
}
.pretooltiparrow {
  left: 0px;
  margin: 0px;
  top: -16px;
  width: 40px;
  height: 16px;
  overflow: hidden;
  position: absolute;
}
.pretooltiparrow:before {
  background-color: #f7f7f7;
  border: 1px #ababab solid;
  z-index: 11;
  content: "";
  position: absolute;
  left: 15px;
  top: 10px;
  width: 25px;
  height: 25px;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
}
ul.typeahead-list i {
  margin-left: -10px;
  width: 18px;
}
[dir="rtl"] ul.typeahead-list i {
  margin-left: 0;
  margin-right: -10px;
}
ul.typeahead-list {
  max-height: 80vh;
  overflow: auto;
}
ul.typeahead-list > li > a {
  /** Firefox bug **/
  /* see https://github.com/jupyter/notebook/issues/559 */
  white-space: normal;
}
ul.typeahead-list  > li > a.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .typeahead-list {
  text-align: right;
}
.cmd-palette .modal-body {
  padding: 7px;
}
.cmd-palette form {
  background: white;
}
.cmd-palette input {
  outline: none;
}
.no-shortcut {
  min-width: 20px;
  color: transparent;
}
[dir="rtl"] .no-shortcut.pull-right {
  float: left !important;
  float: left;
}
[dir="rtl"] .command-shortcut.pull-right {
  float: left !important;
  float: left;
}
.command-shortcut:before {
  content: "(command mode)";
  padding-right: 3px;
  color: #777777;
}
.edit-shortcut:before {
  content: "(edit)";
  padding-right: 3px;
  color: #777777;
}
[dir="rtl"] .edit-shortcut.pull-right {
  float: left !important;
  float: left;
}
#find-and-replace #replace-preview .match,
#find-and-replace #replace-preview .insert {
  background-color: #BBDEFB;
  border-color: #90CAF9;
  border-style: solid;
  border-width: 1px;
  border-radius: 0px;
}
[dir="ltr"] #find-and-replace .input-group-btn + .form-control {
  border-left: none;
}
[dir="rtl"] #find-and-replace .input-group-btn + .form-control {
  border-right: none;
}
#find-and-replace #replace-preview .replace .match {
  background-color: #FFCDD2;
  border-color: #EF9A9A;
  border-radius: 0px;
}
#find-and-replace #replace-preview .replace .insert {
  background-color: #C8E6C9;
  border-color: #A5D6A7;
  border-radius: 0px;
}
#find-and-replace #replace-preview {
  max-height: 60vh;
  overflow: auto;
}
#find-and-replace #replace-preview pre {
  padding: 5px 10px;
}
.terminal-app {
  background: #EEE;
}
.terminal-app #header {
  background: #fff;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.2);
}
.terminal-app .terminal {
  width: 100%;
  float: left;
  font-family: monospace;
  color: white;
  background: black;
  padding: 0.4em;
  border-radius: 2px;
  -webkit-box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
  box-shadow: 0px 0px 12px 1px rgba(87, 87, 87, 0.4);
}
.terminal-app .terminal,
.terminal-app .terminal dummy-screen {
  line-height: 1em;
  font-size: 14px;
}
.terminal-app .terminal .xterm-rows {
  padding: 10px;
}
.terminal-app .terminal-cursor {
  color: black;
  background: white;
}
.terminal-app #terminado-container {
  margin-top: 20px;
}
/*# sourceMappingURL=style.min.css.map */
    </style>
<style type="text/css">
    .highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>


<style type="text/css">
/* Overrides of notebook CSS for static HTML export */
body {
  overflow: visible;
  padding: 8px;
}

div#notebook {
  overflow: visible;
  border-top: none;
}@media print {
  div.cell {
    display: block;
    page-break-inside: avoid;
  } 
  div.output_wrapper { 
    display: block;
    page-break-inside: avoid; 
  }
  div.output { 
    display: block;
    page-break-inside: avoid; 
  }
}
</style>

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="custom.css">

<!-- Loading mathjax macro -->
<!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
<body>
  <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>08/25/2020</p>
<p>check vocab words</p>
<ol>
<li>make sure they are in the rna expression</li>
</ol>
<p>08/30 finish gathering genomic instances</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># basic packages</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="p">;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="c1"># Import tools needed for visualization</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pybedtools</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">save_dir</span> <span class="o">=</span> <span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum_final/&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1-Get-the-vocab-words">1 Get the vocab words<a class="anchor-link" href="#1-Get-the-vocab-words">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[904]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Colon&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum/Colon_filtered_vocab_list.xlsx&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="s1">&#39;Melanocytes&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum/Melanocytes_filtered_vocab_list.xlsx&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="s1">&#39;GDSD6&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum/GDSD6_filtered_vocab_list.xlsx&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
 <span class="s1">&#39;GM12878&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum/GM12878_filtered_vocab_list.xlsx&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
<span class="s1">&#39;SCC&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum/SCC_filtered_vocab.xlsx&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
 <span class="s1">&#39;MM&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum/MM_filtered_vocab_list.xlsx&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="p">}</span>

<span class="n">vocab_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">,</span><span class="s1">&#39;vocab&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">vocab_arr</span> <span class="ow">in</span> <span class="n">vocab_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">vocab</span> <span class="ow">in</span> <span class="n">vocab_arr</span><span class="p">:</span>
        <span class="n">vocab_df</span> <span class="o">=</span> <span class="n">vocab_df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;tissue&#39;</span><span class="p">:</span><span class="n">tissue</span><span class="p">,</span> <span class="s1">&#39;vocab&#39;</span><span class="p">:</span><span class="n">vocab</span><span class="p">},</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_df</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;enrich&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[905]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">irf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/processed/fig4_modelling/irf_manual_lookup.xlsx&#39;</span><span class="p">)</span>
<span class="n">irf_df</span> <span class="o">=</span> <span class="n">irf_df</span><span class="p">[</span><span class="n">irf_df</span><span class="p">[</span><span class="s1">&#39;Y/n?&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
<span class="n">irf_df</span> <span class="o">=</span> <span class="n">irf_df</span><span class="p">[[</span><span class="s1">&#39;Vocab&#39;</span><span class="p">,</span><span class="s1">&#39;Tissue&#39;</span><span class="p">]]</span>
<span class="n">irf_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">,</span> <span class="s1">&#39;tissue&#39;</span><span class="p">]</span>
<span class="n">irf_df</span><span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irf_df</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[:_]&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">irf_df</span><span class="p">[</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;irf&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[906]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vocab_df</span><span class="p">,</span> <span class="n">irf_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">overall_df</span><span class="p">[[</span><span class="s1">&#39;vocab1&#39;</span><span class="p">,</span><span class="s1">&#39;vocab2&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">overall_df</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">overall_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">overall_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[907]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[907]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tissue</th>
      <th>vocab</th>
      <th>source</th>
      <th>vocab1</th>
      <th>vocab2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Colon</td>
      <td>BARX2::DLX4</td>
      <td>enrich</td>
      <td>BARX2</td>
      <td>DLX4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Colon</td>
      <td>BARX2::FOXF2</td>
      <td>enrich</td>
      <td>BARX2</td>
      <td>FOXF2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Colon</td>
      <td>BARX2::FOXM1</td>
      <td>enrich</td>
      <td>BARX2</td>
      <td>FOXM1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Colon</td>
      <td>BARX2::THAP1</td>
      <td>enrich</td>
      <td>BARX2</td>
      <td>THAP1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Colon</td>
      <td>BATF::KLF15</td>
      <td>enrich</td>
      <td>BATF</td>
      <td>KLF15</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[908]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;overall_df.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1B.-some-basic-stats">1B. some basic stats<a class="anchor-link" href="#1B.-some-basic-stats">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[909]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="o">.</span><span class="n">tissue</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[909]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Melanocytes    132
GDSD6           94
Colon           85
GM12878         64
MM              53
SCC             45
Name: tissue, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[910]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[910]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(473, 5)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[911]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[911]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>472</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>currently 472 unique vocab pairs for each tissue</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[913]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">motifs</span> <span class="o">=</span><span class="nb">set</span><span class="p">(</span> <span class="nb">list</span><span class="p">(</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab1</span><span class="p">)</span><span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab2</span><span class="p">))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">motifs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[913]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>248</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>using 248 vocabulary words</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[914]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">motif_to_tissue</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">motif</span> <span class="ow">in</span> <span class="n">motifs</span><span class="p">:</span>
    <span class="n">motif_to_tissue</span><span class="p">[</span><span class="n">motif</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Colon&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;GM12878&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Melanocytes&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;SCC&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;MM&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">overall_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">motif_to_tissue</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1&#39;</span><span class="p">]][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">]]</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">motif_to_tissue</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2&#39;</span><span class="p">]][</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">]]</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[915]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">motif_to_tissue_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">motif_to_tissue</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[916]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">motif_to_tissue_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_to_tissue.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1C.-check-to-see-if-the-vocab-words-are-in-the-irf-model-somewhere">1C. check to see if the vocab words are in the irf model somewhere<a class="anchor-link" href="#1C.-check-to-see-if-the-vocab-words-are-in-the-irf-model-somewhere">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[917]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tissue_to_irf_file</span>  <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Colon&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/processed/fig4_modelling/tf_tf_pairs_stability_sherlock/expr_Colon_Colon_boosted_stability_score.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GDSD6&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/processed/fig4_modelling/tf_tf_pairs_stability_sherlock/expr_GDSD6_GDSD6_boosted_stability_score.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GM12878&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/processed/fig4_modelling/tf_tf_pairs_stability_sherlock/expr_GM12878_GM12878_boosted_stability_score.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Melanocytes&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/processed/fig4_modelling/tf_tf_pairs_stability_sherlock/expr_Melanocytes_Melanocytes_boosted_stability_score.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MM&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/processed/fig4_modelling/irf_manual_mm/expr_cancer_boosted_stability_score.csv&#39;</span><span class="p">,</span><span class="c1">#&#39;../data/processed/fig4_modelling/irf_manual_mm/diff_cancer_boosted_stability_score.csv&#39;</span>
    <span class="s1">&#39;SCC&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/processed/fig4_modelling/irf_manual_scc/expr_cancer_boosted_stability_score.csv&#39;</span><span class="p">,</span><span class="c1">#&#39;../data/processed/fig4_modelling/irf_manual_scc/diff_cancer_boosted_stability_score.csv&#39;</span>
    
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[918]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># takes about 5 min, slow </span>
<span class="n">overall_df</span><span class="p">[</span><span class="s1">&#39;irf_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">overall_df</span><span class="p">[</span><span class="s1">&#39;irf_score_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">overall_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">vocab1</span><span class="p">,</span> <span class="n">vocab2</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2&#39;</span><span class="p">]</span>
    <span class="n">tissue</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">]</span>
    <span class="n">irf_file</span> <span class="o">=</span> <span class="n">tissue_to_irf_file</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span>
    
    <span class="n">irf_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">irf_file</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">found_vocab_pair</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">jdx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">found_vocab_pair</span> <span class="p">)</span><span class="ow">and</span> <span class="p">(</span><span class="n">jdx</span> <span class="o">&lt;</span> <span class="n">irf_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">:</span>
        <span class="n">row_irf</span> <span class="o">=</span> <span class="n">irf_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">irf_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">jdx</span><span class="p">],:]</span>
        <span class="n">irf_vocab</span> <span class="o">=</span> <span class="n">row_irf</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">row_irf</span><span class="p">[</span><span class="s1">&#39;score&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vocab1</span> <span class="ow">in</span> <span class="n">irf_vocab</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">vocab2</span> <span class="ow">in</span> <span class="n">irf_vocab</span><span class="p">):</span>
            <span class="n">found_vocab_pair</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">overall_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;irf_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irf_vocab</span>
            <span class="n">overall_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span><span class="s1">&#39;irf_score_found&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">score</span>
        <span class="n">jdx</span><span class="o">+=</span><span class="mi">1</span>
    

        
        
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
CPU times: user 2min 28s, sys: 1.07 s, total: 2min 29s
Wall time: 2min 29s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[919]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="p">[</span><span class="n">overall_df</span><span class="o">.</span><span class="n">irf_score_found</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[919]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(63, 7)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[920]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">irf_vocab</span> <span class="o">=</span> <span class="n">overall_df</span><span class="p">[</span><span class="n">overall_df</span><span class="o">.</span><span class="n">irf_score_found</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>63 of the 455 are from irf</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[929]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;overall_df.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-check-RNA-expression">2. check RNA expression<a class="anchor-link" href="#2.-check-RNA-expression">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[922]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rna_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/interim/rna/tissue_tpm_sym.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rna_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Index([&#39;A431-CTRLi&#39;, &#39;A431-p63i&#39;, &#39;Airway&#39;, &#39;Astrocytes&#39;, &#39;Bladder&#39;,
       &#39;CAL27-CTRLi&#39;, &#39;CAL27-p63i&#39;, &#39;COLO_SCR_DMSO&#39;, &#39;COLO_SCR_PLX&#39;,
       &#39;COLO_shMITF_DMSO&#39;, &#39;COLO_shMITF_PLX&#39;, &#39;Colon&#39;, &#39;D0-CTRLi&#39;, &#39;D0-p63i&#39;,
       &#39;D3-CTRLi&#39;, &#39;D3-p63i&#39;, &#39;Esophageal&#39;, &#39;GDSD0&#39;, &#39;GDSD3&#39;, &#39;GDSD6&#39;,
       &#39;GM12878&#39;, &#39;HMEC&#39;, &#39;Melanocytes&#39;, &#39;Ovarian&#39;, &#39;Pancreas&#39;, &#39;Prostate&#39;,
       &#39;Renal&#39;, &#39;SCC13-CTRLi&#39;, &#39;SCC13-p63i&#39;, &#39;SKMEL5_SCR_DMSO&#39;,
       &#39;SKMEL5_SCR_PLX&#39;, &#39;SKMEL5_shMITF-DMSO&#39;, &#39;SKMEL5_shMITF_PLX&#39;, &#39;Thyroid&#39;,
       &#39;Uterine&#39;, &#39;WM_SCR_DMSO&#39;, &#39;WM_SCR_PLX&#39;, &#39;WM_shMITF_DMSO&#39;,
       &#39;WM_shMITF_PLX&#39;],
      dtype=&#39;object&#39;)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[923]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">motifs_with_rna_sym</span> <span class="o">=</span> <span class="n">motif_to_tissue_df</span><span class="o">.</span><span class="n">index</span><span class="p">[[</span><span class="kc">True</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rna_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">motif_to_tissue_df</span><span class="o">.</span><span class="n">index</span><span class="p">]]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">motifs_with_rna_sym</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[923]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>248</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[924]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">motif_to_tissue_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">True</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rna_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">motif_to_tissue_df</span><span class="o">.</span><span class="n">index</span><span class="p">])]</span>
<span class="c1"># all motifs are rna symbols</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[924]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[925]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rna_df_tf</span> <span class="o">=</span> <span class="n">rna_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">motif_to_tissue_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">),[</span><span class="s1">&#39;Colon&#39;</span><span class="p">,</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">,</span><span class="s1">&#39;GM12878&#39;</span><span class="p">,</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">,</span><span class="s1">&#39;A431-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;CAL27-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;SCC13-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;COLO_SCR_DMSO&#39;</span><span class="p">,</span><span class="s1">&#39;WM_SCR_DMSO&#39;</span><span class="p">]]</span>
<span class="n">rna_df_tf</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;rna_df_tf.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2B.-manual-check-for-RNA-TF-to-have-TPM-&gt;1">2B. manual check for RNA TF to have TPM &gt;1<a class="anchor-link" href="#2B.-manual-check-for-RNA-TF-to-have-TPM-&gt;1">&#182;</a></h1><p>files to compare: <code>'../data/processed/fig4_modelling/vocab_sum_final/motif_to_tissue_log.pdf'</code>
'../data/processed/fig4_modelling/vocab_sum_final/rna_df_tf_bin.pdf'</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[926]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">THRES</span><span class="o">=</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[927]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">check_rna</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rna_df_tf</span><span class="p">[</span><span class="n">motif_to_tissue_df</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">&gt;</span><span class="n">THRES</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">check_rna</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span> <span class="s1">&#39;pass_exp_filt&#39;</span><span class="p">]</span>
<span class="n">check_rna</span><span class="p">[</span><span class="n">check_rna</span><span class="o">.</span><span class="n">pass_exp_filt</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[927]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tissue</th>
      <th>motif</th>
      <th>pass_exp_filt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>133</td>
      <td>Colon</td>
      <td>NR1D1</td>
      <td>False</td>
    </tr>
    <tr>
      <td>191</td>
      <td>Colon</td>
      <td>STAT5A</td>
      <td>False</td>
    </tr>
    <tr>
      <td>439</td>
      <td>GDSD6</td>
      <td>STAT5A</td>
      <td>False</td>
    </tr>
    <tr>
      <td>554</td>
      <td>GM12878</td>
      <td>GATA2</td>
      <td>False</td>
    </tr>
    <tr>
      <td>613</td>
      <td>GM12878</td>
      <td>MITF</td>
      <td>False</td>
    </tr>
    <tr>
      <td>834</td>
      <td>Melanocytes</td>
      <td>JDP2</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>manually pick motifs to remove</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[930]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df</span><span class="p">[(</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab1</span><span class="o">==</span><span class="s1">&#39;NR1D1&#39;</span><span class="p">)</span> <span class="o">|</span><span class="p">(</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab2</span><span class="o">==</span><span class="s1">&#39;NR1D1&#39;</span><span class="p">)</span> <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[930]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>tissue</th>
      <th>vocab</th>
      <th>source</th>
      <th>vocab1</th>
      <th>vocab2</th>
      <th>irf_found</th>
      <th>irf_score_found</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>423</td>
      <td>Colon</td>
      <td>NFYC::NR1D1</td>
      <td>irf</td>
      <td>NFYC</td>
      <td>NR1D1</td>
      <td>NFYC_loop::NR1D1_loop</td>
      <td>0.892857</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[931]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bad_tfs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NR1D1&#39;</span><span class="p">,</span><span class="s1">&#39;STAT5A&#39;</span><span class="p">,</span><span class="s1">&#39;GATA2&#39;</span><span class="p">,</span> <span class="s1">&#39;JDP2&#39;</span><span class="p">]</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[932]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># testing</span>
<span class="c1"># rna_df.loc[&#39;STAT5A&#39;,:] # not expressed in KRT (0.045)</span>
<span class="c1"># rna_df.loc[&#39;GATA2&#39;,:] # not expressed in GM12878 (0.35)</span>
<span class="c1"># rna_df.loc[&#39;FOSL1&#39;,:] # not expressed in GM12878 (0.635)</span>
<span class="c1"># rna_df.loc[&#39;JDP2&#39;,:] # not expressed in Melanocytes (0.434)</span>
<span class="c1"># rna_df.loc[&#39;NR1D1&#39;,:] # not expressed in Colon (0.160)</span>
<span class="c1"># rna_df.loc[&#39;MITF&#39;,:] # not expressed in GM but going to keep b/c needed in KRT</span>
<span class="c1"># rna_df.loc[&#39;SMAD4&#39;,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[933]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df_filt</span> <span class="o">=</span> <span class="n">overall_df</span><span class="p">[(</span><span class="o">~</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab1</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bad_tfs</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">overall_df</span><span class="o">.</span><span class="n">vocab2</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bad_tfs</span><span class="p">))]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[934]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">overall_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">overall_df_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(473, 7)
(467, 7)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[935]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df_filt</span><span class="o">.</span><span class="n">tissue</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[935]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Melanocytes    131
GDSD6           93
Colon           82
GM12878         63
MM              53
SCC             45
Name: tissue, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[936]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">overall_df_filt</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;overall_df_filt.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2C-plots-in-8E1R">2C plots in 8E1R<a class="anchor-link" href="#2C-plots-in-8E1R">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3.-pull-the-genomic-instances-and-pick-10-each">3. pull the genomic instances and pick 10 each<a class="anchor-link" href="#3.-pull-the-genomic-instances-and-pick-10-each">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3A-get-genes">3A get genes<a class="anchor-link" href="#3A-get-genes">&#182;</a></h2><p>(melanoma is differential genes
scc is higher threshold</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[937]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># melanoma genes</span>
<span class="n">cancer_tissues</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;COLO_SCR_DMSO&#39;</span><span class="p">,</span> <span class="s1">&#39;WM_SCR_DMSO&#39;</span><span class="p">]</span>  <span class="c1"># SKMEL5_SCR_DMSO doesn&#39;t have HiChIP data</span>
<span class="n">normal_tissues</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">]</span><span class="c1">#&#39;D0-CTRLi&#39;, &#39;D3-CTRLi&#39;]</span>
<span class="n">sel_tissues</span> <span class="o">=</span> <span class="n">cancer_tissues</span><span class="o">+</span><span class="n">normal_tissues</span>
<span class="n">tissues_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sel_tissues</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sel_tissues</span><span class="p">))))</span>
<span class="n">rna_df_sel</span> <span class="o">=</span> <span class="n">rna_df</span><span class="p">[</span><span class="n">sel_tissues</span><span class="p">]</span>


<span class="n">rna_df_sel_high</span> <span class="o">=</span> <span class="n">rna_df_sel</span><span class="p">[</span><span class="n">rna_df_sel</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">]</span>
<span class="n">rna_df_sel_high_pseudo</span> <span class="o">=</span> <span class="n">rna_df_sel_high</span><span class="o">+</span><span class="mi">1</span>

<span class="n">rna_df_sel_high_pseudo</span><span class="p">[</span><span class="s1">&#39;avg_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">rna_df_sel_high_pseudo</span><span class="o">.</span><span class="n">COLO_SCR_DMSO</span><span class="o">+</span><span class="n">rna_df_sel_high_pseudo</span><span class="o">.</span><span class="n">WM_SCR_DMSO</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">rna_df_sel_high_pseudo</span><span class="o">.</span><span class="n">Melanocytes</span><span class="p">)</span>
<span class="n">rna_df_sel_high_pseudo</span><span class="p">[</span><span class="s1">&#39;min_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rna_df_sel_high_pseudo</span><span class="p">[[</span><span class="s1">&#39;COLO_SCR_DMSO&#39;</span><span class="p">,</span><span class="s1">&#39;WM_SCR_DMSO&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rna_df_sel_high_pseudo</span><span class="o">.</span><span class="n">Melanocytes</span><span class="p">)</span>

<span class="n">rna_df_sel_high_pseudo</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;min_ratio&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">MM_genes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rna_df_sel_high_pseudo</span><span class="p">[</span><span class="n">rna_df_sel_high_pseudo</span><span class="o">.</span><span class="n">min_ratio</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[938]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">colon_geneset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;Colon&#39;</span><span class="p">][</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;Colon&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">GDSD6_geneset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">][</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">GM12878_geneset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;GM12878&#39;</span><span class="p">][</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;GM12878&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">MC_geneset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">][</span><span class="n">rna_df</span><span class="p">[</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[939]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## SCC genes</span>
<span class="n">THRES</span><span class="o">=</span><span class="mi">10</span>
<span class="n">SCC_genes</span> <span class="o">=</span> <span class="n">rna_df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">rna_df</span><span class="p">[[</span><span class="s1">&#39;A431-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;CAL27-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;SCC13-CTRLi&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">THRES</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[940]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">geneset_dict</span>  <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Colon&#39;</span><span class="p">:</span><span class="n">colon_geneset</span><span class="p">,</span>
    <span class="s1">&#39;GDSD6&#39;</span><span class="p">:</span><span class="n">GDSD6_geneset</span><span class="p">,</span>
    <span class="s1">&#39;GM12878&#39;</span><span class="p">:</span><span class="n">GM12878_geneset</span><span class="p">,</span>
    <span class="s1">&#39;Melanocytes&#39;</span><span class="p">:</span><span class="n">MC_geneset</span><span class="p">,</span>
    <span class="s1">&#39;SCC&#39;</span><span class="p">:</span><span class="n">SCC_genes</span><span class="p">,</span>
    <span class="s1">&#39;MM&#39;</span><span class="p">:</span><span class="n">MM_genes</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">tissue</span><span class="p">,</span><span class="n">geneset</span> <span class="ow">in</span> <span class="n">geneset_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tissue</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">geneset</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Colon 6826
GDSD6 6442
GM12878 6166
Melanocytes 8688
SCC 3916
MM 1143
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3B-set-up-global-variables-and-dataframes">3B set up global variables and dataframes<a class="anchor-link" href="#3B-set-up-global-variables-and-dataframes">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[941]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tissue_to_celltype_mapper</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Colon&#39;</span><span class="p">:[</span><span class="s1">&#39;Colon&#39;</span><span class="p">],</span>
    <span class="s1">&#39;GDSD6&#39;</span><span class="p">:[</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">],</span>
    <span class="s1">&#39;GM12878&#39;</span><span class="p">:[</span><span class="s1">&#39;GM12878&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Melanocytes&#39;</span><span class="p">:[</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">],</span>
    <span class="s1">&#39;SCC&#39;</span><span class="p">:[</span><span class="s1">&#39;A431-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;CAL27-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;SCC13-CTRLi&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MM&#39;</span><span class="p">:[</span><span class="s1">&#39;COLO-SCR-DMSO&#39;</span><span class="p">,</span><span class="s1">&#39;WM-SCR-DMSO&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[942]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># import</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/mguo123/Google Drive/1_khavari/omics_project-LD/pan_omics/data/processed/tissue_crms/all_count_comb_overall.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="o">.</span><span class="n">tissue</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Colon&#39;</span><span class="p">,</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">,</span><span class="s1">&#39;GM12878&#39;</span><span class="p">,</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">,</span><span class="s1">&#39;A431-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;CAL27-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;SCC13-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;COLO_SCR_DMSO&#39;</span><span class="p">,</span><span class="s1">&#39;WM_SCR_DMSO&#39;</span><span class="p">])]</span>
<span class="n">data_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1e-1</span><span class="p">]</span>

<span class="c1"># expression labels</span>
<span class="n">exp_label</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data_all</span><span class="o">.</span><span class="n">exp</span><span class="o">.</span><span class="n">values</span><span class="o">+</span><span class="mf">1e-2</span><span class="p">))</span>
<span class="n">labels_all</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">exp_label</span><span class="p">)</span><span class="o">&gt;</span><span class="n">THRES</span><span class="p">)</span>


<span class="n">tissues_label</span>  <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">tissue</span><span class="o">.</span><span class="n">values</span><span class="c1">#np.array((data_all.exp&gt;THRES).values)</span>
<span class="n">tissue_num_labels</span> <span class="o">=</span>  <span class="n">data_all</span><span class="o">.</span><span class="n">tissue</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tissues_dict</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">is_cancer_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;cancer&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cancer_tissues</span>  <span class="k">else</span> <span class="s1">&#39;normal&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tissues_label</span> <span class="p">])</span>
<span class="n">tissues_label</span><span class="p">[</span><span class="n">tissues_label</span><span class="o">==</span><span class="s1">&#39;COLO_SCR_DMSO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;COLO-SCR-DMSO&#39;</span>
<span class="n">tissues_label</span><span class="p">[</span><span class="n">tissues_label</span><span class="o">==</span><span class="s1">&#39;WM_SCR_DMSO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;WM-SCR-DMSO&#39;</span>

<span class="n">genes_all</span> <span class="o">=</span> <span class="n">data_all</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
<span class="n">gene_to_num_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">genes_all</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">genes_all</span><span class="p">)))))</span>
<span class="n">genes_num_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">gene_to_num_dict</span><span class="o">.</span><span class="n">get</span><span class="p">)(</span><span class="n">genes_all</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 27s, sys: 24.2 s, total: 1min 52s
Wall time: 1min 35s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[943]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">tissue_to_foot_df</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">foot_tissues</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Colon&#39;</span><span class="p">,</span><span class="s1">&#39;GDSD6&#39;</span><span class="p">,</span><span class="s1">&#39;GM12878&#39;</span><span class="p">,</span><span class="s1">&#39;Melanocytes&#39;</span><span class="p">,</span><span class="s1">&#39;A431-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;CAL27-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;SCC13-CTRLi&#39;</span><span class="p">,</span><span class="s1">&#39;COLO-SCR-DMSO&#39;</span><span class="p">,</span><span class="s1">&#39;WM-SCR-DMSO&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">tissue</span> <span class="ow">in</span> <span class="n">foot_tissues</span><span class="p">:</span>
    <span class="n">foot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;../data/interim/annon/promoter_motif_scan/&#39;</span><span class="p">,</span><span class="s1">&#39;promoter_&#39;</span><span class="o">+</span><span class="n">tissue</span><span class="o">+</span><span class="s1">&#39;_annon.bed&#39;</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">foot_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">,</span><span class="s1">&#39;TSS&#39;</span><span class="p">,</span><span class="s1">&#39;chr_m&#39;</span><span class="p">,</span><span class="s1">&#39;start_m&#39;</span><span class="p">,</span><span class="s1">&#39;stop_m&#39;</span><span class="p">,</span><span class="s1">&#39;id_trim&#39;</span><span class="p">,</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="s1">&#39;strand&#39;</span><span class="p">]</span>
    <span class="n">tissue_to_foot_df</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">foot_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 35.5 s, sys: 2.58 s, total: 38.1 s
Wall time: 25.3 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf_annon_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/external/HOCOMOCOv11_annotation.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tf_annon_df</span><span class="p">[</span><span class="s1">&#39;id_trim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_annon_df</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;.pwm.trim&#39;</span>
<span class="n">tf_name_to_id_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">id_trim</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">tf_id_to_name_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">id_trim</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">tf_name_to_id_abbr_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">tf_id_abbr_to_name_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">tf_annon_df</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[945]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">MAX_DIST</span><span class="o">=</span><span class="mi">135</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3C-helper-functions">3C helper functions<a class="anchor-link" href="#3C-helper-functions">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[946]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_tf_tf_loop_occur</span><span class="p">(</span><span class="n">tf_tf_pair</span><span class="p">,</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">geneset</span><span class="p">,</span> <span class="n">data_all</span><span class="o">=</span><span class="n">data_all</span><span class="p">,</span><span class="n">tissues_label</span><span class="o">=</span><span class="n">tissues_label</span><span class="p">):</span>  <span class="c1">#suffixes=&#39;loop&#39;, &#39;pro_loop&#39;</span>
    <span class="n">tf_1</span><span class="p">,</span> <span class="n">tf_2</span> <span class="o">=</span> <span class="n">tf_tf_pair</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
    
    <span class="c1"># get features to look at together, list of lists</span>
    <span class="n">feat_list_type</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;pro_pro&#39;</span><span class="p">:[</span><span class="n">tf_1</span> <span class="o">+</span> <span class="s1">&#39;_pro&#39;</span><span class="p">,</span> <span class="n">tf_2</span><span class="o">+</span><span class="s1">&#39;_pro&#39;</span><span class="p">],</span>
        <span class="s1">&#39;loop_loop&#39;</span><span class="p">:[</span><span class="n">tf_1</span> <span class="o">+</span> <span class="s1">&#39;_loop&#39;</span><span class="p">,</span> <span class="n">tf_2</span><span class="o">+</span><span class="s1">&#39;_loop&#39;</span><span class="p">],</span>
        <span class="s1">&#39;pro_loop&#39;</span><span class="p">:[</span><span class="n">tf_1</span> <span class="o">+</span> <span class="s1">&#39;_pro&#39;</span><span class="p">,</span> <span class="n">tf_2</span><span class="o">+</span><span class="s1">&#39;_loop&#39;</span><span class="p">],</span>
        <span class="s1">&#39;loop_pro&#39;</span><span class="p">:[</span><span class="n">tf_1</span> <span class="o">+</span> <span class="s1">&#39;_loop&#39;</span><span class="p">,</span> <span class="n">tf_2</span><span class="o">+</span><span class="s1">&#39;_pro&#39;</span><span class="p">]}</span>
  
    <span class="n">data_all_sel</span> <span class="o">=</span> <span class="n">data_all</span><span class="p">[</span><span class="n">data_all</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">geneset</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tissues_label</span><span class="o">==</span><span class="n">tissue</span><span class="p">)]</span>
    <span class="n">feat_type_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">type_feat</span><span class="p">,</span> <span class="n">feat_list</span> <span class="ow">in</span> <span class="n">feat_list_type</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">check_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_all_sel</span><span class="p">[</span><span class="n">feat_list</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">feat_type_dict</span><span class="p">[</span><span class="n">type_feat</span><span class="o">+</span><span class="s2">&quot;_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_series</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="kc">True</span><span class="p">]</span>  
            <span class="n">feat_type_dict</span><span class="p">[</span><span class="n">type_feat</span><span class="o">+</span><span class="s2">&quot;_genes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">check_series</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">check_series</span><span class="p">])</span>
            
        <span class="k">except</span><span class="p">:</span>
            <span class="n">feat_type_dict</span><span class="p">[</span><span class="n">type_feat</span><span class="o">+</span><span class="s2">&quot;_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">feat_type_dict</span><span class="p">[</span><span class="n">type_feat</span><span class="o">+</span><span class="s2">&quot;_genes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            
    <span class="k">return</span> <span class="n">feat_type_dict</span>

<span class="k">def</span> <span class="nf">get_other_vocab_word</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">next_row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">]</span><span class="o">!=</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="kc">False</span>
<span class="c1">#     else row[&#39;vocab&#39;]==next_row[&#39;vocab&#39;]</span>
<span class="c1">#     vocab_word = set(row[&#39;tf&#39;])</span>
<span class="c1">#     vocab_set = set(row[&#39;vocab&#39;].split(&#39;::&#39;))</span>
<span class="c1">#     other_vocab = list(vocab_set -  vocab_word)[0]</span>
    <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">check_distance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">next_row</span><span class="p">,</span><span class="n">max_dist</span><span class="o">=</span><span class="n">MAX_DIST</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;chr_m&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;chr_m&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;stop_m&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;start_m&#39;</span><span class="p">]:</span>
            <span class="n">tot_dist</span> <span class="o">=</span> <span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;stop_m&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_m&#39;</span><span class="p">]</span>
            <span class="n">btn_dist</span> <span class="o">=</span> <span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;start_m&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;stop_m&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">tot_dist</span> <span class="o">&lt;</span> <span class="n">max_dist</span><span class="p">),</span> <span class="n">tot_dist</span><span class="p">,</span> <span class="n">btn_dist</span>
    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>

<span class="k">def</span> <span class="nf">check_tissue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">next_row</span><span class="p">,</span><span class="n">tfs</span><span class="o">=</span><span class="n">tf_name_to_id_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tfs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tfs</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;both&#39;</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tfs</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tfs</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;one&#39;</span>    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;none&#39;</span>
    
<span class="k">def</span> <span class="nf">get_hits</span><span class="p">(</span><span class="n">vocab_df</span><span class="p">,</span><span class="n">tfs</span><span class="o">=</span><span class="n">tf_name_to_id_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<span class="c1">#     print(&#39;**** reading&#39;, vocab_file)</span>
<span class="c1">#     vocab_df = pd.read_csv(vocab_file)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vocab_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">vocab_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">idx_hits</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">results_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">while</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">vocab_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># look at next </span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">vocab_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">,:]</span>
        <span class="n">next_row</span> <span class="o">=</span> <span class="n">vocab_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">,:]</span>

        <span class="n">check_vocab_pair</span> <span class="o">=</span> <span class="n">get_other_vocab_word</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">next_row</span><span class="p">)</span>
        <span class="n">check_dist</span><span class="p">,</span><span class="n">tot_dist</span><span class="p">,</span> <span class="n">btn_dist</span> <span class="o">=</span> <span class="n">check_distance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">next_row</span><span class="p">)</span>
        <span class="n">check_tissue_tf</span> <span class="o">=</span> <span class="n">check_tissue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">next_row</span><span class="p">,</span><span class="n">tfs</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">check_dist</span> <span class="ow">and</span> <span class="n">check_vocab_pair</span><span class="p">):</span>
    <span class="c1">#         print(&#39;hi&#39;,idx)</span>
    <span class="c1">#         print(row)</span>
    <span class="c1">#         print(next_row)</span>

            <span class="n">results_dict</span><span class="p">[</span><span class="n">idx_hits</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">],</span><span class="s1">&#39;tot_dist&#39;</span><span class="p">:</span><span class="n">tot_dist</span><span class="p">,</span><span class="s1">&#39;btn_dist&#39;</span><span class="p">:</span><span class="n">btn_dist</span><span class="p">,</span>
                                      <span class="s1">&#39;chr&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">],</span><span class="s1">&#39;start&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_m&#39;</span><span class="p">],</span><span class="s1">&#39;stop&#39;</span><span class="p">:</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;stop_m&#39;</span><span class="p">],</span> 
                                      <span class="s1">&#39;vocab1&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">],</span><span class="s1">&#39;vocab1_start&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_m&#39;</span><span class="p">],</span> <span class="s1">&#39;vocab1_stop&#39;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;stop_m&#39;</span><span class="p">],</span>
                                      <span class="s1">&#39;vocab2&#39;</span><span class="p">:</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">],</span><span class="s1">&#39;vocab2_start&#39;</span><span class="p">:</span><span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;start_m&#39;</span><span class="p">],</span> <span class="s1">&#39;vocab2_stop&#39;</span><span class="p">:</span> <span class="n">next_row</span><span class="p">[</span><span class="s1">&#39;stop_m&#39;</span><span class="p">],</span>
                                      <span class="s1">&#39;genes&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;genes&#39;</span><span class="p">],</span><span class="s1">&#39;num_genes&#39;</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;genes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)),</span> <span class="s1">&#39;tissue&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">],</span><span class="c1">#&#39;foot_tissue&#39;:row[&#39;foot_tissue&#39;],</span>
                                     <span class="s1">&#39;check_tissuetf&#39;</span><span class="p">:</span><span class="n">check_tissue_tf</span><span class="p">,</span> <span class="s1">&#39;loop_type&#39;</span><span class="p">:</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;type_loop&#39;</span><span class="p">]}</span>
            <span class="n">idx_hits</span><span class="o">+=</span><span class="mi">1</span>

        <span class="n">idx</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num_hits&#39;</span><span class="p">,</span><span class="n">idx_hits</span><span class="p">)</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">results_dict</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">results_df</span>
    
<span class="k">def</span> <span class="nf">filter_results</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span><span class="n">min_hits_per_vocab</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="n">results_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">vocab_counts</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[[</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;original num vocab&#39;</span><span class="p">,</span><span class="n">vocab_counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">vocab_to_include</span> <span class="o">=</span> <span class="n">vocab_counts</span><span class="p">[</span><span class="n">vocab_counts</span><span class="o">&gt;</span><span class="n">min_hits_per_vocab</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;filt num vocab&#39;</span><span class="p">,</span><span class="n">vocab_to_include</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="n">results_df_filt</span> <span class="o">=</span> <span class="n">results_df</span><span class="p">[</span><span class="n">results_df</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">vocab_to_include</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">results_df_filt</span>

    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[947]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># debugging get_hits()</span>
<span class="c1"># vocab_df = vocab_tissue_dict[&#39;MM&#39;]</span>
<span class="c1"># vocab_tissue_dict[&#39;MM&#39;][vocab_tissue_dict[&#39;MM&#39;].vocab ==&#39;IRF3::CEBPZ&#39;]</span>
<span class="c1"># vocab_instances_df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3D-get-genomic-instances">3D get genomic instances<a class="anchor-link" href="#3D-get-genomic-instances">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[948]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_tissue_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">tissue</span> <span class="ow">in</span> <span class="n">geneset_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">vocab_tissue_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="c1">#     print(tissue, len(geneset))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[949]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># vocab_tissue_df = pd.DataFrame()</span>
<span class="c1"># loop through vocab words</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">overall_df_filt</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">vocab</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">]</span>
    <span class="n">tissue</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">]</span>
    <span class="n">foot_tissues</span> <span class="o">=</span> <span class="n">tissue_to_celltype_mapper</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">tissue</span><span class="p">)</span>

    <span class="c1"># loop through the possible tissues that can use that vocab word</span>
    <span class="k">for</span> <span class="n">foot_tissue</span> <span class="ow">in</span> <span class="n">foot_tissues</span><span class="p">:</span>
        <span class="n">foot_df</span> <span class="o">=</span> <span class="n">tissue_to_foot_df</span><span class="p">[</span><span class="n">foot_tissue</span><span class="p">]</span>
        <span class="n">tf_tf_loop_orient_dict</span> <span class="o">=</span>  <span class="n">check_tf_tf_loop_occur</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">foot_tissue</span> <span class="p">,</span><span class="n">geneset_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">])</span>
        
        <span class="c1"># loop through two types of configurations (priority, pro-pro then loop-loop)</span>
        <span class="k">for</span> <span class="n">type_loop</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;pro_pro&#39;</span><span class="p">,</span><span class="s1">&#39;loop_loop&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">tf_tf_loop_orient_dict</span><span class="p">[</span><span class="n">type_loop</span><span class="o">+</span><span class="s1">&#39;_count&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">genes_loop_type</span> <span class="o">=</span> <span class="n">tf_tf_loop_orient_dict</span><span class="p">[</span><span class="n">type_loop</span><span class="o">+</span><span class="s1">&#39;_genes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
                <span class="n">foot_df_sel</span> <span class="o">=</span> <span class="n">foot_df</span><span class="p">[</span><span class="n">foot_df</span><span class="o">.</span><span class="n">TSS</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">genes_loop_type</span><span class="p">)]</span>
                <span class="n">foot_df_sel</span><span class="p">[</span><span class="s1">&#39;tf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">foot_df_sel</span><span class="o">.</span><span class="n">id_trim</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tf_id_to_name_dict</span><span class="p">)</span>
                <span class="n">foot_df_sel</span> <span class="o">=</span> <span class="n">foot_df_sel</span><span class="p">[</span><span class="n">foot_df_sel</span><span class="o">.</span><span class="n">tf</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">))]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
                <span class="n">foot_df_sel</span><span class="p">[</span><span class="s1">&#39;vocab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab</span>
                <span class="n">foot_df_sel</span><span class="p">[</span><span class="s1">&#39;genes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf_tf_loop_orient_dict</span><span class="p">[</span><span class="n">type_loop</span><span class="o">+</span><span class="s1">&#39;_genes&#39;</span><span class="p">]</span>
                <span class="n">foot_df_sel</span><span class="p">[</span><span class="s1">&#39;tissue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tissue</span>
                <span class="n">foot_df_sel</span><span class="p">[</span><span class="s1">&#39;foot_tissue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">foot_tissue</span>
                <span class="n">foot_df_sel</span><span class="p">[</span><span class="s1">&#39;type_loop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">type_loop</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">foot_tissue</span><span class="p">,</span> <span class="n">type_loop</span><span class="p">,</span> <span class="n">foot_df_sel</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1">#                 vocab_tissue_df = pd.concat([vocab_tissue_df, foot_df_sel],axis=0,sort=False)</span>
                <span class="n">vocab_tissue_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span> <span class="n">vocab_tissue_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">],</span> <span class="n">foot_df_sel</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>***** 0 BARX2::DLX4 Colon
Colon pro_pro (12, 16)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:19: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Colon loop_loop (108, 16)
***** 1 BARX2::FOXF2 Colon
Colon pro_pro (80, 16)
Colon loop_loop (408, 16)
***** 2 BARX2::FOXM1 Colon
Colon pro_pro (54, 16)
Colon loop_loop (360, 16)
***** 3 BARX2::THAP1 Colon
Colon pro_pro (108, 16)
Colon loop_loop (1223, 16)
***** 4 BATF::KLF15 Colon
Colon pro_pro (33, 16)
Colon loop_loop (1130, 16)
***** 5 DLX4::SOX13 Colon
Colon loop_loop (134, 16)
***** 6 E2F7::THAP1 Colon
Colon pro_pro (106, 16)
Colon loop_loop (715, 16)
***** 7 E2F7::FOXM1 Colon
Colon loop_loop (63, 16)
***** 8 FLI1::FOXM1 Colon
Colon pro_pro (14, 16)
Colon loop_loop (269, 16)
***** 9 FOXA1::THAP1 Colon
Colon loop_loop (193, 16)
***** 10 FOXA2::THAP1 Colon
Colon loop_loop (196, 16)
***** 11 FOXF2::KLF5 Colon
Colon pro_pro (15, 16)
Colon loop_loop (263, 16)
***** 12 FOXF2::SP4 Colon
Colon pro_pro (33, 16)
Colon loop_loop (657, 16)
***** 13 FOXF2::THAP1 Colon
Colon loop_loop (202, 16)
***** 14 FOXM1::KLF15 Colon
Colon pro_pro (36, 16)
Colon loop_loop (686, 16)
***** 15 FOXM1::KLF5 Colon
Colon pro_pro (16, 16)
Colon loop_loop (280, 16)
***** 16 FOXM1::KLF9 Colon
Colon pro_pro (12, 16)
Colon loop_loop (253, 16)
***** 17 FOXM1::MESP1 Colon
Colon pro_pro (14, 16)
Colon loop_loop (136, 16)
***** 18 FOXM1::NR2F1 Colon
Colon pro_pro (6, 16)
Colon loop_loop (140, 16)
***** 19 FOXM1::PATZ1 Colon
Colon pro_pro (51, 16)
Colon loop_loop (950, 16)
***** 20 FOXM1::PLAG1 Colon
Colon pro_pro (7, 16)
Colon loop_loop (168, 16)
***** 21 FOXM1::PPARG Colon
Colon pro_pro (4, 16)
Colon loop_loop (116, 16)
***** 22 FOXM1::RARG Colon
Colon pro_pro (5, 16)
Colon loop_loop (138, 16)
***** 23 FOXM1::RORA Colon
Colon pro_pro (6, 16)
Colon loop_loop (98, 16)
***** 24 FOXM1::SNAI1 Colon
Colon pro_pro (14, 16)
Colon loop_loop (136, 16)
***** 25 FOXM1::SOX13 Colon
Colon pro_pro (83, 16)
Colon loop_loop (625, 16)
***** 26 FOXM1::SP2 Colon
Colon pro_pro (32, 16)
Colon loop_loop (1192, 16)
***** 27 FOXM1::SP4 Colon
Colon pro_pro (30, 16)
Colon loop_loop (768, 16)
***** 28 FOXM1::THAP1 Colon
Colon loop_loop (215, 16)
***** 29 FOXM1::WT1 Colon
Colon pro_pro (53, 16)
Colon loop_loop (1069, 16)
***** 31 GATA4::THAP1 Colon
Colon loop_loop (58, 16)
***** 32 GRHL2::THAP1 Colon
Colon loop_loop (127, 16)
***** 33 HOXA11::KLF15 Colon
Colon pro_pro (12, 16)
Colon loop_loop (203, 16)
***** 34 HOXA11::KLF5 Colon
Colon pro_pro (3, 16)
Colon loop_loop (80, 16)
***** 35 HOXB3::KLF5 Colon
Colon pro_pro (11, 16)
Colon loop_loop (126, 16)
***** 36 HOXC8::KLF5 Colon
Colon loop_loop (147, 16)
***** 37 HOXC8::THAP1 Colon
Colon loop_loop (129, 16)
***** 38 KLF15::KLF5 Colon
Colon pro_pro (1050, 16)
Colon loop_loop (3718, 16)
***** 39 KLF15::MSX2 Colon
Colon pro_pro (159, 16)
Colon loop_loop (1522, 16)
***** 40 KLF15::OSR2 Colon
Colon pro_pro (98, 16)
Colon loop_loop (989, 16)
***** 41 KLF15::OTX1 Colon
Colon pro_pro (98, 16)
Colon loop_loop (1602, 16)
***** 42 KLF15::OVOL2 Colon
Colon pro_pro (22, 16)
Colon loop_loop (391, 16)
***** 43 KLF15::RFX2 Colon
Colon pro_pro (48, 16)
Colon loop_loop (1039, 16)
***** 44 KLF15::SNAI2 Colon
Colon pro_pro (108, 16)
Colon loop_loop (1203, 16)
***** 45 KLF15::THAP1 Colon
Colon pro_pro (568, 16)
Colon loop_loop (2620, 16)
***** 46 KLF15::ZFP28 Colon
Colon pro_pro (83, 16)
Colon loop_loop (822, 16)
***** 47 KLF5::NR2F1 Colon
Colon pro_pro (92, 16)
Colon loop_loop (1022, 16)
***** 48 KLF5::NR4A2 Colon
Colon pro_pro (16, 16)
Colon loop_loop (214, 16)
***** 49 KLF5::RUNX3 Colon
Colon pro_pro (39, 16)
Colon loop_loop (237, 16)
***** 50 KLF5::SOX13 Colon
Colon pro_pro (374, 16)
Colon loop_loop (2941, 16)
***** 51 KLF5::ZFP28 Colon
Colon pro_pro (25, 16)
Colon loop_loop (369, 16)
***** 52 KLF5::ZNF257 Colon
Colon pro_pro (24, 16)
Colon loop_loop (456, 16)
***** 53 MAFB::THAP1 Colon
Colon pro_pro (20, 16)
Colon loop_loop (376, 16)
***** 54 MESP1::THAP1 Colon
Colon pro_pro (61, 16)
Colon loop_loop (803, 16)
***** 55 MSX2::THAP1 Colon
Colon pro_pro (33, 16)
Colon loop_loop (499, 16)
***** 56 NR2F1::THAP1 Colon
Colon pro_pro (72, 16)
Colon loop_loop (761, 16)
***** 57 NR4A2::THAP1 Colon
Colon pro_pro (13, 16)
Colon loop_loop (152, 16)
***** 58 OSR2::THAP1 Colon
Colon pro_pro (24, 16)
Colon loop_loop (316, 16)
***** 59 OTX1::THAP1 Colon
Colon pro_pro (36, 16)
Colon loop_loop (492, 16)
***** 60 OVOL2::THAP1 Colon
Colon loop_loop (83, 16)
***** 61 RARA::THAP1 Colon
Colon pro_pro (60, 16)
Colon loop_loop (720, 16)
***** 62 RARG::THAP1 Colon
Colon pro_pro (64, 16)
Colon loop_loop (686, 16)
***** 63 RFX2::THAP1 Colon
Colon pro_pro (16, 16)
Colon loop_loop (346, 16)
***** 64 RORA::THAP1 Colon
Colon pro_pro (71, 16)
Colon loop_loop (750, 16)
***** 65 RUNX2::THAP1 Colon
Colon pro_pro (3, 16)
Colon loop_loop (239, 16)
***** 66 SNAI2::THAP1 Colon
Colon pro_pro (14, 16)
Colon loop_loop (419, 16)
***** 67 SNAI2::WT1 Colon
Colon pro_pro (251, 16)
Colon loop_loop (1754, 16)
***** 68 SOX13::THAP1 Colon
Colon pro_pro (142, 16)
Colon loop_loop (1928, 16)
***** 69 SP2::THAP1 Colon
Colon pro_pro (1424, 16)
Colon loop_loop (4577, 16)
***** 70 SP4::THAP1 Colon
Colon pro_pro (749, 16)
Colon loop_loop (3014, 16)
***** 71 TCF7::THAP1 Colon
Colon pro_pro (2, 16)
Colon loop_loop (160, 16)
***** 72 THAP1::THRB Colon
Colon pro_pro (15, 16)
Colon loop_loop (355, 16)
***** 73 THAP1::ZFP28 Colon
Colon pro_pro (31, 16)
Colon loop_loop (246, 16)
***** 74 THAP1::ZNF333 Colon
Colon loop_loop (88, 16)
***** 75 ALX1::PRRX1 Melanocytes
Melanocytes pro_pro (14, 16)
Melanocytes loop_loop (111, 16)
***** 76 E2F4::KLF15 Melanocytes
Melanocytes pro_pro (419, 16)
Melanocytes loop_loop (462, 16)
***** 77 EN2::PRRX1 Melanocytes
Melanocytes pro_pro (539, 16)
Melanocytes loop_loop (546, 16)
***** 78 ETV2::PRRX1 Melanocytes
Melanocytes pro_pro (282, 16)
Melanocytes loop_loop (503, 16)
***** 79 ETV2::SP2 Melanocytes
Melanocytes pro_pro (417, 16)
Melanocytes loop_loop (612, 16)
***** 80 FOXD3::PRRX1 Melanocytes
Melanocytes pro_pro (248, 16)
Melanocytes loop_loop (347, 16)
***** 81 FOXD3::ZNF589 Melanocytes
Melanocytes pro_pro (60, 16)
Melanocytes loop_loop (100, 16)
***** 82 FOXL1::PRRX1 Melanocytes
Melanocytes pro_pro (284, 16)
Melanocytes loop_loop (312, 16)
***** 83 HES7::PRRX1 Melanocytes
Melanocytes pro_pro (11, 16)
Melanocytes loop_loop (58, 16)
***** 84 IRF4::KLF12 Melanocytes
Melanocytes pro_pro (71, 16)
Melanocytes loop_loop (135, 16)
***** 85 IRF4::PRRX1 Melanocytes
Melanocytes pro_pro (287, 16)
Melanocytes loop_loop (428, 16)
***** 86 KLF15::PRRX1 Melanocytes
Melanocytes pro_pro (1164, 16)
Melanocytes loop_loop (1935, 16)
***** 87 KLF15::SALL4 Melanocytes
Melanocytes pro_pro (335, 16)
Melanocytes loop_loop (419, 16)
***** 88 KLF15::TFAP2B Melanocytes
Melanocytes pro_pro (366, 16)
Melanocytes loop_loop (458, 16)
***** 89 KLF15::ZNF219 Melanocytes
Melanocytes pro_pro (817, 16)
Melanocytes loop_loop (852, 16)
***** 90 KLF15::ZNF589 Melanocytes
Melanocytes pro_pro (697, 16)
Melanocytes loop_loop (1252, 16)
***** 91 MITF::PRRX1 Melanocytes
Melanocytes pro_pro (101, 16)
Melanocytes loop_loop (170, 16)
***** 92 MITF::SP2 Melanocytes
Melanocytes pro_pro (78, 16)
Melanocytes loop_loop (151, 16)
***** 93 NFATC1::PRRX1 Melanocytes
Melanocytes pro_pro (211, 16)
Melanocytes loop_loop (372, 16)
***** 94 PAX3::PRRX1 Melanocytes
Melanocytes pro_pro (131, 16)
Melanocytes loop_loop (91, 16)
***** 95 PBX1::PRRX1 Melanocytes
Melanocytes pro_pro (242, 16)
Melanocytes loop_loop (337, 16)
***** 96 PRRX1::RARA Melanocytes
Melanocytes pro_pro (159, 16)
Melanocytes loop_loop (604, 16)
***** 97 PRRX1::SALL4 Melanocytes
Melanocytes pro_pro (326, 16)
Melanocytes loop_loop (540, 16)
***** 98 PRRX1::SOX10 Melanocytes
Melanocytes pro_pro (82, 16)
Melanocytes loop_loop (232, 16)
***** 99 PRRX1::TBX2 Melanocytes
Melanocytes pro_pro (46, 16)
Melanocytes loop_loop (60, 16)
***** 100 PRRX1::TFAP2B Melanocytes
Melanocytes pro_pro (185, 16)
Melanocytes loop_loop (687, 16)
***** 101 PRRX1::TFEB Melanocytes
Melanocytes pro_pro (29, 16)
Melanocytes loop_loop (53, 16)
***** 102 SP2::TFAP2B Melanocytes
Melanocytes pro_pro (982, 16)
Melanocytes loop_loop (991, 16)
***** 103 SP2::ZNF324 Melanocytes
Melanocytes pro_pro (375, 16)
Melanocytes loop_loop (622, 16)
***** 104 TFAP2B::ZNF589 Melanocytes
Melanocytes pro_pro (72, 16)
Melanocytes loop_loop (275, 16)
***** 105 NFATC4::SOX10 Melanocytes
Melanocytes pro_pro (23, 16)
Melanocytes loop_loop (33, 16)
***** 106 PAX3::ZNF589 Melanocytes
Melanocytes pro_pro (31, 16)
Melanocytes loop_loop (24, 16)
***** 107 SOX10::ZNF589 Melanocytes
Melanocytes pro_pro (19, 16)
Melanocytes loop_loop (62, 16)
***** 108 ETV2::ZNF589 Melanocytes
Melanocytes pro_pro (86, 16)
Melanocytes loop_loop (201, 16)
***** 109 LEF1::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (7, 16)
***** 110 IRF4::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (13, 16)
***** 111 MITF::PAX3 Melanocytes
Melanocytes loop_loop (0, 16)
***** 112 MITF::TFAP2B Melanocytes
Melanocytes pro_pro (10, 16)
Melanocytes loop_loop (12, 16)
***** 113 MITF::SOX10 Melanocytes
Melanocytes loop_loop (1, 16)
***** 114 MITF::SOX11 Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (7, 16)
***** 115 MITF::SOX5 Melanocytes
Melanocytes loop_loop (0, 16)
***** 116 ALX1::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 117 GLI3::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (2, 16)
***** 118 CPEB1::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 119 CREB3L1::MITF Melanocytes
Melanocytes pro_pro (8, 16)
Melanocytes loop_loop (8, 16)
***** 120 MITF::TCF4 Melanocytes
Melanocytes loop_loop (0, 16)
***** 121 LEF1::PAX3 Melanocytes
Melanocytes loop_loop (0, 16)
***** 122 PAX3::SOX10 Melanocytes
Melanocytes loop_loop (0, 16)
***** 123 PAX3::TCF4 Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (0, 16)
***** 124 PAX3::TFAP2B Melanocytes
Melanocytes loop_loop (2, 16)
***** 125 LEF1::SOX10 Melanocytes
Melanocytes loop_loop (6, 16)
***** 126 LEF1::TCF4 Melanocytes
Melanocytes loop_loop (0, 16)
***** 127 LEF1::TFAP2B Melanocytes
Melanocytes loop_loop (15, 16)
***** 128 GLI3::LEF1 Melanocytes
Melanocytes loop_loop (1, 16)
***** 129 ARNT2::MITF Melanocytes
Melanocytes pro_pro (19, 16)
Melanocytes loop_loop (26, 16)
***** 130 BATF3::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (2, 16)
***** 131 E2F1::MITF Melanocytes
Melanocytes pro_pro (4, 16)
Melanocytes loop_loop (4, 16)
***** 132 E2F2::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (0, 16)
***** 133 E2F4::MITF Melanocytes
Melanocytes pro_pro (7, 16)
Melanocytes loop_loop (7, 16)
***** 134 E2F7::MITF Melanocytes
Melanocytes pro_pro (4, 16)
Melanocytes loop_loop (6, 16)
***** 135 EBF1::MITF Melanocytes
Melanocytes loop_loop (12, 16)
***** 136 EN2::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 137 ETV1::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 138 ETV2::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (6, 16)
***** 139 FOXD3::MITF Melanocytes
Melanocytes loop_loop (3, 16)
***** 140 FOXF2::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (1, 16)
***** 141 FOXL1::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 142 GLIS3::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 143 HES7::MITF Melanocytes
Melanocytes pro_pro (3, 16)
Melanocytes loop_loop (3, 16)
***** 144 HEY1::MITF Melanocytes
Melanocytes pro_pro (16, 16)
Melanocytes loop_loop (16, 16)
***** 145 HOXB3::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 146 HOXB8::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 147 HOXC10::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 148 HOXC11::MITF Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (0, 16)
***** 149 HOXC6::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 150 HOXC8::MITF Melanocytes
Melanocytes loop_loop (2, 16)
***** 151 HOXD3::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 152 HOXD8::MITF Melanocytes
Melanocytes pro_pro (3, 16)
Melanocytes loop_loop (3, 16)
***** 153 HSF4::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 154 ID4::MITF Melanocytes
Melanocytes pro_pro (3, 16)
Melanocytes loop_loop (3, 16)
***** 155 KLF12::MITF Melanocytes
Melanocytes pro_pro (23, 16)
Melanocytes loop_loop (36, 16)
***** 156 KLF15::MITF Melanocytes
Melanocytes pro_pro (33, 16)
Melanocytes loop_loop (94, 16)
***** 157 KLF9::MITF Melanocytes
Melanocytes pro_pro (12, 16)
Melanocytes loop_loop (27, 16)
***** 158 LYL1::MITF Melanocytes
Melanocytes loop_loop (1, 16)
***** 159 MAF::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 160 MEF2C::MITF Melanocytes
Melanocytes loop_loop (1, 16)
***** 161 MEIS1::MITF Melanocytes
Melanocytes pro_pro (7, 16)
Melanocytes loop_loop (0, 16)
***** 162 MEIS3::MITF Melanocytes
Melanocytes loop_loop (0, 16)
***** 163 MITF::MYOD1 Melanocytes
Melanocytes loop_loop (2, 16)
***** 164 MITF::NFATC1 Melanocytes
Melanocytes pro_pro (3, 16)
Melanocytes loop_loop (8, 16)
***** 165 MITF::NFATC2 Melanocytes
Melanocytes pro_pro (4, 16)
Melanocytes loop_loop (8, 16)
***** 166 MITF::NFATC4 Melanocytes
Melanocytes pro_pro (24, 16)
Melanocytes loop_loop (56, 16)
***** 167 MITF::NR4A3 Melanocytes
Melanocytes loop_loop (0, 16)
***** 168 MITF::PLAG1 Melanocytes
Melanocytes pro_pro (5, 16)
Melanocytes loop_loop (6, 16)
***** 169 MITF::POU3F1 Melanocytes
Melanocytes loop_loop (0, 16)
***** 170 MITF::RARA Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (12, 16)
***** 171 MITF::RARB Melanocytes
Melanocytes loop_loop (2, 16)
***** 172 MITF::RFX3 Melanocytes
Melanocytes loop_loop (8, 16)
***** 173 MITF::SALL4 Melanocytes
Melanocytes pro_pro (8, 16)
Melanocytes loop_loop (12, 16)
***** 174 MITF::TBX2 Melanocytes
Melanocytes loop_loop (10, 16)
***** 175 MITF::TFEB Melanocytes
Melanocytes pro_pro (4, 16)
Melanocytes loop_loop (4, 16)
***** 176 MITF::TWIST1 Melanocytes
Melanocytes loop_loop (4, 16)
***** 177 MITF::ZBTB33 Melanocytes
Melanocytes loop_loop (0, 16)
***** 178 MITF::ZBTB6 Melanocytes
Melanocytes pro_pro (3, 16)
Melanocytes loop_loop (3, 16)
***** 179 MITF::ZFP82 Melanocytes
Melanocytes loop_loop (1, 16)
***** 180 MITF::ZNF136 Melanocytes
Melanocytes loop_loop (0, 16)
***** 181 MITF::ZNF18 Melanocytes
Melanocytes pro_pro (5, 16)
Melanocytes loop_loop (13, 16)
***** 182 MITF::ZNF219 Melanocytes
Melanocytes pro_pro (14, 16)
Melanocytes loop_loop (25, 16)
***** 183 MITF::ZNF324 Melanocytes
Melanocytes pro_pro (4, 16)
Melanocytes loop_loop (5, 16)
***** 184 MITF::ZNF333 Melanocytes
Melanocytes loop_loop (0, 16)
***** 185 MITF::ZNF382 Melanocytes
Melanocytes loop_loop (0, 16)
***** 186 MITF::ZNF41 Melanocytes
Melanocytes loop_loop (10, 16)
***** 187 MITF::ZNF418 Melanocytes
Melanocytes pro_pro (4, 16)
Melanocytes loop_loop (1, 16)
***** 188 MITF::ZNF423 Melanocytes
Melanocytes pro_pro (2, 16)
Melanocytes loop_loop (0, 16)
***** 189 MITF::ZNF436 Melanocytes
Melanocytes loop_loop (2, 16)
***** 190 MITF::ZNF449 Melanocytes
Melanocytes pro_pro (3, 16)
Melanocytes loop_loop (6, 16)
***** 191 MITF::ZNF549 Melanocytes
Melanocytes loop_loop (2, 16)
***** 192 MITF::ZNF554 Melanocytes
Melanocytes pro_pro (7, 16)
Melanocytes loop_loop (8, 16)
***** 193 MITF::ZNF589 Melanocytes
Melanocytes pro_pro (32, 16)
Melanocytes loop_loop (78, 16)
***** 194 MITF::ZNF708 Melanocytes
Melanocytes loop_loop (2, 16)
***** 195 MITF::ZNF76 Melanocytes
Melanocytes loop_loop (7, 16)
***** 196 ARID5B::KLF5 GDSD6
GDSD6 pro_pro (111, 16)
GDSD6 loop_loop (1274, 16)
***** 197 ASCL2::KLF4 GDSD6
GDSD6 pro_pro (40, 16)
GDSD6 loop_loop (222, 16)
***** 198 ASCL2::KLF5 GDSD6
GDSD6 pro_pro (51, 16)
GDSD6 loop_loop (272, 16)
***** 199 ATF2::KLF5 GDSD6
GDSD6 pro_pro (30, 16)
GDSD6 loop_loop (295, 16)
***** 200 ATF2::RORA GDSD6
GDSD6 pro_pro (24, 16)
GDSD6 loop_loop (117, 16)
***** 201 ATF4::EGR2 GDSD6
GDSD6 pro_pro (3, 16)
GDSD6 loop_loop (343, 16)
***** 202 ATF4::KLF5 GDSD6
GDSD6 loop_loop (167, 16)
***** 203 BACH1::KLF5 GDSD6
GDSD6 pro_pro (13, 16)
GDSD6 loop_loop (180, 16)
***** 204 BACH1::RORA GDSD6
GDSD6 pro_pro (6, 16)
GDSD6 loop_loop (70, 16)
***** 205 CEBPB::KLF5 GDSD6
GDSD6 loop_loop (90, 16)
***** 206 CEBPG::KLF5 GDSD6
GDSD6 pro_pro (2, 16)
GDSD6 loop_loop (194, 16)
***** 207 CEBPG::RORA GDSD6
GDSD6 pro_pro (3, 16)
GDSD6 loop_loop (56, 16)
***** 208 CREM::KLF5 GDSD6
GDSD6 pro_pro (19, 16)
GDSD6 loop_loop (136, 16)
***** 209 DBP::KLF5 GDSD6
GDSD6 pro_pro (6, 16)
GDSD6 loop_loop (105, 16)
***** 210 DDIT3::KLF5 GDSD6
GDSD6 loop_loop (200, 16)
***** 211 DDIT3::RORA GDSD6
GDSD6 loop_loop (55, 16)
***** 212 DLX5::KLF5 GDSD6
GDSD6 loop_loop (50, 16)
***** 213 EGR2::FOSL2 GDSD6
GDSD6 pro_pro (35, 16)
GDSD6 loop_loop (816, 16)
***** 214 EGR2::JUN GDSD6
GDSD6 pro_pro (35, 16)
GDSD6 loop_loop (750, 16)
***** 215 EGR2::JUNB GDSD6
GDSD6 pro_pro (35, 16)
GDSD6 loop_loop (662, 16)
***** 216 EGR2::KLF4 GDSD6
GDSD6 pro_pro (766, 16)
GDSD6 loop_loop (1831, 16)
***** 217 EGR2::KLF5 GDSD6
GDSD6 pro_pro (790, 16)
GDSD6 loop_loop (1968, 16)
***** 218 EGR2::RARG GDSD6
GDSD6 pro_pro (33, 16)
GDSD6 loop_loop (714, 16)
***** 219 EGR2::RORA GDSD6
GDSD6 pro_pro (175, 16)
GDSD6 loop_loop (893, 16)
***** 220 EGR2::SNAI2 GDSD6
GDSD6 pro_pro (75, 16)
GDSD6 loop_loop (427, 16)
***** 221 EGR2::TP63 GDSD6
GDSD6 pro_pro (90, 16)
GDSD6 loop_loop (839, 16)
***** 222 EGR3::KLF4 GDSD6
GDSD6 pro_pro (109, 16)
GDSD6 loop_loop (465, 16)
***** 223 EGR3::TP63 GDSD6
GDSD6 pro_pro (10, 16)
GDSD6 loop_loop (169, 16)
***** 224 FOS::RORA GDSD6
GDSD6 pro_pro (13, 16)
GDSD6 loop_loop (147, 16)
***** 225 FOSL2::SREBF2 GDSD6
GDSD6 pro_pro (15, 16)
GDSD6 loop_loop (140, 16)
***** 226 GATA3::KLF5 GDSD6
GDSD6 pro_pro (3, 16)
GDSD6 loop_loop (167, 16)
***** 227 HBP1::KLF5 GDSD6
GDSD6 pro_pro (32, 16)
GDSD6 loop_loop (400, 16)
***** 228 HBP1::RORA GDSD6
GDSD6 loop_loop (129, 16)
***** 229 HMGA1::KLF5 GDSD6
GDSD6 pro_pro (42, 16)
GDSD6 loop_loop (600, 16)
***** 230 HMGA1::RORA GDSD6
GDSD6 pro_pro (18, 16)
GDSD6 loop_loop (196, 16)
***** 231 HOXA1::KLF5 GDSD6
GDSD6 loop_loop (69, 16)
***** 232 ID4::TP63 GDSD6
GDSD6 pro_pro (22, 16)
GDSD6 loop_loop (238, 16)
***** 233 IRF6::SP2 GDSD6
GDSD6 pro_pro (35, 16)
GDSD6 loop_loop (143, 16)
***** 234 IRF7::KLF5 GDSD6
GDSD6 pro_pro (21, 16)
GDSD6 loop_loop (133, 16)
***** 235 IRF7::RORA GDSD6
GDSD6 loop_loop (54, 16)
***** 236 IRX3::KLF5 GDSD6
GDSD6 pro_pro (9, 16)
GDSD6 loop_loop (136, 16)
***** 237 IRX3::RORA GDSD6
GDSD6 pro_pro (4, 16)
GDSD6 loop_loop (51, 16)
***** 238 JUN::RORA GDSD6
GDSD6 pro_pro (13, 16)
GDSD6 loop_loop (138, 16)
***** 239 JUN::SREBF2 GDSD6
GDSD6 pro_pro (15, 16)
GDSD6 loop_loop (130, 16)
***** 240 JUNB::RORA GDSD6
GDSD6 pro_pro (12, 16)
GDSD6 loop_loop (118, 16)
***** 241 JUND::RORA GDSD6
GDSD6 pro_pro (12, 16)
GDSD6 loop_loop (118, 16)
***** 242 KLF4::POU2F3 GDSD6
GDSD6 loop_loop (71, 16)
***** 243 KLF4::SALL4 GDSD6
GDSD6 pro_pro (218, 16)
GDSD6 loop_loop (584, 16)
***** 244 KLF4::SREBF2 GDSD6
GDSD6 pro_pro (43, 16)
GDSD6 loop_loop (314, 16)
***** 245 KLF4::STAT3 GDSD6
GDSD6 pro_pro (24, 16)
GDSD6 loop_loop (124, 16)
***** 246 KLF4::TFE3 GDSD6
GDSD6 pro_pro (22, 16)
GDSD6 loop_loop (125, 16)
***** 247 KLF4::ZNF143 GDSD6
GDSD6 pro_pro (2, 16)
GDSD6 loop_loop (80, 16)
***** 248 KLF5::MAFG GDSD6
GDSD6 pro_pro (56, 16)
GDSD6 loop_loop (290, 16)
***** 249 KLF5::MAFK GDSD6
GDSD6 pro_pro (14, 16)
GDSD6 loop_loop (260, 16)
***** 250 KLF5::MEIS2 GDSD6
GDSD6 loop_loop (95, 16)
***** 251 KLF5::NFIC GDSD6
GDSD6 pro_pro (69, 16)
GDSD6 loop_loop (524, 16)
***** 252 KLF5::NFIL3 GDSD6
GDSD6 pro_pro (4, 16)
GDSD6 loop_loop (130, 16)
***** 253 KLF5::NR3C1 GDSD6
GDSD6 pro_pro (29, 16)
GDSD6 loop_loop (284, 16)
***** 254 KLF5::PITX1 GDSD6
GDSD6 loop_loop (88, 16)
***** 255 KLF5::POU2F1 GDSD6
GDSD6 pro_pro (2, 16)
GDSD6 loop_loop (89, 16)
***** 256 KLF5::POU2F3 GDSD6
GDSD6 loop_loop (89, 16)
***** 257 KLF5::SOX7 GDSD6
GDSD6 pro_pro (5, 16)
GDSD6 loop_loop (61, 16)
***** 258 KLF5::SREBF2 GDSD6
GDSD6 pro_pro (54, 16)
GDSD6 loop_loop (380, 16)
***** 259 KLF5::STAT3 GDSD6
GDSD6 pro_pro (26, 16)
GDSD6 loop_loop (156, 16)
***** 260 KLF5::TCF7L2 GDSD6
GDSD6 pro_pro (7, 16)
GDSD6 loop_loop (85, 16)
***** 261 KLF5::TGIF1 GDSD6
GDSD6 pro_pro (4, 16)
GDSD6 loop_loop (220, 16)
***** 262 KLF5::UBP1 GDSD6
GDSD6 pro_pro (372, 16)
GDSD6 loop_loop (1972, 16)
***** 263 KLF5::ZNF143 GDSD6
GDSD6 pro_pro (3, 16)
GDSD6 loop_loop (98, 16)
***** 264 MAF::RORA GDSD6
GDSD6 pro_pro (4, 16)
GDSD6 loop_loop (126, 16)
***** 265 MAFF::RORA GDSD6
GDSD6 pro_pro (17, 16)
GDSD6 loop_loop (127, 16)
***** 266 MAFG::RORA GDSD6
GDSD6 pro_pro (15, 16)
GDSD6 loop_loop (111, 16)
***** 267 NFATC1::RORA GDSD6
GDSD6 loop_loop (94, 16)
***** 268 NFE2L1::RORA GDSD6
GDSD6 pro_pro (9, 16)
GDSD6 loop_loop (257, 16)
***** 269 NFIC::RARG GDSD6
GDSD6 pro_pro (8, 16)
GDSD6 loop_loop (202, 16)
***** 270 NFIC::RORA GDSD6
GDSD6 pro_pro (11, 16)
GDSD6 loop_loop (174, 16)
***** 271 NR3C1::RORA GDSD6
GDSD6 pro_pro (4, 16)
GDSD6 loop_loop (93, 16)
***** 272 PRDM1::RORA GDSD6
GDSD6 pro_pro (5, 16)
GDSD6 loop_loop (87, 16)
***** 273 RARG::SREBF2 GDSD6
GDSD6 pro_pro (5, 16)
GDSD6 loop_loop (142, 16)
***** 274 RORA::SMAD3 GDSD6
GDSD6 pro_pro (17, 16)
GDSD6 loop_loop (140, 16)
***** 275 RORA::SREBF2 GDSD6
GDSD6 pro_pro (17, 16)
GDSD6 loop_loop (108, 16)
***** 276 RORA::TP53 GDSD6
GDSD6 pro_pro (38, 16)
GDSD6 loop_loop (133, 16)
***** 277 RORA::TP63 GDSD6
GDSD6 pro_pro (11, 16)
GDSD6 loop_loop (140, 16)
***** 278 RORA::UBP1 GDSD6
GDSD6 pro_pro (86, 16)
GDSD6 loop_loop (751, 16)
***** 279 SALL4::TP63 GDSD6
GDSD6 pro_pro (19, 16)
GDSD6 loop_loop (215, 16)
***** 280 STAT3::UBP1 GDSD6
GDSD6 pro_pro (41, 16)
GDSD6 loop_loop (311, 16)
***** 281 TFE3::UBP1 GDSD6
GDSD6 pro_pro (20, 16)
GDSD6 loop_loop (353, 16)
***** 282 BATF::IKZF1 GM12878
GM12878 pro_pro (8, 16)
GM12878 loop_loop (105, 16)
***** 283 BATF::ZNF589 GM12878
GM12878 pro_pro (138, 16)
GM12878 loop_loop (586, 16)
***** 284 CBFB::IRF8 GM12878
GM12878 pro_pro (8, 16)
GM12878 loop_loop (142, 16)
***** 285 EBF1::SP4 GM12878
GM12878 pro_pro (147, 16)
GM12878 loop_loop (758, 16)
***** 286 EBF1::ZNF816 GM12878
GM12878 pro_pro (7, 16)
GM12878 loop_loop (155, 16)
***** 287 EGR1::IKZF1 GM12878
GM12878 pro_pro (47, 16)
GM12878 loop_loop (352, 16)
***** 288 EGR1::IRF2 GM12878
GM12878 loop_loop (155, 16)
***** 289 EGR1::IRF4 GM12878
GM12878 pro_pro (34, 16)
GM12878 loop_loop (242, 16)
***** 290 EGR3::IRF8 GM12878
GM12878 loop_loop (139, 16)
***** 291 ETS1::IKZF1 GM12878
GM12878 pro_pro (13, 16)
GM12878 loop_loop (244, 16)
***** 292 ETS1::IRF4 GM12878
GM12878 pro_pro (32, 16)
GM12878 loop_loop (198, 16)
***** 293 ETV5::IRF8 GM12878
GM12878 pro_pro (57, 16)
GM12878 loop_loop (313, 16)
***** 294 FOXP1::IRF8 GM12878
GM12878 pro_pro (13, 16)
GM12878 loop_loop (80, 16)
***** 295 HBP1::IRF8 GM12878
GM12878 pro_pro (25, 16)
GM12878 loop_loop (171, 16)
***** 296 IKZF1::IRF1 GM12878
GM12878 pro_pro (11, 16)
GM12878 loop_loop (258, 16)
***** 297 IKZF1::IRF2 GM12878
GM12878 pro_pro (10, 16)
GM12878 loop_loop (197, 16)
***** 298 IKZF1::IRF3 GM12878
GM12878 pro_pro (19, 16)
GM12878 loop_loop (370, 16)
***** 299 IKZF1::IRF4 GM12878
GM12878 pro_pro (23, 16)
GM12878 loop_loop (210, 16)
***** 300 IKZF1::IRF7 GM12878
GM12878 pro_pro (12, 16)
GM12878 loop_loop (139, 16)
***** 301 IKZF1::IRF8 GM12878
GM12878 pro_pro (24, 16)
GM12878 loop_loop (208, 16)
***** 302 IKZF1::MEF2A GM12878
GM12878 pro_pro (5, 16)
GM12878 loop_loop (87, 16)
***** 303 IKZF1::MYBL2 GM12878
GM12878 pro_pro (33, 16)
GM12878 loop_loop (378, 16)
***** 304 IKZF1::NFKB1 GM12878
GM12878 pro_pro (6, 16)
GM12878 loop_loop (113, 16)
***** 305 IKZF1::PAX5 GM12878
GM12878 pro_pro (13, 16)
GM12878 loop_loop (103, 16)
***** 306 IKZF1::RUNX3 GM12878
GM12878 pro_pro (9, 16)
GM12878 loop_loop (93, 16)
***** 307 IKZF1::SP4 GM12878
GM12878 pro_pro (224, 16)
GM12878 loop_loop (1428, 16)
***** 308 IKZF1::TP73 GM12878
GM12878 pro_pro (9, 16)
GM12878 loop_loop (110, 16)
***** 309 IKZF1::ZBTB33 GM12878
GM12878 pro_pro (4, 16)
GM12878 loop_loop (80, 16)
***** 310 IKZF1::ZNF563 GM12878
GM12878 pro_pro (38, 16)
GM12878 loop_loop (221, 16)
***** 311 IKZF1::ZNF586 GM12878
GM12878 pro_pro (5, 16)
GM12878 loop_loop (83, 16)
***** 312 IKZF1::ZNF589 GM12878
GM12878 pro_pro (120, 16)
GM12878 loop_loop (1247, 16)
***** 313 IRF2::IRF4 GM12878
GM12878 pro_pro (38, 16)
GM12878 loop_loop (210, 16)
***** 314 IRF2::TP73 GM12878
GM12878 pro_pro (5, 16)
GM12878 loop_loop (73, 16)
***** 315 IRF4::IRF7 GM12878
GM12878 pro_pro (31, 16)
GM12878 loop_loop (122, 16)
***** 316 IRF4::IRF8 GM12878
GM12878 pro_pro (83, 16)
GM12878 loop_loop (236, 16)
***** 317 IRF4::NR3C1 GM12878
GM12878 pro_pro (20, 16)
GM12878 loop_loop (122, 16)
***** 318 IRF4::OSR2 GM12878
GM12878 pro_pro (4, 16)
GM12878 loop_loop (104, 16)
***** 319 IRF4::PLAG1 GM12878
GM12878 pro_pro (2, 16)
GM12878 loop_loop (225, 16)
***** 320 IRF4::SP4 GM12878
GM12878 pro_pro (127, 16)
GM12878 loop_loop (1070, 16)
***** 321 IRF4::ZBTB49 GM12878
GM12878 pro_pro (12, 16)
GM12878 loop_loop (171, 16)
***** 322 IRF4::ZNF816 GM12878
GM12878 pro_pro (17, 16)
GM12878 loop_loop (239, 16)
***** 323 IRF8::LEF1 GM12878
GM12878 pro_pro (29, 16)
GM12878 loop_loop (77, 16)
***** 324 IRF8::MEF2A GM12878
GM12878 pro_pro (11, 16)
GM12878 loop_loop (70, 16)
***** 325 IRF8::MYBL2 GM12878
GM12878 pro_pro (45, 16)
GM12878 loop_loop (268, 16)
***** 326 IRF8::PRDM1 GM12878
GM12878 pro_pro (90, 16)
GM12878 loop_loop (213, 16)
***** 327 IRF8::SPIB GM12878
GM12878 pro_pro (29, 16)
GM12878 loop_loop (180, 16)
***** 328 IRF8::STAT1 GM12878
GM12878 pro_pro (120, 16)
GM12878 loop_loop (384, 16)
***** 329 IRF8::STAT2 GM12878
GM12878 pro_pro (93, 16)
GM12878 loop_loop (330, 16)
***** 330 IRF8::UBP1 GM12878
GM12878 pro_pro (276, 16)
GM12878 loop_loop (1085, 16)
***** 331 IRF8::ZBTB49 GM12878
GM12878 pro_pro (16, 16)
GM12878 loop_loop (157, 16)
***** 332 IRF8::ZNF394 GM12878
GM12878 pro_pro (29, 16)
GM12878 loop_loop (173, 16)
***** 333 IRF8::ZNF589 GM12878
GM12878 pro_pro (137, 16)
GM12878 loop_loop (985, 16)
***** 334 IRF8::ZNF816 GM12878
GM12878 pro_pro (12, 16)
GM12878 loop_loop (222, 16)
***** 335 PAX5::SP4 GM12878
GM12878 pro_pro (184, 16)
GM12878 loop_loop (783, 16)
***** 336 PAX5::ZNF589 GM12878
GM12878 pro_pro (20, 16)
GM12878 loop_loop (432, 16)
***** 337 SP4::TCF3 GM12878
GM12878 pro_pro (73, 16)
GM12878 loop_loop (678, 16)
***** 338 TCF3::ZNF589 GM12878
GM12878 pro_pro (35, 16)
GM12878 loop_loop (553, 16)
***** 339 ARNT::SP1 SCC
A431-CTRLi pro_pro (59, 16)
A431-CTRLi loop_loop (1745, 16)
CAL27-CTRLi pro_pro (62, 16)
CAL27-CTRLi loop_loop (2011, 16)
SCC13-CTRLi pro_pro (76, 16)
SCC13-CTRLi loop_loop (1478, 16)
***** 340 E2F1::SP1 SCC
A431-CTRLi pro_pro (415, 16)
A431-CTRLi loop_loop (2784, 16)
CAL27-CTRLi pro_pro (343, 16)
CAL27-CTRLi loop_loop (2600, 16)
SCC13-CTRLi pro_pro (316, 16)
SCC13-CTRLi loop_loop (2268, 16)
***** 341 E2F6::SP1 SCC
A431-CTRLi pro_pro (407, 16)
A431-CTRLi loop_loop (3293, 16)
CAL27-CTRLi pro_pro (315, 16)
CAL27-CTRLi loop_loop (3156, 16)
SCC13-CTRLi pro_pro (336, 16)
SCC13-CTRLi loop_loop (2766, 16)
***** 342 EGR1::SP1 SCC
A431-CTRLi pro_pro (955, 16)
A431-CTRLi loop_loop (3524, 16)
CAL27-CTRLi pro_pro (658, 16)
CAL27-CTRLi loop_loop (3412, 16)
SCC13-CTRLi pro_pro (634, 16)
SCC13-CTRLi loop_loop (2981, 16)
***** 343 EGR1::SP3 SCC
A431-CTRLi pro_pro (354, 16)
A431-CTRLi loop_loop (1337, 16)
CAL27-CTRLi pro_pro (236, 16)
CAL27-CTRLi loop_loop (1331, 16)
SCC13-CTRLi pro_pro (270, 16)
SCC13-CTRLi loop_loop (1182, 16)
***** 344 ETS1::SP1 SCC
A431-CTRLi pro_pro (357, 16)
A431-CTRLi loop_loop (3248, 16)
CAL27-CTRLi pro_pro (396, 16)
CAL27-CTRLi loop_loop (2900, 16)
SCC13-CTRLi pro_pro (256, 16)
SCC13-CTRLi loop_loop (2606, 16)
***** 345 KLF16::SP1 SCC
A431-CTRLi pro_pro (1778, 16)
A431-CTRLi loop_loop (4760, 16)
CAL27-CTRLi pro_pro (1346, 16)
CAL27-CTRLi loop_loop (4676, 16)
SCC13-CTRLi pro_pro (1418, 16)
SCC13-CTRLi loop_loop (4146, 16)
***** 346 KLF16::SP3 SCC
A431-CTRLi pro_pro (884, 16)
A431-CTRLi loop_loop (2493, 16)
CAL27-CTRLi pro_pro (642, 16)
CAL27-CTRLi loop_loop (2467, 16)
SCC13-CTRLi pro_pro (700, 16)
SCC13-CTRLi loop_loop (2243, 16)
***** 347 KLF16::TFAP2C SCC
A431-CTRLi pro_pro (144, 16)
A431-CTRLi loop_loop (1590, 16)
CAL27-CTRLi pro_pro (108, 16)
CAL27-CTRLi loop_loop (1518, 16)
SCC13-CTRLi pro_pro (105, 16)
SCC13-CTRLi loop_loop (1285, 16)
***** 348 KLF4::KLF5 SCC
A431-CTRLi pro_pro (412, 16)
A431-CTRLi loop_loop (1375, 16)
CAL27-CTRLi pro_pro (398, 16)
CAL27-CTRLi loop_loop (1313, 16)
SCC13-CTRLi pro_pro (393, 16)
SCC13-CTRLi loop_loop (1241, 16)
***** 349 KLF4::SP1 SCC
A431-CTRLi pro_pro (1372, 16)
A431-CTRLi loop_loop (3893, 16)
CAL27-CTRLi pro_pro (1073, 16)
CAL27-CTRLi loop_loop (3716, 16)
SCC13-CTRLi pro_pro (1234, 16)
SCC13-CTRLi loop_loop (3294, 16)
***** 350 KLF4::SP3 SCC
A431-CTRLi pro_pro (568, 16)
A431-CTRLi loop_loop (1624, 16)
CAL27-CTRLi pro_pro (466, 16)
CAL27-CTRLi loop_loop (1554, 16)
SCC13-CTRLi pro_pro (561, 16)
SCC13-CTRLi loop_loop (1430, 16)
***** 351 KLF4::TFAP2C SCC
A431-CTRLi pro_pro (80, 16)
A431-CTRLi loop_loop (835, 16)
CAL27-CTRLi pro_pro (46, 16)
CAL27-CTRLi loop_loop (786, 16)
SCC13-CTRLi pro_pro (99, 16)
SCC13-CTRLi loop_loop (693, 16)
***** 352 KLF5::SP3 SCC
A431-CTRLi pro_pro (542, 16)
A431-CTRLi loop_loop (1753, 16)
CAL27-CTRLi pro_pro (459, 16)
CAL27-CTRLi loop_loop (1703, 16)
SCC13-CTRLi pro_pro (454, 16)
SCC13-CTRLi loop_loop (1614, 16)
***** 353 KLF5::TFAP2C SCC
A431-CTRLi pro_pro (88, 16)
A431-CTRLi loop_loop (949, 16)
CAL27-CTRLi pro_pro (64, 16)
CAL27-CTRLi loop_loop (915, 16)
SCC13-CTRLi pro_pro (116, 16)
SCC13-CTRLi loop_loop (830, 16)
***** 354 KLF5::ZNF219 SCC
A431-CTRLi pro_pro (247, 16)
A431-CTRLi loop_loop (1255, 16)
CAL27-CTRLi pro_pro (235, 16)
CAL27-CTRLi loop_loop (1169, 16)
SCC13-CTRLi pro_pro (231, 16)
SCC13-CTRLi loop_loop (1083, 16)
***** 355 KLF6::SP1 SCC
A431-CTRLi pro_pro (1589, 16)
A431-CTRLi loop_loop (4444, 16)
CAL27-CTRLi pro_pro (1250, 16)
CAL27-CTRLi loop_loop (4271, 16)
SCC13-CTRLi pro_pro (1484, 16)
SCC13-CTRLi loop_loop (3884, 16)
***** 356 MAZ::SP1 SCC
A431-CTRLi pro_pro (2876, 16)
A431-CTRLi loop_loop (6969, 16)
CAL27-CTRLi pro_pro (2448, 16)
CAL27-CTRLi loop_loop (6942, 16)
SCC13-CTRLi pro_pro (2695, 16)
SCC13-CTRLi loop_loop (6292, 16)
***** 357 NFAT5::SP1 SCC
A431-CTRLi pro_pro (286, 16)
A431-CTRLi loop_loop (4109, 16)
CAL27-CTRLi pro_pro (450, 16)
CAL27-CTRLi loop_loop (4061, 16)
SCC13-CTRLi pro_pro (474, 16)
SCC13-CTRLi loop_loop (3746, 16)
***** 358 NR2F1::SP1 SCC
A431-CTRLi pro_pro (301, 16)
A431-CTRLi loop_loop (3295, 16)
CAL27-CTRLi pro_pro (358, 16)
CAL27-CTRLi loop_loop (3187, 16)
SCC13-CTRLi pro_pro (478, 16)
SCC13-CTRLi loop_loop (2678, 16)
***** 359 NRF1::SP1 SCC
A431-CTRLi pro_pro (478, 16)
A431-CTRLi loop_loop (2541, 16)
CAL27-CTRLi pro_pro (130, 16)
CAL27-CTRLi loop_loop (2428, 16)
SCC13-CTRLi pro_pro (213, 16)
SCC13-CTRLi loop_loop (1897, 16)
***** 360 PURA::SP1 SCC
A431-CTRLi pro_pro (783, 16)
A431-CTRLi loop_loop (3841, 16)
CAL27-CTRLi pro_pro (781, 16)
CAL27-CTRLi loop_loop (3810, 16)
SCC13-CTRLi pro_pro (847, 16)
SCC13-CTRLi loop_loop (3219, 16)
***** 361 SNAI2::SP1 SCC
A431-CTRLi pro_pro (168, 16)
A431-CTRLi loop_loop (2346, 16)
CAL27-CTRLi pro_pro (124, 16)
CAL27-CTRLi loop_loop (2325, 16)
SCC13-CTRLi pro_pro (180, 16)
SCC13-CTRLi loop_loop (1808, 16)
***** 362 SP1::SP2 SCC
A431-CTRLi pro_pro (3124, 16)
A431-CTRLi loop_loop (7076, 16)
CAL27-CTRLi pro_pro (2797, 16)
CAL27-CTRLi loop_loop (6792, 16)
SCC13-CTRLi pro_pro (2980, 16)
SCC13-CTRLi loop_loop (6198, 16)
***** 363 SP1::SP3 SCC
A431-CTRLi pro_pro (1868, 16)
A431-CTRLi loop_loop (4297, 16)
CAL27-CTRLi pro_pro (1527, 16)
CAL27-CTRLi loop_loop (4129, 16)
SCC13-CTRLi pro_pro (1813, 16)
SCC13-CTRLi loop_loop (3834, 16)
***** 364 SP1::SP4 SCC
A431-CTRLi pro_pro (2181, 16)
A431-CTRLi loop_loop (5598, 16)
CAL27-CTRLi pro_pro (1886, 16)
CAL27-CTRLi loop_loop (5470, 16)
SCC13-CTRLi pro_pro (2217, 16)
SCC13-CTRLi loop_loop (4937, 16)
***** 365 SP1::TBX1 SCC
A431-CTRLi pro_pro (1536, 16)
A431-CTRLi loop_loop (4397, 16)
CAL27-CTRLi pro_pro (1139, 16)
CAL27-CTRLi loop_loop (4290, 16)
SCC13-CTRLi pro_pro (981, 16)
SCC13-CTRLi loop_loop (3773, 16)
***** 366 SP1::TCF3 SCC
A431-CTRLi pro_pro (57, 16)
A431-CTRLi loop_loop (2139, 16)
CAL27-CTRLi pro_pro (74, 16)
CAL27-CTRLi loop_loop (2124, 16)
SCC13-CTRLi pro_pro (127, 16)
SCC13-CTRLi loop_loop (1654, 16)
***** 367 SP1::TFAP2C SCC
A431-CTRLi pro_pro (304, 16)
A431-CTRLi loop_loop (3139, 16)
CAL27-CTRLi pro_pro (340, 16)
CAL27-CTRLi loop_loop (2919, 16)
SCC13-CTRLi pro_pro (365, 16)
SCC13-CTRLi loop_loop (2551, 16)
***** 368 SP1::TFDP1 SCC
A431-CTRLi pro_pro (436, 16)
A431-CTRLi loop_loop (2887, 16)
CAL27-CTRLi pro_pro (333, 16)
CAL27-CTRLi loop_loop (2754, 16)
SCC13-CTRLi pro_pro (281, 16)
SCC13-CTRLi loop_loop (2224, 16)
***** 369 SP1::VEZF1 SCC
A431-CTRLi pro_pro (2000, 16)
A431-CTRLi loop_loop (6132, 16)
CAL27-CTRLi pro_pro (1810, 16)
CAL27-CTRLi loop_loop (6062, 16)
SCC13-CTRLi pro_pro (2031, 16)
SCC13-CTRLi loop_loop (5417, 16)
***** 370 SP1::ZBTB14 SCC
A431-CTRLi pro_pro (376, 16)
A431-CTRLi loop_loop (2609, 16)
CAL27-CTRLi pro_pro (416, 16)
CAL27-CTRLi loop_loop (2464, 16)
SCC13-CTRLi pro_pro (420, 16)
SCC13-CTRLi loop_loop (1979, 16)
***** 371 SP1::ZBTB17 SCC
A431-CTRLi pro_pro (1417, 16)
A431-CTRLi loop_loop (4330, 16)
CAL27-CTRLi pro_pro (1152, 16)
CAL27-CTRLi loop_loop (4216, 16)
SCC13-CTRLi pro_pro (1154, 16)
SCC13-CTRLi loop_loop (3850, 16)
***** 372 SP1::ZNF219 SCC
A431-CTRLi pro_pro (1150, 16)
A431-CTRLi loop_loop (3755, 16)
CAL27-CTRLi pro_pro (1093, 16)
CAL27-CTRLi loop_loop (3524, 16)
SCC13-CTRLi pro_pro (1024, 16)
SCC13-CTRLi loop_loop (3198, 16)
***** 373 SP1::ZNF770 SCC
A431-CTRLi pro_pro (1215, 16)
A431-CTRLi loop_loop (4590, 16)
CAL27-CTRLi pro_pro (947, 16)
CAL27-CTRLi loop_loop (4674, 16)
SCC13-CTRLi pro_pro (816, 16)
SCC13-CTRLi loop_loop (4209, 16)
***** 374 SP3::TFAP2C SCC
A431-CTRLi pro_pro (117, 16)
A431-CTRLi loop_loop (1156, 16)
CAL27-CTRLi pro_pro (87, 16)
CAL27-CTRLi loop_loop (1106, 16)
SCC13-CTRLi pro_pro (153, 16)
SCC13-CTRLi loop_loop (1012, 16)
***** 375 SP3::ZBTB17 SCC
A431-CTRLi pro_pro (633, 16)
A431-CTRLi loop_loop (2059, 16)
CAL27-CTRLi pro_pro (532, 16)
CAL27-CTRLi loop_loop (2058, 16)
SCC13-CTRLi pro_pro (596, 16)
SCC13-CTRLi loop_loop (1908, 16)
***** 376 SP3::ZNF219 SCC
A431-CTRLi pro_pro (479, 16)
A431-CTRLi loop_loop (1501, 16)
CAL27-CTRLi pro_pro (401, 16)
CAL27-CTRLi loop_loop (1427, 16)
SCC13-CTRLi pro_pro (416, 16)
SCC13-CTRLi loop_loop (1304, 16)
***** 377 TFAP2C::ZBTB14 SCC
A431-CTRLi pro_pro (50, 16)
A431-CTRLi loop_loop (338, 16)
CAL27-CTRLi pro_pro (37, 16)
CAL27-CTRLi loop_loop (338, 16)
SCC13-CTRLi pro_pro (44, 16)
SCC13-CTRLi loop_loop (274, 16)
***** 378 TFAP2C::ZNF219 SCC
A431-CTRLi pro_pro (85, 16)
A431-CTRLi loop_loop (742, 16)
CAL27-CTRLi pro_pro (65, 16)
CAL27-CTRLi loop_loop (688, 16)
SCC13-CTRLi pro_pro (69, 16)
SCC13-CTRLi loop_loop (609, 16)
***** 379 NFE2L1::PRRX1 MM
WM-SCR-DMSO pro_pro (292, 16)
WM-SCR-DMSO loop_loop (1584, 16)
***** 380 NFE2L1::UBP1 MM
COLO-SCR-DMSO pro_pro (136, 16)
COLO-SCR-DMSO loop_loop (512, 16)
WM-SCR-DMSO pro_pro (105, 16)
WM-SCR-DMSO loop_loop (663, 16)
***** 381 NFE2L1::SOX13 MM
COLO-SCR-DMSO pro_pro (68, 16)
COLO-SCR-DMSO loop_loop (455, 16)
WM-SCR-DMSO pro_pro (59, 16)
WM-SCR-DMSO loop_loop (567, 16)
***** 382 STAT1::UBP1 MM
COLO-SCR-DMSO pro_pro (120, 16)
COLO-SCR-DMSO loop_loop (396, 16)
WM-SCR-DMSO pro_pro (94, 16)
WM-SCR-DMSO loop_loop (538, 16)
***** 383 ARID5B::NFE2L1 MM
COLO-SCR-DMSO pro_pro (84, 16)
COLO-SCR-DMSO loop_loop (366, 16)
WM-SCR-DMSO pro_pro (64, 16)
WM-SCR-DMSO loop_loop (487, 16)
***** 384 PRRX1::STAT1 MM
WM-SCR-DMSO pro_pro (144, 16)
WM-SCR-DMSO loop_loop (1170, 16)
***** 385 SOX13::STAT1 MM
COLO-SCR-DMSO pro_pro (74, 16)
COLO-SCR-DMSO loop_loop (355, 16)
WM-SCR-DMSO pro_pro (73, 16)
WM-SCR-DMSO loop_loop (491, 16)
***** 386 NFAT5::NFE2L1 MM
COLO-SCR-DMSO pro_pro (23, 16)
COLO-SCR-DMSO loop_loop (256, 16)
WM-SCR-DMSO pro_pro (44, 16)
WM-SCR-DMSO loop_loop (383, 16)
***** 387 NFATC4::NFE2L1 MM
COLO-SCR-DMSO pro_pro (23, 16)
COLO-SCR-DMSO loop_loop (256, 16)
WM-SCR-DMSO pro_pro (44, 16)
WM-SCR-DMSO loop_loop (383, 16)
***** 388 ARID5B::STAT1 MM
COLO-SCR-DMSO pro_pro (88, 16)
COLO-SCR-DMSO loop_loop (305, 16)
WM-SCR-DMSO pro_pro (12, 16)
WM-SCR-DMSO loop_loop (398, 16)
***** 389 ARID5B::SOX10 MM
COLO-SCR-DMSO pro_pro (34, 16)
COLO-SCR-DMSO loop_loop (240, 16)
WM-SCR-DMSO pro_pro (47, 16)
WM-SCR-DMSO loop_loop (381, 16)
***** 390 NFAT5::STAT1 MM
COLO-SCR-DMSO pro_pro (54, 16)
COLO-SCR-DMSO loop_loop (244, 16)
WM-SCR-DMSO pro_pro (21, 16)
WM-SCR-DMSO loop_loop (340, 16)
***** 391 NFATC4::STAT1 MM
COLO-SCR-DMSO pro_pro (54, 16)
COLO-SCR-DMSO loop_loop (244, 16)
WM-SCR-DMSO pro_pro (21, 16)
WM-SCR-DMSO loop_loop (340, 16)
***** 392 SOX10::UBP1 MM
COLO-SCR-DMSO pro_pro (58, 16)
COLO-SCR-DMSO loop_loop (347, 16)
WM-SCR-DMSO pro_pro (74, 16)
WM-SCR-DMSO loop_loop (524, 16)
***** 393 HMGA1::NFE2L1 MM
COLO-SCR-DMSO pro_pro (39, 16)
COLO-SCR-DMSO loop_loop (172, 16)
WM-SCR-DMSO pro_pro (19, 16)
WM-SCR-DMSO loop_loop (228, 16)
***** 394 SOX10::SOX13 MM
COLO-SCR-DMSO pro_pro (38, 16)
COLO-SCR-DMSO loop_loop (272, 16)
WM-SCR-DMSO pro_pro (57, 16)
WM-SCR-DMSO loop_loop (430, 16)
***** 395 EGR2::NFE2L1 MM
WM-SCR-DMSO pro_pro (23, 16)
WM-SCR-DMSO loop_loop (447, 16)
***** 396 LEF1::PRRX1 MM
WM-SCR-DMSO pro_pro (67, 16)
WM-SCR-DMSO loop_loop (922, 16)
***** 397 LEF1::UBP1 MM
COLO-SCR-DMSO pro_pro (47, 16)
COLO-SCR-DMSO loop_loop (256, 16)
WM-SCR-DMSO pro_pro (28, 16)
WM-SCR-DMSO loop_loop (363, 16)
***** 398 NFE2L1::TBX15 MM
WM-SCR-DMSO pro_pro (40, 16)
WM-SCR-DMSO loop_loop (418, 16)
***** 399 HMGA1::STAT1 MM
COLO-SCR-DMSO pro_pro (58, 16)
COLO-SCR-DMSO loop_loop (170, 16)
WM-SCR-DMSO pro_pro (8, 16)
WM-SCR-DMSO loop_loop (206, 16)
***** 400 NFE2L1::SP4 MM
COLO-SCR-DMSO pro_pro (5, 16)
COLO-SCR-DMSO loop_loop (403, 16)
WM-SCR-DMSO pro_pro (18, 16)
WM-SCR-DMSO loop_loop (564, 16)
***** 401 SP4::STAT1 MM
COLO-SCR-DMSO pro_pro (32, 16)
COLO-SCR-DMSO loop_loop (295, 16)
WM-SCR-DMSO pro_pro (72, 16)
WM-SCR-DMSO loop_loop (599, 16)
***** 402 HMGA1::SOX10 MM
COLO-SCR-DMSO pro_pro (11, 16)
COLO-SCR-DMSO loop_loop (106, 16)
WM-SCR-DMSO pro_pro (20, 16)
WM-SCR-DMSO loop_loop (178, 16)
***** 403 NFAT5::SOX10 MM
COLO-SCR-DMSO pro_pro (13, 16)
COLO-SCR-DMSO loop_loop (151, 16)
WM-SCR-DMSO pro_pro (39, 16)
WM-SCR-DMSO loop_loop (280, 16)
***** 404 NFATC4::SOX10 MM
COLO-SCR-DMSO pro_pro (13, 16)
COLO-SCR-DMSO loop_loop (151, 16)
WM-SCR-DMSO pro_pro (39, 16)
WM-SCR-DMSO loop_loop (280, 16)
***** 405 ARID5B::LEF1 MM
COLO-SCR-DMSO pro_pro (38, 16)
COLO-SCR-DMSO loop_loop (205, 16)
WM-SCR-DMSO pro_pro (29, 16)
WM-SCR-DMSO loop_loop (282, 16)
***** 406 LEF1::SOX13 MM
COLO-SCR-DMSO pro_pro (37, 16)
COLO-SCR-DMSO loop_loop (219, 16)
WM-SCR-DMSO pro_pro (26, 16)
WM-SCR-DMSO loop_loop (312, 16)
***** 407 EGR4::NFE2L1 MM
WM-SCR-DMSO pro_pro (6, 16)
WM-SCR-DMSO loop_loop (200, 16)
***** 408 EN2::STAT1 MM
COLO-SCR-DMSO pro_pro (16, 16)
COLO-SCR-DMSO loop_loop (113, 16)
WM-SCR-DMSO pro_pro (4, 16)
WM-SCR-DMSO loop_loop (148, 16)
***** 409 STAT1::TBX15 MM
WM-SCR-DMSO pro_pro (50, 16)
WM-SCR-DMSO loop_loop (444, 16)
***** 410 HBP1::STAT1 MM
COLO-SCR-DMSO pro_pro (9, 16)
COLO-SCR-DMSO loop_loop (79, 16)
WM-SCR-DMSO pro_pro (9, 16)
WM-SCR-DMSO loop_loop (119, 16)
***** 411 EGR2::STAT1 MM
WM-SCR-DMSO pro_pro (34, 16)
WM-SCR-DMSO loop_loop (438, 16)
***** 412 EGR2::LEF1 MM
WM-SCR-DMSO loop_loop (241, 16)
***** 413 EGR2::SOX10 MM
WM-SCR-DMSO pro_pro (35, 16)
WM-SCR-DMSO loop_loop (338, 16)
***** 414 NFE2L1::NR3C1 MM
COLO-SCR-DMSO pro_pro (10, 16)
COLO-SCR-DMSO loop_loop (67, 16)
WM-SCR-DMSO loop_loop (95, 16)
***** 415 EN2::NFE2L1 MM
COLO-SCR-DMSO pro_pro (8, 16)
COLO-SCR-DMSO loop_loop (99, 16)
WM-SCR-DMSO pro_pro (10, 16)
WM-SCR-DMSO loop_loop (115, 16)
***** 416 LEF1::NFAT5 MM
COLO-SCR-DMSO pro_pro (15, 16)
COLO-SCR-DMSO loop_loop (122, 16)
WM-SCR-DMSO pro_pro (13, 16)
WM-SCR-DMSO loop_loop (206, 16)
***** 417 NFE2L1::ZBTB49 MM
COLO-SCR-DMSO pro_pro (8, 16)
COLO-SCR-DMSO loop_loop (99, 16)
WM-SCR-DMSO pro_pro (10, 16)
WM-SCR-DMSO loop_loop (115, 16)
***** 418 SOX10::SP4 MM
COLO-SCR-DMSO loop_loop (196, 16)
WM-SCR-DMSO pro_pro (47, 16)
WM-SCR-DMSO loop_loop (474, 16)
***** 419 HMGA1::LEF1 MM
COLO-SCR-DMSO pro_pro (19, 16)
COLO-SCR-DMSO loop_loop (95, 16)
WM-SCR-DMSO pro_pro (16, 16)
WM-SCR-DMSO loop_loop (127, 16)
***** 420 CEBPG::NR3C1 Colon
Colon pro_pro (9, 16)
Colon loop_loop (55, 16)
***** 421 MEIS2::MGA Colon
Colon pro_pro (3, 16)
Colon loop_loop (7, 16)
***** 422 NFE2L1::NFIA Colon
Colon pro_pro (143, 16)
Colon loop_loop (1146, 16)
***** 424 E2F6::PPARD Colon
Colon pro_pro (2, 16)
Colon loop_loop (118, 16)
***** 425 ATF1::NFE2L1 Colon
Colon pro_pro (6, 16)
Colon loop_loop (64, 16)
***** 426 POU2F1::PPARD Colon
Colon loop_loop (10, 16)
***** 427 BCL6::NFYC Colon
Colon loop_loop (13, 16)
***** 429 ZNF354A::MEIS2 Colon
Colon pro_pro (2, 16)
Colon loop_loop (15, 16)
***** 430 REL::SOX4 GDSD6
GDSD6 loop_loop (10, 16)
***** 431 OSR2::RELB GDSD6
GDSD6 loop_loop (8, 16)
***** 432 OVOL2::RUNX1 GDSD6
GDSD6 loop_loop (1, 16)
***** 433 REL::SP1 GDSD6
GDSD6 pro_pro (20, 16)
GDSD6 loop_loop (303, 16)
***** 435 RUNX1::VEZF1 GDSD6
GDSD6 pro_pro (60, 16)
GDSD6 loop_loop (238, 16)
***** 436 SOX4::ZBTB7A GDSD6
GDSD6 loop_loop (1, 16)
***** 437 SP1::XBP1 GDSD6
GDSD6 pro_pro (169, 16)
GDSD6 loop_loop (726, 16)
***** 438 NFKB1::NR1I3 Melanocytes
Melanocytes loop_loop (2, 16)
***** 439 NFKB1::RFX2 Melanocytes
Melanocytes pro_pro (6, 16)
Melanocytes loop_loop (11, 16)
***** 441 IRF2::KLF5 Melanocytes
Melanocytes pro_pro (13, 16)
Melanocytes loop_loop (31, 16)
***** 442 NFE2L2::NFKB1 Melanocytes
Melanocytes loop_loop (0, 16)
***** 443 IRF6::NFYB Melanocytes
***** 444 NFE2L2::RFX2 Melanocytes
Melanocytes loop_loop (0, 16)
***** 445 IRF6::KLF5 Melanocytes
***** 446 IRF2::IRF6 Melanocytes
***** 447 IRF2::NFYB Melanocytes
Melanocytes pro_pro (5, 16)
Melanocytes loop_loop (5, 16)
***** 448 KLF5::NFYB Melanocytes
Melanocytes pro_pro (58, 16)
Melanocytes loop_loop (104, 16)
***** 449 IRF7::E2F4 GM12878
GM12878 loop_loop (90, 16)
***** 450 MAZ::FOSL1 GM12878
***** 452 KLF6::FOSL1 GM12878
***** 453 MEF2D::FOXO3 GM12878
GM12878 loop_loop (10, 16)
***** 454 IRF7::SMARCA5 GM12878
GM12878 pro_pro (4, 16)
GM12878 loop_loop (23, 16)
***** 455 SMARCA5::E2F4 GM12878
GM12878 loop_loop (59, 16)
***** 456 E2F4::FOXO1 MM
COLO-SCR-DMSO loop_loop (4, 16)
WM-SCR-DMSO loop_loop (23, 16)
***** 457 E2F8::SMAD4 MM
COLO-SCR-DMSO pro_pro (2, 16)
COLO-SCR-DMSO loop_loop (5, 16)
WM-SCR-DMSO pro_pro (2, 16)
WM-SCR-DMSO loop_loop (9, 16)
***** 458 MAZ::E2F8 MM
COLO-SCR-DMSO pro_pro (16, 16)
COLO-SCR-DMSO loop_loop (159, 16)
WM-SCR-DMSO pro_pro (16, 16)
WM-SCR-DMSO loop_loop (527, 16)
***** 459 CUX1::FOXO1 MM
COLO-SCR-DMSO loop_loop (1, 16)
WM-SCR-DMSO loop_loop (1, 16)
***** 460 NFIC::ETV3 MM
COLO-SCR-DMSO loop_loop (8, 16)
WM-SCR-DMSO pro_pro (3, 16)
WM-SCR-DMSO loop_loop (30, 16)
***** 461 BPTF::ETS2 MM
COLO-SCR-DMSO loop_loop (21, 16)
WM-SCR-DMSO loop_loop (22, 16)
***** 462 CEBPZ::ETS2 MM
COLO-SCR-DMSO pro_pro (3, 16)
COLO-SCR-DMSO loop_loop (17, 16)
WM-SCR-DMSO loop_loop (28, 16)
***** 463 IRF3::CEBPZ MM
COLO-SCR-DMSO pro_pro (7, 16)
COLO-SCR-DMSO loop_loop (71, 16)
WM-SCR-DMSO pro_pro (7, 16)
WM-SCR-DMSO loop_loop (90, 16)
***** 464 CUX1::RFX2 MM
COLO-SCR-DMSO loop_loop (1, 16)
WM-SCR-DMSO loop_loop (0, 16)
***** 465 ETV3::HOXA9 MM
***** 466 E2F4::GATA3 MM
COLO-SCR-DMSO loop_loop (7, 16)
***** 467 MEF2D::GATA3 MM
COLO-SCR-DMSO pro_pro (4, 16)
COLO-SCR-DMSO loop_loop (11, 16)
***** 468 ZFX::E2F6 SCC
A431-CTRLi pro_pro (61, 16)
A431-CTRLi loop_loop (917, 16)
CAL27-CTRLi pro_pro (78, 16)
CAL27-CTRLi loop_loop (957, 16)
SCC13-CTRLi pro_pro (60, 16)
SCC13-CTRLi loop_loop (802, 16)
***** 469 E2F3::TP63 SCC
A431-CTRLi loop_loop (297, 16)
CAL27-CTRLi pro_pro (17, 16)
CAL27-CTRLi loop_loop (341, 16)
SCC13-CTRLi pro_pro (10, 16)
SCC13-CTRLi loop_loop (266, 16)
***** 470 IRX3::TP63 SCC
A431-CTRLi pro_pro (6, 16)
A431-CTRLi loop_loop (128, 16)
CAL27-CTRLi pro_pro (7, 16)
CAL27-CTRLi loop_loop (158, 16)
SCC13-CTRLi pro_pro (8, 16)
SCC13-CTRLi loop_loop (125, 16)
***** 471 NR4A1::TP63 SCC
A431-CTRLi pro_pro (3, 16)
A431-CTRLi loop_loop (116, 16)
CAL27-CTRLi pro_pro (3, 16)
CAL27-CTRLi loop_loop (119, 16)
SCC13-CTRLi pro_pro (6, 16)
SCC13-CTRLi loop_loop (105, 16)
***** 472 TP63::ZNF354A SCC
A431-CTRLi pro_pro (8, 16)
A431-CTRLi loop_loop (185, 16)
CAL27-CTRLi pro_pro (7, 16)
CAL27-CTRLi loop_loop (140, 16)
SCC13-CTRLi loop_loop (131, 16)
CPU times: user 10min 1s, sys: 19.9 s, total: 10min 20s
Wall time: 3min 46s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[950]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df = get_hits(pd.read_csv(&#39;../data/processed/fig4_modelling/tf_tf_pairs/expr_Colon_pro_pro_vocab_info.csv&#39;))</span>
<span class="c1"># df.vocab_pair.value_counts()[&#39;HOXA11::KLF5&#39;]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[951]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df2 = get_hits(pd.read_csv(&#39;../data/processed/fig4_modelling/tf_tf_pairs/expr_Colon_loop_loop_vocab_info.csv&#39;))</span>
<span class="c1"># df2.vocab_pair.value_counts()[&#39;HOXA11::KLF5&#39;]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[952]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df = pd.DataFrame()</span>
<span class="c1"># # loop through vocab words</span>
<span class="c1"># # for idx, row in overall_df_filt.iterrows():</span>
<span class="c1"># vocab = &#39;NFATC4::STAT1&#39;#row[&#39;vocab&#39;]</span>
<span class="c1"># tissue = &#39;MM&#39;#row[&#39;tissue&#39;]</span>
<span class="c1"># foot_tissues = tissue_to_celltype_mapper[tissue]</span>
<span class="c1"># print(&#39;*****&#39;, idx, vocab, tissue)</span>

<span class="c1"># # loop through the possible tissues that can use that vocab word</span>
<span class="c1"># for foot_tissue in foot_tissues:</span>
<span class="c1">#     foot_df = tissue_to_foot_df[foot_tissue]</span>
<span class="c1">#     tf_tf_loop_orient_dict =  check_tf_tf_loop_occur(vocab, foot_tissue ,geneset_dict[tissue])</span>
<span class="c1">#     print(tf_tf_loop_orient_dict)</span>
<span class="c1">#     # loop through two types of configurations (priority, pro-pro then loop-loop)</span>
<span class="c1">#     for type_loop in [&#39;pro_pro&#39;,&#39;loop_loop&#39;]:</span>
<span class="c1">#         if tf_tf_loop_orient_dict[type_loop+&#39;_count&#39;]&gt;0:</span>
<span class="c1">#             genes_loop_type = tf_tf_loop_orient_dict[type_loop+&#39;_genes&#39;].split(&#39;|&#39;)</span>
<span class="c1">#             foot_df_sel = foot_df[foot_df.TSS.isin(genes_loop_type)]</span>
<span class="c1">#             foot_df_sel[&#39;tf&#39;] = foot_df_sel.id_trim.map(tf_id_to_name_dict)</span>
<span class="c1">#             foot_df_sel = foot_df_sel[foot_df_sel.tf.isin(vocab.split(&#39;::&#39;))].drop_duplicates()</span>
<span class="c1">#             foot_df_sel[&#39;vocab&#39;] = vocab</span>
<span class="c1">#             foot_df_sel[&#39;genes&#39;] = tf_tf_loop_orient_dict[type_loop+&#39;_genes&#39;]</span>
<span class="c1">#             foot_df_sel[&#39;tissue&#39;] = tissue</span>
<span class="c1">#             foot_df_sel[&#39;foot_tissue&#39;] = foot_tissue</span>
<span class="c1">#             foot_df_sel[&#39;type_loop&#39;] = type_loop</span>
<span class="c1">#             print(foot_tissue, type_loop, foot_df_sel.shape)</span>
<span class="c1">#             df = pd.concat([df, foot_df_sel],axis=0,sort=False)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[953]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[954]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_instances_df = get_hits(vocab_tissue_df[vocab_tissue_df.tissue==&#39;Melanocytes&#39;])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[955]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_instances_df.vocab_pair.value_counts()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[956]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_instances_df[vocab_instances_df.vocab_pair==&#39;HOXA11::KLF5&#39;]#.shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[957]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_instances_df.vocab_pair.value_counts()[&#39;FOXM1::SP4&#39;]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[958]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_instances_df_filt = filter_results(vocab_instances_df,min_hits_per_vocab=10)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[959]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="k">for</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">vocab_tissue_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tissue</span><span class="p">,</span>  <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_tissue_df_&#39;</span><span class="o">+</span><span class="n">tissue</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Colon (60018, 16)
GDSD6 (31694, 16)
GM12878 (20945, 16)
Melanocytes (24377, 16)
SCC (434942, 16)
MM (28204, 16)
CPU times: user 1min 39s, sys: 3.38 s, total: 1min 43s
Wall time: 1min 43s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[960]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %%time</span>
<span class="c1"># print(vocab_tissue_df.shape)</span>
<span class="c1"># vocab_tissue_df.to_csv(os.path.join(save_dir, &#39;vocab_tissue_df.csv&#39;))</span>
<span class="c1"># vocab_tissue_df[:5]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3F-filter-vocab-for-10-genomic-instances-&lt;-135-bp-away-(-stringent-filter-&lt;-50-bp-away)">3F filter vocab for 10 genomic instances &lt; 135 bp away ( stringent filter &lt; 50 bp away)<a class="anchor-link" href="#3F-filter-vocab-for-10-genomic-instances-&lt;-135-bp-away-(-stringent-filter-&lt;-50-bp-away)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1014]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">vocab_instances_tissue_dict</span><span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">vocab_tissue_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;**********&#39;</span><span class="p">,</span> <span class="n">tissue</span><span class="p">)</span>
    <span class="n">vocab_instances_df</span> <span class="o">=</span> <span class="n">get_hits</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        
    <span class="n">motifs_in_tissue</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab1</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab2</span><span class="o">.</span><span class="n">unique</span><span class="p">())))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num motifs in tissue vocab&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">motifs_in_tissue</span><span class="p">))</span>
    
    <span class="n">vocab_instances_df</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="p">[[</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;tot_dist&#39;</span><span class="p">,</span><span class="s1">&#39;btn_dist&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">,</span>
     <span class="s1">&#39;vocab1&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1_start&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2&#39;</span><span class="p">,</span><span class="s1">&#39;vocab2_start&#39;</span><span class="p">,</span><span class="s1">&#39;vocab2_stop&#39;</span><span class="p">,</span>
     <span class="s1">&#39;tissue&#39;</span><span class="p">,</span><span class="s1">&#39;loop_type&#39;</span> <span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

    <span class="c1"># print(motifs_pro_pro)</span>
    <span class="c1">#filter expression enriched vocab words if then have at least 10 genomic instances then get stats</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pre genomic instance filter&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num vocab in expression enrichment: &#39;</span><span class="p">,</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">vocab_instances_df_filt</span> <span class="o">=</span> <span class="n">filter_results</span><span class="p">(</span><span class="n">vocab_instances_df</span><span class="p">,</span><span class="n">min_hits_per_vocab</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;post genomic instance filter&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num vocab in expression enrichment: &#39;</span><span class="p">,</span> <span class="n">vocab_instances_df_filt</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">vocab_instances_tissue_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances_df_filt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>********** Colon
(60018, 16)
num_hits 4515
num motifs in tissue vocab 52
pre genomic instance filter
num vocab in expression enrichment:  76
shape (4344, 14)
original num vocab 76
filt num vocab 42
post genomic instance filter
num vocab in expression enrichment:  42
********** GDSD6
(31694, 16)
num_hits 2918
num motifs in tissue vocab 60
pre genomic instance filter
num vocab in expression enrichment:  86
shape (2787, 14)
original num vocab 86
filt num vocab 49
post genomic instance filter
num vocab in expression enrichment:  49
********** GM12878
(20945, 16)
num_hits 1920
num motifs in tissue vocab 42
pre genomic instance filter
num vocab in expression enrichment:  60
shape (1789, 14)
original num vocab 60
filt num vocab 39
post genomic instance filter
num vocab in expression enrichment:  39
********** Melanocytes
(24377, 16)
num_hits 2524
num motifs in tissue vocab 47
pre genomic instance filter
num vocab in expression enrichment:  65
shape (2427, 14)
original num vocab 65
filt num vocab 26
post genomic instance filter
num vocab in expression enrichment:  26
********** SCC
(434942, 16)
num_hits 31445
num motifs in tissue vocab 34
pre genomic instance filter
num vocab in expression enrichment:  45
shape (14378, 14)
original num vocab 45
filt num vocab 43
post genomic instance filter
num vocab in expression enrichment:  43
********** MM
(28204, 16)
num_hits 2748
num motifs in tissue vocab 28
pre genomic instance filter
num vocab in expression enrichment:  46
shape (2082, 14)
original num vocab 46
filt num vocab 40
post genomic instance filter
num vocab in expression enrichment:  40
CPU times: user 3min 39s, sys: 236 ms, total: 3min 39s
Wall time: 3min 39s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1015]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_total_vocab</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">tissue</span> <span class="ow">in</span> <span class="n">tissue_to_celltype_mapper</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*****&#39;</span><span class="p">,</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances_df_filt_&#39;</span><span class="o">+</span><span class="n">tissue</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
    <span class="n">vocab_instances_df_filt</span> <span class="o">=</span> <span class="n">vocab_instances_tissue_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;num vocab in expression enrichment: &#39;</span><span class="p">,</span> <span class="n">vocab_instances_df_filt</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">num_total_vocab</span><span class="o">+=</span><span class="n">vocab_instances_df_filt</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances_df_filt</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="n">vocab_instances_df_filt</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances_df_filt_&#39;</span><span class="o">+</span><span class="n">tissue</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total number of vocab words&#39;</span><span class="p">,</span><span class="n">num_total_vocab</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>***** Colon ../data/processed/fig4_modelling/vocab_sum_final/vocab_instances_df_filt_Colon.csv
num vocab in expression enrichment:  42
[&#39;E2F7::THAP1&#39; &#39;KLF15::THAP1&#39; &#39;SP2::THAP1&#39; &#39;KLF15::OSR2&#39; &#39;MESP1::THAP1&#39;
 &#39;RARG::THAP1&#39; &#39;SOX13::THAP1&#39; &#39;THAP1::THRB&#39; &#39;NR2F1::THAP1&#39; &#39;BARX2::THAP1&#39;
 &#39;KLF15::KLF5&#39; &#39;KLF15::OTX1&#39; &#39;KLF5::RUNX3&#39; &#39;OTX1::THAP1&#39; &#39;SP4::THAP1&#39;
 &#39;SNAI2::THAP1&#39; &#39;FLI1::FOXM1&#39; &#39;FOXM1::PATZ1&#39; &#39;FOXM1::SP2&#39; &#39;KLF15::SNAI2&#39;
 &#39;KLF5::SOX13&#39; &#39;MAFB::THAP1&#39; &#39;OSR2::THAP1&#39; &#39;RARA::THAP1&#39; &#39;RORA::THAP1&#39;
 &#39;SNAI2::WT1&#39; &#39;NFE2L1::NFIA&#39; &#39;KLF15::MSX2&#39; &#39;KLF5::ZNF257&#39; &#39;KLF5::NR2F1&#39;
 &#39;BARX2::FOXF2&#39; &#39;BARX2::FOXM1&#39; &#39;FOXM1::KLF15&#39; &#39;FOXM1::SOX13&#39; &#39;FOXM1::SP4&#39;
 &#39;FOXM1::WT1&#39; &#39;KLF15::RFX2&#39; &#39;RFX2::THAP1&#39; &#39;KLF15::ZFP28&#39; &#39;KLF5::ZFP28&#39;
 &#39;MSX2::THAP1&#39; &#39;BATF::KLF15&#39;]
***** GDSD6 ../data/processed/fig4_modelling/vocab_sum_final/vocab_instances_df_filt_GDSD6.csv
num vocab in expression enrichment:  49
[&#39;KLF5::NFIC&#39; &#39;KLF5::UBP1&#39; &#39;NFIC::RORA&#39; &#39;RORA::UBP1&#39; &#39;ARID5B::KLF5&#39;
 &#39;EGR2::KLF4&#39; &#39;EGR2::KLF5&#39; &#39;HBP1::KLF5&#39; &#39;SP1::XBP1&#39; &#39;KLF4::SREBF2&#39;
 &#39;KLF5::SREBF2&#39; &#39;EGR2::RORA&#39; &#39;FOS::RORA&#39; &#39;JUN::RORA&#39; &#39;JUNB::RORA&#39;
 &#39;JUND::RORA&#39; &#39;KLF5::MAFG&#39; &#39;KLF5::MAFK&#39; &#39;MAFF::RORA&#39; &#39;MAFG::RORA&#39;
 &#39;RORA::TP63&#39; &#39;EGR2::RARG&#39; &#39;BACH1::KLF5&#39; &#39;HMGA1::KLF5&#39; &#39;EGR2::TP63&#39;
 &#39;STAT3::UBP1&#39; &#39;KLF5::NR3C1&#39; &#39;HBP1::RORA&#39; &#39;HMGA1::RORA&#39; &#39;PRDM1::RORA&#39;
 &#39;KLF4::SALL4&#39; &#39;EGR2::FOSL2&#39; &#39;EGR2::JUN&#39; &#39;EGR2::JUNB&#39; &#39;KLF5::TGIF1&#39;
 &#39;NFE2L1::RORA&#39; &#39;ASCL2::KLF5&#39; &#39;KLF4::TFE3&#39; &#39;ASCL2::KLF4&#39; &#39;EGR2::SNAI2&#39;
 &#39;FOSL2::SREBF2&#39; &#39;JUN::SREBF2&#39; &#39;NFIC::RARG&#39; &#39;SALL4::TP63&#39; &#39;MAF::RORA&#39;
 &#39;EGR3::KLF4&#39; &#39;ID4::TP63&#39; &#39;EGR3::TP63&#39; &#39;RORA::SMAD3&#39;]
***** GM12878 ../data/processed/fig4_modelling/vocab_sum_final/vocab_instances_df_filt_GM12878.csv
num vocab in expression enrichment:  39
[&#39;TCF3::ZNF589&#39; &#39;EGR1::IKZF1&#39; &#39;IKZF1::SP4&#39; &#39;IKZF1::ZNF589&#39; &#39;SP4::TCF3&#39;
 &#39;PAX5::ZNF589&#39; &#39;BATF::ZNF589&#39; &#39;IRF2::IRF4&#39; &#39;IRF4::ZBTB49&#39; &#39;ETV5::IRF8&#39;
 &#39;IKZF1::IRF3&#39; &#39;IRF8::UBP1&#39; &#39;IRF8::ZNF589&#39; &#39;IKZF1::IRF8&#39; &#39;IKZF1::ZNF563&#39;
 &#39;IRF4::IRF8&#39; &#39;IRF8::MYBL2&#39; &#39;ETS1::IRF4&#39; &#39;IRF8::SPIB&#39; &#39;IRF8::ZNF394&#39;
 &#39;IKZF1::MYBL2&#39; &#39;IRF4::SP4&#39; &#39;ETS1::IKZF1&#39; &#39;IRF4::PLAG1&#39; &#39;IRF4::ZNF816&#39;
 &#39;IKZF1::IRF4&#39; &#39;IKZF1::PAX5&#39; &#39;PAX5::SP4&#39; &#39;EBF1::SP4&#39; &#39;EBF1::ZNF816&#39;
 &#39;EGR1::IRF4&#39; &#39;HBP1::IRF8&#39; &#39;IRF8::STAT1&#39; &#39;IRF8::STAT2&#39; &#39;IRF8::ZNF816&#39;
 &#39;CBFB::IRF8&#39; &#39;IKZF1::IRF1&#39; &#39;IKZF1::IRF2&#39; &#39;IRF8::ZBTB49&#39;]
***** Melanocytes ../data/processed/fig4_modelling/vocab_sum_final/vocab_instances_df_filt_Melanocytes.csv
num vocab in expression enrichment:  26
[&#39;E2F4::KLF15&#39; &#39;KLF15::PRRX1&#39; &#39;KLF15::ZNF219&#39; &#39;KLF15::ZNF589&#39;
 &#39;SP2::ZNF324&#39; &#39;FOXL1::PRRX1&#39; &#39;ETV2::SP2&#39; &#39;ETV2::ZNF589&#39; &#39;ETV2::PRRX1&#39;
 &#39;NFATC1::PRRX1&#39; &#39;IRF4::PRRX1&#39; &#39;KLF15::SALL4&#39; &#39;PRRX1::RARA&#39; &#39;PRRX1::SALL4&#39;
 &#39;EN2::PRRX1&#39; &#39;PRRX1::TFAP2B&#39; &#39;PBX1::PRRX1&#39; &#39;MITF::ZNF589&#39; &#39;KLF15::TFAP2B&#39;
 &#39;SP2::TFAP2B&#39; &#39;TFAP2B::ZNF589&#39; &#39;MITF::PRRX1&#39; &#39;KLF5::NFYB&#39; &#39;FOXD3::PRRX1&#39;
 &#39;FOXD3::ZNF589&#39; &#39;PRRX1::SOX10&#39;]
***** SCC ../data/processed/fig4_modelling/vocab_sum_final/vocab_instances_df_filt_SCC.csv
num vocab in expression enrichment:  43
[&#39;EGR1::SP1&#39; &#39;KLF16::SP1&#39; &#39;KLF16::SP3&#39; &#39;KLF5::SP3&#39; &#39;KLF6::SP1&#39; &#39;MAZ::SP1&#39;
 &#39;PURA::SP1&#39; &#39;SP1::SP2&#39; &#39;SP1::SP3&#39; &#39;SP1::SP4&#39; &#39;SP1::TBX1&#39; &#39;SP1::TFAP2C&#39;
 &#39;SP1::VEZF1&#39; &#39;SP1::ZBTB17&#39; &#39;SP1::ZNF770&#39; &#39;SP3::TFAP2C&#39; &#39;SP3::ZBTB17&#39;
 &#39;ZFX::E2F6&#39; &#39;EGR1::SP3&#39; &#39;KLF16::TFAP2C&#39; &#39;KLF4::TFAP2C&#39; &#39;KLF5::TFAP2C&#39;
 &#39;TFAP2C::ZNF219&#39; &#39;NFAT5::SP1&#39; &#39;SNAI2::SP1&#39; &#39;E2F3::TP63&#39; &#39;IRX3::TP63&#39;
 &#39;ARNT::SP1&#39; &#39;SP1::ZBTB14&#39; &#39;TFAP2C::ZBTB14&#39; &#39;E2F1::SP1&#39; &#39;KLF4::KLF5&#39;
 &#39;KLF4::SP1&#39; &#39;KLF4::SP3&#39; &#39;KLF5::ZNF219&#39; &#39;NR2F1::SP1&#39; &#39;SP1::TFDP1&#39;
 &#39;SP1::ZNF219&#39; &#39;SP3::ZNF219&#39; &#39;E2F6::SP1&#39; &#39;SP1::TCF3&#39; &#39;ETS1::SP1&#39;
 &#39;NRF1::SP1&#39;]
***** MM ../data/processed/fig4_modelling/vocab_sum_final/vocab_instances_df_filt_MM.csv
num vocab in expression enrichment:  40
[&#39;NFE2L1::PRRX1&#39; &#39;NFE2L1::UBP1&#39; &#39;NFE2L1::SOX13&#39; &#39;STAT1::UBP1&#39;
 &#39;ARID5B::NFE2L1&#39; &#39;PRRX1::STAT1&#39; &#39;SOX13::STAT1&#39; &#39;NFAT5::NFE2L1&#39;
 &#39;NFATC4::NFE2L1&#39; &#39;HMGA1::NFE2L1&#39; &#39;EN2::NFE2L1&#39; &#39;NFE2L1::ZBTB49&#39;
 &#39;EGR2::NFE2L1&#39; &#39;NFE2L1::TBX15&#39; &#39;EGR4::NFE2L1&#39; &#39;ARID5B::STAT1&#39;
 &#39;NFAT5::STAT1&#39; &#39;NFATC4::STAT1&#39; &#39;NFE2L1::SP4&#39; &#39;SP4::STAT1&#39; &#39;EN2::STAT1&#39;
 &#39;STAT1::TBX15&#39; &#39;HBP1::STAT1&#39; &#39;EGR2::STAT1&#39; &#39;HMGA1::STAT1&#39; &#39;SOX10::UBP1&#39;
 &#39;SOX10::SOX13&#39; &#39;LEF1::PRRX1&#39; &#39;LEF1::UBP1&#39; &#39;NFAT5::SOX10&#39; &#39;NFATC4::SOX10&#39;
 &#39;LEF1::SOX13&#39; &#39;LEF1::NFAT5&#39; &#39;EGR2::SOX10&#39; &#39;SOX10::SP4&#39; &#39;ARID5B::SOX10&#39;
 &#39;HMGA1::SOX10&#39; &#39;ARID5B::LEF1&#39; &#39;HMGA1::LEF1&#39; &#39;NFE2L1::NR3C1&#39;]
total number of vocab words 239
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3G-get-the-20-shortest-distance-sequences-per-vocab-pair">3G get the 20 shortest distance sequences per vocab pair<a class="anchor-link" href="#3G-get-the-20-shortest-distance-sequences-per-vocab-pair">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1087]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_seq</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">MAX_DIST</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1087]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>135</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1088]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_padded_length</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="n">MAX_DIST</span><span class="p">):</span>
    <span class="c1"># get sequence [start_pad, stop_pad]</span>
    <span class="n">dist_to_add</span> <span class="o">=</span> <span class="n">max_dist</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;tot_dist&#39;</span><span class="p">]</span>
    <span class="n">dist_to_add_L</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dist_to_add</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> 
    <span class="n">dist_to_add_R</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dist_to_add</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dist_to_add</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">start_pad</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">dist_to_add_L</span>
    <span class="n">stop_pad</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;stop&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">dist_to_add_R</span>
    <span class="k">if</span> <span class="n">start_pad</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span>
<span class="c1">#     if (stop_pad- start_pad)!=max_dist:</span>
<span class="c1">#         raise</span>
    
    <span class="k">return</span> <span class="n">start_pad</span><span class="p">,</span> <span class="n">stop_pad</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1089]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_tissue_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">vocab_instances20_alltissue_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">tissue</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">vocab_instances_tissue_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">tissue</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">df_short</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;btn_dist&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">num_seq</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_short</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_short</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df_short</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_padded_length</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">index</span><span class="o">=</span><span class="n">df_short</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">])</span> <span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df_short</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instance20_df_filt_&#39;</span><span class="o">+</span><span class="n">tissue</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
    <span class="n">vocab_instances20_tissue_dict</span><span class="p">[</span><span class="n">tissue</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_short</span>
    <span class="n">df_short</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_df_filt_&#39;</span><span class="o">+</span><span class="n">tissue</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">))</span>
    <span class="n">vocab_instances20_alltissue_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vocab_instances20_alltissue_df</span><span class="p">,</span> <span class="n">df_short</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Colon (4171, 14)
(802, 16) ../data/processed/fig4_modelling/vocab_sum_final/vocab_instance20_df_filt_Colon.csv
GDSD6 (2544, 14)
(919, 16) ../data/processed/fig4_modelling/vocab_sum_final/vocab_instance20_df_filt_GDSD6.csv
GM12878 (1618, 14)
(715, 16) ../data/processed/fig4_modelling/vocab_sum_final/vocab_instance20_df_filt_GM12878.csv
Melanocytes (2264, 14)
(517, 16) ../data/processed/fig4_modelling/vocab_sum_final/vocab_instance20_df_filt_Melanocytes.csv
SCC (14364, 14)
(853, 16) ../data/processed/fig4_modelling/vocab_sum_final/vocab_instance20_df_filt_SCC.csv
MM (2051, 14)
(780, 16) ../data/processed/fig4_modelling/vocab_sum_final/vocab_instance20_df_filt_MM.csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1247]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span> <span class="s1">&#39;vocab_tissue_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;tissue&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
<span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab_pair</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span><span class="o">+</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">tissue</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span><span class="o">+</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab_tissue_count</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_alltissue_df.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(4586, 20)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1252]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_instances20_alltissue_df.iloc[4585,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="checking-some-stats-about-vocab_instances20_alltissue_df">checking some stats about <code>vocab_instances20_alltissue_df</code><a class="anchor-link" href="#checking-some-stats-about-vocab_instances20_alltissue_df">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1250]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1250]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>vocab1_stop</th>
      <th>vocab2</th>
      <th>vocab2_start</th>
      <th>vocab2_stop</th>
      <th>tissue</th>
      <th>loop_type</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>sequence</th>
      <th>check_rs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>BARX2::FOXF2</td>
      <td>28</td>
      <td>14</td>
      <td>chr1</td>
      <td>206848337</td>
      <td>206848365</td>
      <td>BARX2</td>
      <td>206848337</td>
      <td>206848341</td>
      <td>FOXF2</td>
      <td>206848355</td>
      <td>206848365</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>206848284</td>
      <td>206848418</td>
      <td>1</td>
      <td>BARX2::FOXF2+Colon+1</td>
      <td>CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>BARX2::FOXF2</td>
      <td>54</td>
      <td>40</td>
      <td>chr4</td>
      <td>38859601</td>
      <td>38859655</td>
      <td>FOXF2</td>
      <td>38859601</td>
      <td>38859611</td>
      <td>BARX2</td>
      <td>38859651</td>
      <td>38859655</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>38859561</td>
      <td>38859695</td>
      <td>2</td>
      <td>BARX2::FOXF2+Colon+2</td>
      <td>GTGGCTCTGAGGGAATTTCAAGTAACCGTGGACTAAAGTCTTAAGA...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>BARX2::FOXF2</td>
      <td>46</td>
      <td>32</td>
      <td>chr6</td>
      <td>74222776</td>
      <td>74222822</td>
      <td>FOXF2</td>
      <td>74222776</td>
      <td>74222786</td>
      <td>BARX2</td>
      <td>74222818</td>
      <td>74222822</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>74222732</td>
      <td>74222866</td>
      <td>3</td>
      <td>BARX2::FOXF2+Colon+3</td>
      <td>GCCACTGCACTCCAGCCTGGTGACAGAGCGAGACTCTGTCTCAAGA...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr3</td>
      <td>49384674</td>
      <td>49384690</td>
      <td>FOXF2</td>
      <td>49384674</td>
      <td>49384684</td>
      <td>BARX2</td>
      <td>49384686</td>
      <td>49384690</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>49384615</td>
      <td>49384749</td>
      <td>4</td>
      <td>BARX2::FOXF2+Colon+4</td>
      <td>AGTATTATGTGCTCATGGTCCCTACCCTCCAGGGTTCACAGTGTGG...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr10</td>
      <td>112247520</td>
      <td>112247536</td>
      <td>BARX2</td>
      <td>112247520</td>
      <td>112247524</td>
      <td>FOXF2</td>
      <td>112247526</td>
      <td>112247536</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>112247461</td>
      <td>112247595</td>
      <td>5</td>
      <td>BARX2::FOXF2+Colon+5</td>
      <td>ATGTGGCTGCGGGGCTTTAGGAGCTGACTCTTTGGTCACGGGGAGA...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1021]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1021]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>EGR1::SP3         20
KLF4::SP1         20
SP1::ZNF770       20
TFAP2C::ZNF219    20
ARNT::SP1         20
                  ..
HMGA1::LEF1       13
FOXM1::SP2        13
FLI1::FOXM1       13
CBFB::IRF8        12
MAF::RORA         12
Name: vocab_pair, Length: 239, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1022]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_btn_dist_stat</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;btn_dist&#39;</span><span class="p">:[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;median&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">],</span><span class="s1">&#39;tissue&#39;</span><span class="p">:</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">))[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">vocab_instances20_alltissue_df_btn_dist_stat</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;median&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">,</span><span class="s1">&#39;tissue&#39;</span><span class="p">]</span>
<span class="n">vocab_instances20_alltissue_df_btn_dist_stat</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1022]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>median</th>
      <th>std</th>
      <th>tissue</th>
    </tr>
    <tr>
      <th>vocab_pair</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>IKZF1::IRF2</td>
      <td>24</td>
      <td>108</td>
      <td>66.230769</td>
      <td>79.0</td>
      <td>30.199762</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>RORA::TP63</td>
      <td>11</td>
      <td>106</td>
      <td>64.687500</td>
      <td>72.0</td>
      <td>29.999375</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>IRF8::ZNF816</td>
      <td>2</td>
      <td>110</td>
      <td>64.375000</td>
      <td>70.5</td>
      <td>35.910769</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>IKZF1::IRF1</td>
      <td>27</td>
      <td>94</td>
      <td>66.357143</td>
      <td>69.5</td>
      <td>22.666842</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>EN2::NFE2L1</td>
      <td>1</td>
      <td>84</td>
      <td>54.550000</td>
      <td>66.0</td>
      <td>26.937501</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>NFE2L1::ZBTB49</td>
      <td>1</td>
      <td>84</td>
      <td>54.550000</td>
      <td>66.0</td>
      <td>26.937501</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>FOSL2::SREBF2</td>
      <td>11</td>
      <td>113</td>
      <td>64.473684</td>
      <td>66.0</td>
      <td>30.909129</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>ETS1::IKZF1</td>
      <td>21</td>
      <td>116</td>
      <td>60.650000</td>
      <td>65.0</td>
      <td>25.344521</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>KLF5::ZNF257</td>
      <td>1</td>
      <td>88</td>
      <td>52.850000</td>
      <td>63.5</td>
      <td>30.366663</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>JUN::SREBF2</td>
      <td>7</td>
      <td>113</td>
      <td>59.722222</td>
      <td>63.0</td>
      <td>33.643119</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>IRX3::TP63</td>
      <td>1</td>
      <td>106</td>
      <td>56.153846</td>
      <td>63.0</td>
      <td>40.147325</td>
      <td>SCC</td>
    </tr>
    <tr>
      <td>EGR2::STAT1</td>
      <td>5</td>
      <td>103</td>
      <td>58.350000</td>
      <td>61.5</td>
      <td>33.988040</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>EGR2::SOX10</td>
      <td>1</td>
      <td>109</td>
      <td>52.866667</td>
      <td>60.0</td>
      <td>32.793437</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>LEF1::NFAT5</td>
      <td>1</td>
      <td>117</td>
      <td>58.400000</td>
      <td>59.5</td>
      <td>35.405025</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>BACH1::KLF5</td>
      <td>4</td>
      <td>102</td>
      <td>50.200000</td>
      <td>59.0</td>
      <td>28.951190</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>NFIC::RARG</td>
      <td>3</td>
      <td>101</td>
      <td>53.857143</td>
      <td>56.5</td>
      <td>32.210503</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>IKZF1::IRF4</td>
      <td>4</td>
      <td>99</td>
      <td>55.350000</td>
      <td>56.5</td>
      <td>30.150980</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>KLF5::ZFP28</td>
      <td>5</td>
      <td>103</td>
      <td>60.705882</td>
      <td>56.0</td>
      <td>29.117788</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>IKZF1::IRF8</td>
      <td>17</td>
      <td>106</td>
      <td>57.733333</td>
      <td>56.0</td>
      <td>31.812995</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>EBF1::ZNF816</td>
      <td>1</td>
      <td>102</td>
      <td>53.466667</td>
      <td>55.0</td>
      <td>32.902164</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>IRF8::ZBTB49</td>
      <td>5</td>
      <td>110</td>
      <td>58.285714</td>
      <td>53.5</td>
      <td>38.433616</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>HBP1::RORA</td>
      <td>25</td>
      <td>108</td>
      <td>60.000000</td>
      <td>52.0</td>
      <td>28.049064</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>HMGA1::LEF1</td>
      <td>23</td>
      <td>86</td>
      <td>53.538462</td>
      <td>52.0</td>
      <td>20.783068</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>FOXM1::PATZ1</td>
      <td>1</td>
      <td>88</td>
      <td>49.650000</td>
      <td>52.0</td>
      <td>22.513797</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>RFX2::THAP1</td>
      <td>7</td>
      <td>95</td>
      <td>50.000000</td>
      <td>52.0</td>
      <td>33.819373</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>KLF4::TFE3</td>
      <td>1</td>
      <td>113</td>
      <td>48.529412</td>
      <td>51.0</td>
      <td>42.649909</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>SOX10::SP4</td>
      <td>8</td>
      <td>99</td>
      <td>48.333333</td>
      <td>51.0</td>
      <td>33.373785</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>EN2::STAT1</td>
      <td>4</td>
      <td>108</td>
      <td>50.850000</td>
      <td>50.0</td>
      <td>31.529894</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>FOXM1::KLF15</td>
      <td>1</td>
      <td>96</td>
      <td>48.571429</td>
      <td>48.5</td>
      <td>27.941462</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>STAT1::TBX15</td>
      <td>1</td>
      <td>95</td>
      <td>47.100000</td>
      <td>48.5</td>
      <td>31.560969</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>IRF8::STAT1</td>
      <td>4</td>
      <td>91</td>
      <td>50.100000</td>
      <td>48.5</td>
      <td>33.234256</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>FOXM1::SP4</td>
      <td>11</td>
      <td>107</td>
      <td>53.666667</td>
      <td>48.0</td>
      <td>29.834464</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>IKZF1::PAX5</td>
      <td>5</td>
      <td>106</td>
      <td>54.000000</td>
      <td>48.0</td>
      <td>37.307841</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>FOXM1::SP2</td>
      <td>7</td>
      <td>110</td>
      <td>49.000000</td>
      <td>47.0</td>
      <td>29.484459</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>ASCL2::KLF4</td>
      <td>9</td>
      <td>97</td>
      <td>45.000000</td>
      <td>46.5</td>
      <td>28.183609</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>RORA::SMAD3</td>
      <td>1</td>
      <td>113</td>
      <td>56.823529</td>
      <td>46.0</td>
      <td>35.560222</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>NFIC::RORA</td>
      <td>6</td>
      <td>92</td>
      <td>49.150000</td>
      <td>46.0</td>
      <td>28.897778</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>HMGA1::RORA</td>
      <td>4</td>
      <td>98</td>
      <td>44.500000</td>
      <td>45.5</td>
      <td>29.421618</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>FOS::RORA</td>
      <td>1</td>
      <td>116</td>
      <td>51.100000</td>
      <td>44.5</td>
      <td>36.898010</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>KLF5::MAFK</td>
      <td>9</td>
      <td>94</td>
      <td>53.529412</td>
      <td>44.0</td>
      <td>28.985164</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>FOXM1::WT1</td>
      <td>12</td>
      <td>113</td>
      <td>49.210526</td>
      <td>44.0</td>
      <td>28.481142</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>MSX2::THAP1</td>
      <td>9</td>
      <td>95</td>
      <td>47.466667</td>
      <td>43.0</td>
      <td>31.656339</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>KLF15::ZFP28</td>
      <td>3</td>
      <td>76</td>
      <td>40.600000</td>
      <td>42.5</td>
      <td>24.917548</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>JUN::RORA</td>
      <td>1</td>
      <td>115</td>
      <td>46.944444</td>
      <td>42.5</td>
      <td>35.659290</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>NFE2L1::RORA</td>
      <td>4</td>
      <td>86</td>
      <td>41.600000</td>
      <td>42.5</td>
      <td>27.350358</td>
      <td>GDSD6</td>
    </tr>
    <tr>
      <td>HMGA1::STAT1</td>
      <td>3</td>
      <td>67</td>
      <td>36.600000</td>
      <td>42.5</td>
      <td>22.276728</td>
      <td>MM</td>
    </tr>
    <tr>
      <td>OSR2::THAP1</td>
      <td>3</td>
      <td>89</td>
      <td>43.300000</td>
      <td>39.5</td>
      <td>26.870254</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>SNAI2::THAP1</td>
      <td>7</td>
      <td>62</td>
      <td>38.150000</td>
      <td>38.5</td>
      <td>18.316731</td>
      <td>Colon</td>
    </tr>
    <tr>
      <td>IRF8::SPIB</td>
      <td>1</td>
      <td>97</td>
      <td>42.812500</td>
      <td>38.5</td>
      <td>31.471085</td>
      <td>GM12878</td>
    </tr>
    <tr>
      <td>EGR2::SNAI2</td>
      <td>19</td>
      <td>70</td>
      <td>42.200000</td>
      <td>38.0</td>
      <td>15.381465</td>
      <td>GDSD6</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1024]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_btn_dist_stat</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1024]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    239.000000
mean      48.251046
std       39.637058
min        1.000000
25%       10.500000
50%       38.000000
75%       90.000000
max      117.000000
Name: max, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1025]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_btn_dist_stat</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1025]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fcfd1ae1190&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXYAAAD7CAYAAAB+B7/XAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3de3RU5b038O/ec81kJveZSSCAQiggEsCiRmqD2Bo0F8GWc0rpK21ZTWurZa2sLn2tspaXVmutlVWr7VFWjy5baPH0oDbt2xCrR9uaHCpUCVRALnLJhZlJJrfJ3Gfv949JxgRCZpLMZGb2fD9rZZGdeTLze9jwzZNnnv1sQZZlGUREpBhisgsgIqL4YrATESkMg52ISGEY7ERECsNgJyJSGAY7EZHCMNiJiBRGnewCAKC3dwiSNHPL6QsLjejpcc3Y6yWCEvoAsB+pRAl9AJTRj2h9EEUB+fnZl308JYJdkuQZDfaR10x3SugDwH6kEiX0AVBGP6bTB07FEBEpDIOdiEhhGOxERArDYCciUhgGOxGRwjDYiYgUhsFORKQwKbGOPVUFJcAXCE7YRqdRQ80fj0SUQhjsE/AFgnjvqG3CNtcusUKt418jEaUOjjWJiBSGwU5EpDAMdiIihWGwExEpDIOdiEhhGOxERAoTU7A3NjaiuroaVVVV2LVr1yWPP/vss1i7di3Wr1+P9evXj9uGiIhmRtQF2DabDTt27MDevXuh1WqxadMmXH/99SgrK4u0OXLkCJ5++mmsXLkyocUSEVF0UUfsLS0tqKioQF5eHgwGA9atW4empqYxbY4cOYLnn38edXV1ePTRR+Hz+RJWMBERTSxqsNvtdpjN5sixxWKBzfbJ1ZhDQ0NYsmQJ7r33Xrz66qsYGBjAL37xi8RUS0REUUWdipEkCYIgRI5lWR5znJ2djZ07d0aOt27digceeAANDQ0xF1FYaIy5bbyYzaaobWSnGyajfsI2BoMO5gJDvMqalFj6kA7Yj9ShhD4AyujHdPoQNdiLi4tx4MCByLHD4YDFYokcd3Z2oqWlBRs3bgQQDn61enJ7p/T0uGb05rNmswkOx2DUdm5fEIMu78Rt3D44QqF4lRazWPuQ6tiP1KGEPgDK6Ee0PoiiMOGAOOpUzOrVq9Ha2gqn0wmPx4Pm5mZUVlZGHtfr9fjJT36C8+fPQ5Zl7Nq1C7fccssku0FERPESNditVisaGhqwZcsWbNiwAbW1tSgvL0d9fT0OHz6MgoICPProo/j2t7+NW2+9FbIs4+tf//pM1E5EROMQZFmeuTmQy0jVqZghX2zb9mYnYdteJfy6CbAfqUQJfQCU0Y+ET8UQEVF6YbATESkMg52ISGEY7ERECsNgJyJSGAY7EZHCMNiJiBSGwU5EpDAMdiIihWGwExEpDIOdiEhhGOxERArDYCciUhgGOxGRwjDYiYgUhsFORKQwDHYiIoVhsBMRKQyDnYhIYRjsREQKw2AnIlIYBjsRkcIw2ImIFIbBTkSkMAx2IiKFYbATESkMg52ISGEY7ERECsNgJyJSGAY7EZHCxBTsjY2NqK6uRlVVFXbt2nXZdm+//TZuvvnmuBVHRESTp47WwGazYceOHdi7dy+0Wi02bdqE66+/HmVlZWPadXd348c//nHCCiUiothEHbG3tLSgoqICeXl5MBgMWLduHZqami5pt337dtxzzz0JKZKIiGIXNdjtdjvMZnPk2GKxwGazjWnz8ssv46qrrsLy5cvjXyEREU1K1KkYSZIgCELkWJblMccfffQRmpub8dJLL+HChQtTKqKw0Dil75sOs9kUtY3sdMNk1E/YxmDQwVxgiFdZkxJLH9IB+5E6lNAHQBn9mE4fogZ7cXExDhw4EDl2OBywWCyR46amJjgcDnzxi19EIBCA3W7H5s2bsXv37piL6OlxQZLkSZY+dWazCQ7HYNR2bl8Qgy7vxG3cPjhCoXiVFrNY+5Dq2I/UoYQ+AMroR7Q+iKIw4YA46lTM6tWr0draCqfTCY/Hg+bmZlRWVkYe37ZtG/bt24fXX38dL7zwAiwWy6RCnYiI4itqsFutVjQ0NGDLli3YsGEDamtrUV5ejvr6ehw+fHgmaiQiokmIOhUDAHV1dairqxvztZ07d17SrrS0FG+99VZ8KiMioinhladERArDYCciUhgGOxGRwjDYiYgUhsFORKQwDHYiIoVhsBMRKQyDnYhIYRjsREQKw2AnIlIYBjsRkcIw2ImIFIbBTkSkMAx2IiKFYbATESkMg52ISGEY7ERECsNgJyJSGAY7EZHCMNiJiBSGwU5EpDAMdiIihWGwExEpDIOdiEhhGOxERArDYCciUhgGOxGRwjDYiYgUhsFORKQwDHYiIoWJKdgbGxtRXV2Nqqoq7Nq165LH33jjDdTV1aGmpgb3338//H5/3AslIqLYRA12m82GHTt2YPfu3XjttdewZ88enDx5MvK42+3Go48+ihdffBF/+tOf4PP58Oqrrya0aCIiuryowd7S0oKKigrk5eXBYDBg3bp1aGpqijxuMBjw1ltvoaioCB6PBz09PcjJyUlo0UREdHlRg91ut8NsNkeOLRYLbDbbmDYajQbvvPMObrrpJvT29uLGG2+Mf6VERBQTdbQGkiRBEITIsSzLY45HrFmzBvv378fTTz+Nhx9+GD/96U9jLqKw0Bhz23gxm01R28hON0xG/YRtDAYdzAWGeJU1KbH0IR2wH6lDCX0AlNGP6fQharAXFxfjwIEDkWOHwwGLxRI57uvrw5EjRyKj9Lq6OjQ0NEyqiJ4eFyRJntT3TIfZbILDMRi1ndsXxKDLO3Ebtw+OUChepcUs1j6kOvYjdSihD4Ay+hGtD6IoTDggjjoVs3r1arS2tsLpdMLj8aC5uRmVlZWRx2VZxr333ovOzk4AQFNTE6655prJ9IGIiOIo6ojdarWioaEBW7ZsQSAQwMaNG1FeXo76+nps27YNy5Ytww9+8AN861vfgiAIKCsrwyOPPDITtRMR0TgEWZZnbg7kMlJ1KmbIF8R7R20Ttrl2iRXZuqg/H+NOCb9uAuxHKlFCHwBl9CPhUzGZyuZ04+U/H0Ofy5fsUoiIJmXmh5pp4s/7z+G9Y3aoRAGfXmTGorl5464GIiJKNQz2cfgDIbx3zI6r5xfAOeDDP47aEZJkLL2yINmlERFFxamYcXxwshseXxA3rZyNz316Ngpz9Th7Ib3n7IgoczDYx9Fy5ALyTTosLA1Pv8wuykZPvxc+/8yvVycimiwG+0X6h/w4ctqJG5YWQxTDc+qzirIhA+hyupNbHBFRDBjsF9n/rwuQZBmrry6OfK0oVw+NWkRn91ASKyMiig2D/SIHP3JgntWEWUXZka+JooCSQgM6u4eQAsv+iYgmxGAfRZZlnLe7UDY795LHZhVlw+0Non+INxEhotTGYB+lZ8ALrz+E2ebsSx4bGcFzOoaIUh2DfZQORzi0xwt2Y5YGOdlaBjsRpTwG+yjtDhcAYHbR+HswlBQaYO/1QOI8OxGlMAb7KB3dQyjI0cGgH/+C3MIcPYIhGYNDgRmujIgodgz2UdrtQ5cdrQNAfo4OANA7OPHNN4iIkonBPiwYknDBOYTScebXR+QZtRAEwDnIHR+JKHUx2IfZez0IhuRx3zgdoRJF5GZr0TvAYCei1MVgHzbyxmmpeeIbaxfk6DliJ6KUxmAf1uEYgiCEV75MpMCkg8cXhMcXnKHKiIgmh8E+rN3hgjXfAI1aNWG7T95A5aidiFITg31YR/fEb5yOyDcx2IkotTHYAfj8ITh6PZgdZX4dAPRaNQx6NZwDXPJIRKmJwQ7ggtMNGRizo+NE8k06jtiJKGUx2AF093sAAJa8rJjaF5h06B/yIxSSElkWEdGUMNgBOPrC0ypFefqY2hfk6CHLQJ+LW/gSUephsANw9Htg0KmRrdfE1H7kDVSuZyeiVMRgB9Dd5415tA4ARoMGKlFAv4vBTkSph8GO8By7OTe2+XUAEAUBuUYt30AlopSU8cEuyTIcfV6YY3zjdESeUcc5diJKSRkf7P0uP4IhaVJTMQCQN7y1gNvLvdmJKLVkfLCPLHUsmsRUDADkG7UAgK4ed9xrIiKajowPdkdfONjNkx2xG8MrY7p4D1QiSjExBXtjYyOqq6tRVVWFXbt2XfL4X/7yF6xfvx633347vvOd76C/vz/uhSZK98ga9tzJBbtBr4ZGLaKTI3YiSjFRg91ms2HHjh3YvXs3XnvtNezZswcnT56MPO5yufDwww/jhRdewB/+8AcsWrQIP//5zxNadDw5+j3IM2qj7up4MUEQkGfUoquHI3YiSi1Rg72lpQUVFRXIy8uDwWDAunXr0NTUFHk8EAjgoYcegtVqBQAsWrQIXV1dias4zsJr2Cc3vz4iz6hDV/cQZFmOc1VERFOnjtbAbrfDbDZHji0WC9ra2iLH+fn5uOWWWwAAXq8XL7zwAu68885JFVFYGH1XxXgzm00AgJ5BH5YtKIwcjyY73TAZLz9FU1yUjRPt/dDotcjPmdxUTjyMV3M6Yj9ShxL6ACijH9PpQ9RglyQJgiBEjmVZHnM8YnBwEHfffTcWL16MO+64Y1JF9PS4IEkzN+o1m01wOAYRDEno6fPApFfD4Ri8pJ3bF8Sg6/Lb82ZpwtM3h47bsPSKgoTVO56RPqQ79iN1KKEPgDL6Ea0PoihMOCCOOhVTXFwMh8MROXY4HLBYLGPa2O12bN68GYsWLcJjjz0WS90poWfACxmTX+o4Ind4yWOHg/PsRJQ6ogb76tWr0draCqfTCY/Hg+bmZlRWVkYeD4VCuOuuu3DbbbfhwQcfHHc0n6pGVsRMdqnjiCydGsYsDTqGb4RNRJQKok7FWK1WNDQ0YMuWLQgEAti4cSPKy8tRX1+Pbdu24cKFC/jwww8RCoWwb98+AMDVV1+dFiP3T9awT23EDoRvznHezmAnotQRNdgBoK6uDnV1dWO+tnPnTgDAsmXLcOzYsfhXNgMc/R6oRCFysdFUlFqM+OsHnQiGJKhVGX+9FxGlgIxOop5+Lwpz9BDFqU8flZqzEQxJuMALlYgoRTDYJ3nF6cVKLeF3ps/a0vtdeCJSjowO9u6B6Qe7Nd8ArVrEORvn2YkoNWRssAeCIfS7/Cia5oVFoiig1GLEOY7YiShFZGywOwfCdz+a7ogdAOZZTThnd3FrASJKCRkb7N39U9vVcTxzrUZ4fEE4+i9/lSoR0UzJ2GDvGQiHcGEc9niZaw3v6XDuAqdjiCj5MjbYu/u9EAUB+TlTX8M+otScDVEQuDKGiFJCxgZ7T78H+SYtVOL0/wo0ahVmFRm4MoaIUkIGB7s3LtMwI+ZaTVwZQ0QpIXODfcCLwinu6jieuVYT+of86B30xe05iYimIiODPRiS4Bz0xWWp44iFpbkAgBPtfXF7TiKiqcjIYO/p90KW47PUccRcqxF6rQrHzzHYiSi5MjLY7c7whl3xHLGrRBELS/Nw7Fxv3J6TiGgqMjPYe8PBPt3tBC62aG4eunrcGBjyx/V5iYgmI0ODPXyDjYJ4B/ucPADAR+c5HUNEyZOZwe50I9eohUYd3+7PKzZBp1FxOoaIkiozg73XHfdpGABQq0SUlebiOEfsRJREGRvs8XzjdLTFc/PQ4RjCoJvz7ESUHBkX7JIko7vPk7BgXzQnHwDn2YkoeTIu2J0DXgRDMix58bvqdLQrSkzQaVU4dKonIc9PRBRNxgW7vS+8IiZRwa5WiVj1KTMOHrcjEAwl5DWIiCaSscFuzk9MsANAxdXF8PhC+OAkR+1ENPMyLtgdvR6oVQIKTImZYweAJXPzkWfUovXIhYS9BhHR5WRcsNv7PLAWGCCKQsJeQxQFVCwtxuHTPVwdQ0QzLuOC3dHrQXFhdsJf54alxQhJMv5x1J7w1yIiGi2jgl2WZTj6PSiZgWCfYzGi1GzEu4e7IMtywl+PiGhERgW7yxOAxxdCcVHigx0Abr5mNs5cGMTB444ZeT0iIgBQJ7uAmTSyIiaeI3ZBFDDkC4772KcXW/DmP9vx2zdPYMmVhcjWqSZ8rqAE+ALjP9doOk1GnTYimqSMSgjH8K6OxYWGuD2nLxDCoY8uPyK/+soC7PvHefyp5WP8+9qyKM8VxHtHbVFf89ol1knXSUSZI6apmMbGRlRXV6Oqqgq7du26bLv77rsPe/fujVtx8TYyYrfOwBz7CGuBAVeUmPCXA+fR0T00Y69LRJkrarDbbDbs2LEDu3fvxmuvvYY9e/bg5MmTl7S56667sG/fvoQVGg+OXg/yTTroNBNPicTbqkVmZOnUeOq376OT4U5ECRY12FtaWlBRUYG8vDwYDAasW7cOTU1NY9o0Njbic5/7HG677baEFRoP9j4PzAnaSmAiBr0G2zYuhwzgyd++j3aHa8ZrIKLMEXWO3W63w2w2R44tFgva2trGtPnGN74BADh48OCUiigsNE7p+yarZ8CLaxaF56fNZlPU9rLTDZNx4itUNRp11DYAMH9OPp64+0Zs/4938cOXD+L/3LoYt1cugGrUhVKxvB4AGAw6ALH1IR2wH6lDCX0AlNGP6fQharBLkgRBGBU+sjzmOB56elyQpMSu9fYFQnAO+GDKCnfZ4RiM+j1uXxCDLu+EbQKB6G0AwO32IVunxoN3rsKv9x3Hfzb+C/9z4By+ftsSlFqMMb/eyHOhwBBTH1Kd2WxiP1KEEvoAKKMf0fogisKEA+KoUzHFxcVwOD5Z9eFwOGCxWCZZZvI5EryrY6zyTTp894vLcNf6peju9+KRl97Da387jUBQSmpdRKQcUYN99erVaG1thdPphMfjQXNzMyorK2eitrgaWepoSeCujrESBAHXLbHih9+4HtctseAP757BT377PveVIaK4iBrsVqsVDQ0N2LJlCzZs2IDa2lqUl5ejvr4ehw8fnoka46KzJ7wapbggfmvYJ2PkQqbRH6JKxOaqRfh69RKctQ3iqd3vo3fQl5T6iEg5YrpAqa6uDnV1dWO+tnPnzkvaPfHEE/GpKgE6HEMozNEhS5eca7KiXch0y7Vz8Pe2Luzbfw63VsxFnlE3g9URkZJkzF4x7Q4XZptnZvXNVBTl6nHPxnKoVALePNAOtzf61gJEROPJiGAPhiR09bgx2zxzV5xORWGuHjdfUwpfIIQ3D7bzDVUimpKMCHab042QJKM0hUfsIwpz9bhp5Wz0Dfqw/8Po+8YQEV0sI4J9ZI+W2TO0Xe90zSrKxvKyQpzuHMCpjv5kl0NEaSYjgr3d4YIoCDNyg414uXpBIaz5Wdj/oQ0DQ1wGSUSxy4hg73AMwVqQBY06fborCgJuXF4CURTwt0NdCb8yl4iUI32SbhraHa60mF+/WLZegxuWFqNnwIvDp3uSXQ4RpQnFB7vPH4Kjz5vyK2IuZ16xCVeWmNB2qgc9/dH3kSEiUnywj7xxmo4j9hHXXWWFXqvG3w93IRTiEkgimpjyg3147/N0HbEDgE6jwuqri9Hv8uP9E93JLoeIUpzig73dMQStWkzKDTbiabY5G5+ak4cPz/TiZHtfssshohSm+GA/bx/ErKJsiHHeQz4ZPr3IDJNBg1/vOw63N5DscogoRSk62IMhCac7B1A2OzfZpcSFRi3iM8uK0Tvow7P/dQiyzCWQRHQpRQf7x10D8AclLJqbn+xS4saSb0DdZ67E3z7owP/737PJLoeIUlBy9rCdIcfOheeiF83NS3Il8fX5VaXoG/Jj7zunMbvIiBULi5JdEhGlEEWP2I+f60Wp2QhjlibZpcSVIAj47r+vwNxiE/7j9SM4wouXiGgUxQZ7MCThZHs/Fs9T1mh9hF6rRsO/LUdxgQE/+30bDhyzJ7skIkoRig32053h+fXFCppfv1hOthb3bV6JK0ty8MvXj2DvX09xD3ciUm6wHz/XCwHAp+Yoc8Q+wqDX4HtfWoEblhbjjy1n8chL7+FfHzu5YoYogyn2zdNj5/pQalHe/Pp4dFoVvlF7Fa5bYsXL+47hp3s+QEmhAWuWz8LS+YWYVWiAoIB1/EQUG0UGezAk4VRHPypXzEp2KQkhiALsTjfcvrH3RV1QmovtX70W73/kwN8OdeJ3b50E3jqJHIMGV5TkYI7FGPmw5hsgigKCEuALRL+/qk6jRhrtekyU0RQZ7G2neuAPSlh6RUGyS0kIXyCEo2ftGHSNv9ujIACVK2bha6W5+OhsH0629+G83YUjHzsj+7pr1CJKCrMx25wNAeG7Nhn0l//ncO0SK9Q6Rf5zIVIcRf5Pffv9DuSbdLh6vjKDPVYmgxZqlYDF8/KxeF4+QpKEPpcffYM+OAd86B304dDJbri94RF7QY4OV5bk4MqSnAlDnohSm+L+99r7PPjXx07UfeYKqETOHYymEkUU5uhRmKPHgtnhr5UvLMLbB9vR0T2EczYXDh534J/HHSgpMmD+rFzMsRjT6s5TRKTAYP/rB52AAFQuV+b8erwJgoCCHD0KcvRYNr8Q/S4fTncO4HTnAP7e1gW1SsC8YhNysrVYsaAIosg3YYlSnaKCPRiS8Pe2TqwoK0JBjj7Z5aSlXKMOKz9lxoqFRbD1enC6cwBnuwbx7H8fhsmgwYqyIpQvKMKiuXkZseKIKB0pKtgPHndgwB3ATStnJ7uUtCcIAooLDCguMOC6JRboNGp8eMaJA8ft+FtbFwBgdlE25lqNmGMxYY41vNomx6BNcuVEpJhgH3T78bu3TmBWUTaWXpnZb5rGm1ol4ppFZny2vATBkISPuwZw7GwvTnYM4OjZXrT+yxZpm5OtxaxCA0qKslFSmI2SIgNKCrKh06oibbh0kiixFBHssizjP/90FEOeABr+bbkibqqRagRRwNDwuvlZZiNmmY24eVX4sUG3Hx2OIbQ7hnDkVDccfR6caO9HSPrk6ldjlgZ5Ri3yTDpc8ykzZhVmI9eohc6gg8cXhCgI8PqDcPuCcHuDGPQEMeD2YcgbhNsTCP/pDcA/vGWCIAgw6FQwZmmRk62FOU8Pa4EB+SbdJRdj8QcJZRpFBPtfDrTj0KkebP78Qsy1mpJdjiL5AiEc+sgxYZvKlbOQmx2ed5dkGS53AH0uX2SJZZ/Lh47uIRw57Zz062tUIrQaEWqVCAiALAP+QAiBoDTmB0iWTg1Lnh7m/CxY8rKQn6NHxdJirsGnjBLTv/bGxkb88pe/RDAYxFe/+lV85StfGfP40aNH8eCDD2JoaAirVq3CI488ArU68f+RfIEQfv8/p/DmP9uxoqwIn/t0acJfk2IjCgJyssOj6bnWT74ekmTMs5rg9QfR7/JD1KjQ3++FLMvQ69TI0qlg0GkgigJOdvRBp1FBp1FddjVO+cIi/O/hCxh0+9E76IOjzwNHnxdnbeGbmKtVAg4es2PplQVYPDcfV5SYuAyWFC9q+tpsNuzYsQN79+6FVqvFpk2bcP3116OsrCzS5t5778UPf/hDrFixAg888ABeeeUVbN68OaGFuzwBPPbrg7A53fj8qlJsXLOA+6GkAZUooKQoG9nDI2iz2QSHY/CSdkO+ILr7PVGfTxAEGPRqGPRqWAsMWDwvvJun2xuEo88Dm9ON/iE//vud0wDC++rML8nBFcUmzCs2objAAGuBATqNaqKXiTtJkuH1h+DxBeHxB+HxBeEPSpAlGZIcnl6UZBkCBAgCIIrDfwoCBEGAKIT7PvJ1WQr/liRJ4e+LfD7q60D4eURBgCiO+nz4eXqGAujv90DGyPeOPF/4B/InzylDBiBgpAZEahqpTxiuLxSS4AuEhj8k+PwheP1BeEf96fGN/jz8pz8Ygixj+CNcuyTLwPAvZxqNCK1aBZ1GhFajGvN5rkkPETKydGoYdGpkjfrQqEWoxOFaRSEyYBjZM0+WZUReRg73U0a4X1k6FbK06vAARKuCRi2mbOZEDfaWlhZUVFQgLy+8S+K6devQ1NSEe+65BwDQ0dEBr9eLFStWAAC+8IUv4JlnnplUsE9lbXRIkrCwNBf1tUtQVjr5HRxjeU21SoRBP/GSvljaJOK5snRqhILTf76k1K9RwTc8V97d54l8PpooTq8ug16DorwsLLmiAMvLihAavv/tqc5+nLe58MHJbhwcNbWUpVUj26BBdpYGRn04EDRqESqVCLUoQqUK/5sZCZpP/vOHv1+n18Dj9kMGEAxK8AXDQRYIhuAPfPK5LyDB6wvCFwhF7ZuSaTUqaDXhMNZpVCjM1UOjUUGnVkGnFaFRqxDOzOEfEgh/qFQiQpKMUEiCPxhCICgjEAz/3QZCEgIBCYNuH9ze4R8QCfx7VolC5DdKrVYFrVqEVi2G+6EJB79OrYr8oAxJMmRZhi8oo9/lw+CQH+sr5+OqeeNvLT5RRkXLr6jBbrfbYTabI8cWiwVtbW2XfdxsNsNms2Ey8vOzJ9UeAAoLjfi/V0z9lnCFhcaY2pWWRL8R9vzS2PZ8j6VdPJ8rGa8Z63ONkZc17pfnzortJuSxvua80nysjbkoouSKNaPGE3WyUZKkMb9uyLI85jja40RENLOiBntxcTEcjk9+ZXU4HLBYLJd9vLu7e8zjREQ0s6IG++rVq9Ha2gqn0wmPx4Pm5mZUVlZGHp89ezZ0Oh0OHjwIAHj99dfHPE5ERDNLkGO4h1pjYyOef/55BAIBbNy4EfX19aivr8e2bduwbNkyHDt2DNu3b4fL5cLSpUvxox/9CFotLy0nIkqGmIKdiIjSB6/UICJSGAY7EZHCMNiJiBSGwU5EpDAZFeyNjY2orq5GVVUVdu3alexypuzOO+9ETU0N1q9fj/Xr1+PQoUPJLilmLpcLtbW1aG9vBxDesqKurg5VVVXYsWNHkquL3cX9+P73v4+qqqrIOXnjjTeSXOHEnn32WdTU1KCmpgZPPvkkgPQ8F+P1I93Oxc9+9jNUV1ejpqYGL774IoA4nAs5Q1y4cEFeu3at3NvbKw8NDcl1dXXyiRMnkl3WpEmSJN94441yIBBIdimT9sEHH8i1tbXy0qVL5fPnz8sej0des2aNfO7cOTkQCMhbt26V33777WSXGdXF/ZBlWa6trZVtNluSK4vNu+++K3/pS1+SfT6f7Pf75S1btsiNjY1pdy7G60dzcz367RsAAANBSURBVHNanYv9+/fLmzZtkgOBgOzxeOS1a9fKR48enfa5yJgR++jNzAwGQ2Qzs3Rz+nR4l8KtW7fi9ttvx29+85skVxS7V155BQ899FDkyuS2tjbMmzcPc+bMgVqtRl1dXVqck4v74fF40NnZiQceeAB1dXV45plnIEmXbmyWKsxmM+6//35otVpoNBosWLAAZ86cSbtzMV4/Ojs70+pcXHfddXj55ZehVqvR09ODUCiEgYGBaZ+LjAn28TYzm+xmZalgYGAAN9xwA5577jm89NJL+N3vfod333032WXF5LHHHsOqVasix+l6Ti7uR3d3NyoqKvD444/jlVdewYEDB/D73/8+iRVObOHChZHdWM+cOYM///nPEAQh7c7FeP347Gc/m1bnAgA0Gg2eeeYZ1NTU4IYbbojL/4uMCXalbFa2cuVKPPnkkzCZTCgoKMDGjRvxzjvvJLusKVHKOZkzZw6ee+45WCwWZGVl4c4770yLc3LixAls3boV9913H+bMmZO252J0P+bPn5+W52Lbtm1obW1FV1cXzpw5M+1zkTHBHm0zs3Rx4MABtLa2Ro5lWZ6Ru1UlglLOyfHjx7Fv377IcTqck4MHD+JrX/savve97+GOO+5I23NxcT/S7VycOnUKR48eBQBkZWWhqqoK+/fvn/a5yJhgj7aZWboYHBzEk08+CZ/PB5fLhVdffRW33HJLssuakuXLl+Pjjz/G2bNnEQqF8Mc//jEtz4ksy3j88cfR39+PQCCAPXv2pPQ56erqwt13342nnnoKNTU1ANLzXIzXj3Q7F+3t7di+fTv8fj/8fj/efPNNbNq0adrnInV/lMWZ1WpFQ0MDtmzZEtnMrLy8PNllTdratWtx6NAhbNiwAZIkYfPmzVi5cmWyy5oSnU6HJ554At/97nfh8/mwZs0a3Hrrrckua9IWL16Mb37zm/jyl7+MYDCIqqoq1NbWJrusy/rVr34Fn8+HJ554IvK1TZs2pd25uFw/0ulcrFmzBm1tbdiwYQNUKhWqqqpQU1ODgoKCaZ0LbgJGRKQwGTMVQ0SUKRjsREQKw2AnIlIYBjsRkcIw2ImIFIbBTkSkMAx2IiKFYbATESnM/wdtrx7cV6VyzgAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1026]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_btn_dist_stat</span><span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1026]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fcfd1a911d0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYIAAAD7CAYAAABnoJM0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8QZhcZAAAgAElEQVR4nO3de1hU57n4/e8MMxwGhvMMKAoe8BQUicFITApJtgUVCQk/sxtjQn7Nrsa8u9WL9y17a0ztL6m5rNmkutukXkl2dvo2r261SQqlVTQxMYnBRiEaQdGIZwGH4aByZoZZ7x82kxDFAR1gDvfnurxkzbPWM8/NGuZe61lrPY9KURQFIYQQXks93A0QQggxvCQRCCGEl5NEIIQQXk4SgRBCeDlJBEII4eUkEQghhJeTRCCEEF5OM9wNuBXNzW3YbAN7/CEiIojGxtZBatHQ8qRYwLPikVhckyfFAgOPR61WERYW2Ge5WyYCm00ZcCL4ZjtP4UmxgGfFI7G4Jk+KBZwbj3QNCSGEl5NEIIQQXk4SgRBCeDlJBEII4eUkEQghhJeTRCCEEF5OEoEQQng5t3yOQHzLaoMui9Xp9fppNWjkMEEIryCJwM11WawcrDI5vd6ZU6LQ+MnHQwhv0K9jvuLiYubPn096ejqbN2++rryqqoqcnBwyMjJYvXo1VmvvI9Rjx44xdepU+3J3dzf5+fnMmzePRx55hFOnTt1mGEIIIW6Vw0RgMpnYsGEDW7ZsobCwkG3btlFdXd1rnfz8fNasWcOuXbtQFIXt27fbyzo6OvjVr36FxWKxv/bOO+8QEBDAzp07ee6551i1apUTQxJCCDEQDhNBaWkpKSkphIaGotPpyMjIoKSkxF5eU1NDZ2cnSUlJAOTk5PQq//Wvf81TTz3Vq869e/fy0EMPATBz5kyampqora11SkBCCCEGxmEncH19PQaDwb5sNBo5cuRIn+UGgwGT6Vqf9Z49e+js7GTu3Lk3rdNgMHDp0iVGjhzZr0ZHRAT1a73vMxj0t7SdK/omFqWpHX2Qv9Pr1+n8MITrnF5vXzxx33gCicV1OTMeh4nAZrOhUqnsy4qi9Fruq9xsNrNp0yb+8Ic/XFfn9+tQFAW1uv+3qDQ2tg545D2DQY/Z3DKgbVzVd2Np77LS0trp9Pdob+/C3NPj9HpvxFP3jbuTWFzXQONRq1U3PYB2+O0bHR2N2Wy2L5vNZoxGY5/lDQ0NGI1G9u7dy+XLl1m8eDHZ2dkAZGdn09raSlRUFPX19ddtI4QQYug5TASzZ89m//79NDU10dHRwe7du0lNTbWXx8TE4OfnR3l5OQBFRUWkpqby6KOP8uGHH1JUVERRUZG9LCgoiLS0NPtrZWVl+Pn59btbSAghhHM5TARRUVHk5eWRm5vLww8/zIIFC0hMTGTJkiVUVFQAUFBQwLp165g7dy7t7e3k5ubetM4nn3yS7u5uMjMzeemll3j55ZedE40QQogBUymK4nbT9sg1gm9jaesavAfKAofogTJP3TfuTmJxXUN+jUAIIYRnk0QghBBeThKBEEJ4OUkEQgjh5SQRCCGEl5NEIIQQXk4SgRBCeDlJBEII4eUkEQghhJeTRCCEEF5OEoEQQng5SQRCCOHlJBEIIYSXk0QghBBeThKBEEJ4OUkEQgjh5fqVCIqLi5k/fz7p6els3rz5uvKqqipycnLIyMhg9erVWK1W4No0lDk5OWRlZbFs2TKuXLkCwIEDB5g1axbZ2dlkZ2ezatUqJ4YkhBBiIBwmApPJxIYNG9iyZQuFhYVs27aN6urqXuvk5+ezZs0adu3ahaIobN++HYBVq1bx8ssvU1xcTHx8PG+99RYAlZWVPP300/b5jNetWzcIoQkhhOgPh4mgtLSUlJQUQkND0el0ZGRkUFJSYi+vqamhs7OTpKQkAHJycuzlO3bsID4+HovFgslkIjg4GICKigr27dtnP1Ooq6sbjNiEEEL0g8NEUF9fj8FgsC8bjUZMJlOf5QaDwV6u1Wo5ceIEaWlpfPHFF2RmZgKg1+t58sknKS4uJi0tjby8PKcFJIQQYmAczk5us9lQqVT2ZUVRei07Kp80aRKlpaVs3bqVvLw8tm7dyosvvmgvX7RoEa+88gotLS3o9fp+NfpmkzDfjMHQv/rdwTexKE3t6IP8nV6/TueHIVzn9Hr74on7xhNILK7LmfE4TATR0dGUlZXZl81mM0ajsVe52Wy2Lzc0NGA0Gunq6uKzzz5jzpw5ADz00EOsX78em83G66+/ztKlS/Hx8bFv992fHWlsbMVmU/q9Plz7pZnNLQPaxlV9N5b2ListrZ1Of4/29i7MPT1Or/dGPHXfuDuJxXUNNB61WnXTA2iHXUOzZ89m//79NDU10dHRwe7du0lNTbWXx8TE4OfnR3l5OQBFRUWkpqai0Wh44YUXqKysBGDnzp3MmDEDtVrNBx98wK5duwAoLCxk+vTp6HRDd/QphBDiWw7PCKKiosjLyyM3NxeLxcLChQtJTExkyZIlLF++nGnTplFQUMDzzz9Pa2srCQkJ5Obm4uPjw4YNG1izZg09PT1ERUXx0ksvAbB+/Xp+8Ytf8NprrxEeHs7LL7886IEKIYS4MZWiKAPrY3EB0jX0bSxtXVYOVpkcbDFwM6dEEejn8DjBKTx137g7icV1DXnXkBBCCM8miUAIIbycJAIhhPBykgiEEMLLSSIQQggvJ4lACCG8nCQCIYTwcpIIhBDCy0kiEEIILyeJQAghvJwkAiGE8HKSCIQQwstJIhBCCC8niUAIIbycJAIhhPBykgiEEMLL9SsRFBcXM3/+fNLT09m8efN15VVVVeTk5JCRkcHq1auxWq0AlJWVkZOTQ1ZWFsuWLePKlSsAXL16laVLlzJv3jwWL17ca85jIYQQQ8thIjCZTGzYsIEtW7ZQWFjItm3bqK6u7rVOfn4+a9asYdeuXSiKwvbt2wFYtWoVL7/8MsXFxcTHx/PWW28BsHHjRpKTk9m5cyePPvqofQpLIYQQQ89hIigtLSUlJYXQ0FB0Oh0ZGRmUlJTYy2tqaujs7CQpKQmAnJwce/mOHTuIj4/HYrFgMpkIDg4GYO/evWRlZQGwYMECPv30UywWi9ODE0II4ZjDRFBfX4/BYLAvG41GTCZTn+UGg8FertVqOXHiBGlpaXzxxRdkZmZet41GoyEoKIimpibnRCSEEGJAHM5ObrPZUKlU9mVFUXotOyqfNGkSpaWlbN26lby8PLZu3XrdeyiKglrd/+vWN5uE+WYMBv0tbeeKvolFaWpHH+Tv9Pp1Oj8M4Tqn19sXT9w3nkBicV3OjMdhIoiOjqasrMy+bDabMRqNvcq/e7G3oaEBo9FIV1cXn332GXPmzAHgoYceYv369cC1s4qGhgaio6OxWq20tbURGhra70Y3NrZisyn9Xh+u/dLM5pYBbeOqvhtLe5eVltZOp79He3sX5p4ep9d7I566b9ydxOK6BhqPWq266QG0w8Pw2bNns3//fpqamujo6GD37t2kpqbay2NiYvDz86O8vByAoqIiUlNT0Wg0vPDCC1RWVgKwc+dOZsyYAUBaWhqFhYXAtesIycnJaLXafgclhBDCeRyeEURFRZGXl0dubi4Wi4WFCxeSmJjIkiVLWL58OdOmTaOgoIDnn3+e1tZWEhISyM3NxcfHhw0bNrBmzRp6enqIioqy3x20YsUKVq5cSWZmJnq9noKCgkEPVAghxI2pFEUZWB+LC5CuoW9jaeuycrDK5GCLgZs5JYpAP4fHCU7hqfvG3UksrmvIu4aEEEJ4NkkEQgjh5SQRCCGEl5NEIIQQXk4SgRBCeDlJBEII4eUkEQghhJeTRCCEEF5OEoEQQng5SQRCCOHlJBEIIYSXk0QghBBeThKBEEJ4OUkEQgjh5SQRCCGEl5NEIIQQXq5fiaC4uJj58+eTnp7O5s2bryuvqqoiJyeHjIwMVq9ejdVqBaC8vJyFCxeSnZ3NU089RU1NDQAHDhxg1qxZZGdnk52dzapVq5wYkhBCiIFwmAhMJhMbNmxgy5YtFBYWsm3bNqqrq3utk5+fz5o1a9i1axeKorB9+3b762vXrqWoqIisrCzWrl0LQGVlJU8//TRFRUUUFRWxbt26QQhNCCFEfzhMBKWlpaSkpBAaGopOpyMjI4OSkhJ7eU1NDZ2dnSQlJQGQk5NDSUkJ3d3drFixgsmTJwMwadIk6urqAKioqGDfvn1kZWWxbNky++ti6FisNto6LbS2W+i29Ax3c4QQw8jhpLT19fUYDAb7stFo5MiRI32WGwwGTCYTvr6+ZGdnA2Cz2Xj11VeZM2cOAHq9nnnz5pGens7//M//kJeXx9atW50WlOhbZ7eVytNNnDh/mZ5/zPusVqkYO0LP5DFhRAT7D3MLhRBDzWEisNlsqFQq+7KiKL2WHZV3d3ezcuVKrFYrzzzzDAAvvviivXzRokW88sortLS0oNfr+9Xom03CfDMGQ//qdwffxKI0taMP6t+X96mLl/nw4AV6emxMiA0jxhCISqXC3NxO1dlmTtVeJWmCgXsSR6DT+WEI1w1mCL144r7xBBKL63JmPA4TQXR0NGVlZfZls9mM0WjsVW42m+3LDQ0N9vK2tjaeffZZQkND2bRpE1qtFpvNxuuvv87SpUvx8fGxb/fdnx1pbGzF9o+j2f4yGPSYzS0D2sZVfTeW9i4rLa2dDrc5b2rhk8O1RIb4M3tqNCFBfvayUZE6EsaE8eXXDRw+acZ8uZ2xUUGoeoamy8hT9427k1hc10DjUatVNz2AdniNYPbs2ezfv5+mpiY6OjrYvXs3qamp9vKYmBj8/PwoLy8HoKioyF6en59PXFwcGzduxNfX9x8NUvPBBx+wa9cuAAoLC5k+fTo63dAdfXqbi+ZWPj1cS0SwP/+UPKpXEviGr9aHlIQoZt1hpLahjVffq6BLrh0I4RUcJoKoqCjy8vLIzc3l4YcfZsGCBSQmJrJkyRIqKioAKCgoYN26dcydO5f29nZyc3M5duwYe/bs4csvv+SRRx4hOzubJUuWALB+/Xr++Mc/kpmZyXvvvWe/m0g4X3unlc++qiNU78ec5FH4am5+5jUpNoy0pJFcMLXwZvGxAZ95CSHcj0pRFLf7S5euoW9jaeuycrDKdMP1FEVh76FaahvayLp3DMGBvv1+j7YOK+99cor0maN57J8mOKXdffHUfePuJBbX5eyuIYfXCIT7Om9q5UJ9KzMmRg4oCQDcPyOGy61d7D54gfiYEJInGx1vJIRwSzLEhIfqtvTwxTET4cF+3DEm/Jbq+NGD8Ywdoef/LTlOc0uXk1sohHAVkgg81PFzzXR293BPQjRqtcrxBjeg8VGzJCsBS4+N//7bMWzu14sohOgHSQQeyGK1cexcM6MMgUSE3N4DYtHhOh57cAJHzzbz8Zc1TmqhEMKVSCLwQCfON9NtsZEYH+GU+tKSRpIwNpz3PjklXURCeCBJBB7GYrVx7GwzIyN1RIYEOKVOlUrFE+kTsfYobN1z0il1CiFchyQCD1N98Qqd3T0kjnfO2cA3osJ0LJgdx8Hj9VScbnRq3UKI4SWJwIMoisLx880YQv0xhjn/Se15s+KICtexeffXWKw2p9cvhBgekgg8iKmpg5Z2CxNHhw5K/VqNmsU/nED95Q72lF8clPcQQgw9SQQe5OuLl/HVqImLHrxRFqeOjWDauAiKS8/S0t49aO8jhBg6kgg8RGe3lfOXWhk3MhiNz+Du1n9+MJ6u7h7+su/soL6PEGJoSCLwEKdrrmJTFCYMUrfQd8VEBpKWNJKPD9VQ19g26O8nhBhckgg8gKIonLx4BUOoP2H664eYHgzZ943Fz1fN9o+qHa8shHBpkgg8QNPVLq60dTM+JmTI3jM40JcF94zhq1ONHD3bNGTvK4RwPkkEHuDspauoVBAXNbRT8c1JHkVkiD/b9lTLvAVCuDFJBG7OpiicrWthZGQgfr79n+7TGbQaHxbeP56L5lb2VdQN6XsLIZxHEoGbO1t3lbZOK2NHDM/E3DMnG4mPCeHPn56ms9s6LG0QQtyefiWC4uJi5s+fT3p6Ops3b76uvKqqipycHDIyMli9ejVW67UvhPLychYuXEh2djZPPfUUNTXXRq+8evUqS5cuZd68eSxevBiz2ezEkLzLlyfMqNUqRhn7nn3oVqjUKtq6rA7/tXf38NAPxnKlrZu/fH7W4fryQLIQrsfhDGUmk4kNGzbw/vvv4+vry2OPPcasWbOIj4+3r5Ofn8/atWtJSkriueeeY/v27Tz++OPk5+fz+9//nsmTJ/Puu++ydu1aNm3axMaNG0lOTuaNN96gsLCQl156iY0bNw5qoJ7IZlM49HUDowyBDuciHqguSw9ffd3/BB0XreeDgxcICtCg89f2ud7MKVFo/GRiPCFcicMzgtLSUlJSUggNDUWn05GRkUFJSYm9vKamhs7OTpKSkgDIycmhpKSE7u5uVqxYweTJkwGYNGkSdXXX+pH37t1LVlYWAAsWLODTTz/FYrE4PThPd+LCZa62dzNmRPBwN4UZEyNRFDh0smG4myKEGCCHh2b19fUYDAb7stFo5MiRI32WGwwGTCYTvr6+ZGdnA2Cz2Xj11VeZM2fOddtoNBqCgoJoamoiKiqqX42+2STMN2MwDE8/+mAwGPS8v+8MWo2ayWPC0Tr5jECr1aAP6v+kNvogfxLjIzl80kzylGgiQ288BLZO54ch/PoB8Txt33gKicV1OTMeh4nAZrOhUn071aGiKL2WHZV3d3ezcuVKrFYrzzzzzA3fQ1EU1Or+X7dubGwd8O2KBoMes7llQNu4KoNBT339VfYfqWVSbCidnRY6ce4ZlcVipaW1c0DbTIoN4djZRj49dJE5yaN6fQ6+0d7ehbmnp9drnrZvJBbX40mxwMDjUatVNz2AdvjtGx0d3etirtlsxmg09lne0NBgL29ra+MnP/kJVquVTZs2odVe6zs2Go00NFzrQrBarbS1tREaOvhDI3iSC/WtNF7tcvq8A7fDT+vD9PGR1DW2U9sgQ08I4S4cJoLZs2ezf/9+mpqa6OjoYPfu3aSmptrLY2Ji8PPzo7y8HICioiJ7eX5+PnFxcWzcuBFfX1/7NmlpaRQWFgKwY8cOkpOT7UlC9M+hkw2ogISxrpMIACbGhqLXaSk7YZaHzIRwEw67hqKiosjLyyM3NxeLxcLChQtJTExkyZIlLF++nGnTplFQUMDzzz9Pa2srCQkJ5ObmcuzYMfbs2UN8fDyPPPIIcO1M4M0332TFihWsXLmSzMxM9Ho9BQUFgx6opzl00sz4mBCCA30drzyEfNQqZkw08MnhWk5evMKkWDnTE8LVqRRFcbvDNm+/RqBofPiXtR/w6P3jSb0zhoNVJqe/x/SJhgHdPvpdiqKw+8AFLrd28/APxvZ64nnmlCgCv3f7qCftG4nFNXlSLDAM1wiE6zlw9BIASRMih7klN6ZSqbj7DiPdlh4OV8vtpEK4OkkEbuiLo5eIDtcxIiJwuJvSpzC9PxNjQ/n6/GWarg7s7iMhxNCSROBmOrutVJ5qZHq8a10kvpGk+Eh8tT4cqKrHDXsghfAakgjczPFzl7H22Jg2zvUTgZ+vDzMmRVLf3EF1zZXhbo4Qog+SCNzMkdONBPj5MGGUe9yNEx8TgjEsgPITZjq6ZHRSIVyRJAI3oigKFacamT7BgFbjHrtOpVKRkhCF1Wqj7Hj9cDdHCHED7vFtIgCobWyn8Wond03u35hMriI0yI+p4yI4U9fC0TMyraUQrkYSgRupONUI4HaJAGDa+HBCg3zZ8sHXtHbISLNCuBJJBG6k4nQjMYZADGE3HtnTlfmo1dybOILWDgv/3+4Tw90cIcR3SCJwEx1dVr6+cJlEN7hbqC8Rwf7MT4njQFU9Xxxz/tPQQohbI4nATZw4f5kem8JUN04EAHNmjmb8yGD+uOs4pub24W6OEAJJBG7j6Jkm/LQ+xMeEDHdTbouPWsUz2QmoVSo2/bkSi7XH8UZCiEElicBNVJ5pZFJsqNvcNnozkSEB/GTBHZyvb2XLhyeHuzlCeD33/1bxAubLHZiaO0gYGz7cTXGa6fGRzE+J45PDtfxt3+nhbo4QXk0SgRs4evbavfdTPSgRAOSkjiMpPpI3Cis4ckpGKRViuEgicANHTzcREexH9A0mfXdnarWKpQ/dwZiRIWwqOsq5S54zXrwQ7qRfiaC4uJj58+eTnp7O5s2bryuvqqoiJyeHjIwMVq9ejdXae0yZjRs38rvf/c6+fODAAWbNmkV2djbZ2dmsWrXqNsPwXD02G8fONZMwNvyGk8G7O39fDWv+ZRaB/hpe2XaYi/Wtw90kIbyOw0RgMpnYsGEDW7ZsobCwkG3btlFdXd1rnfz8fNasWcOuXbtQFIXt27cD0NLSwnPPPcfbb7/da/3KykqefvppioqKKCoqYt26dU4MybOcqWuho8vqcnMTO1NESAD5i+5E46PiP7YeokYmvhdiSDlMBKWlpaSkpBAaGopOpyMjI4OSkhJ7eU1NDZ2dnSQlJQGQk5NjL9+zZw9jxozhxz/+ca86Kyoq2LdvH1lZWSxbtoy6ujpnxuRRjp5pQqWCKXFhw92UQRUVpuPfHp+BWqXi5S1fcrr26nA3SQiv4TAR1NfXYzAY7MtGoxGTydRnucFgsJc//PDDLF26FB+fb+esBdDr9Tz55JMUFxeTlpZGXl7ebQfiqSrPNDJ2RDBBAdrhbsqgiw7X8e+LZ+Cn9eHlLV9y6OStzZkshBgYjaMVbDZbr75pRVF6LTsqv5EXX3zR/vOiRYt45ZVXaGlpQa/X96vRN5uE+WYMhv7V7ypaOyycqb3Ko3MmXtf2b5aVpnb0Qf5Of2+tVjMo9ep0fhhucNH7m3gMBj2/yUvjxbe+4LX3K1g8dwoLH5yAWu34+khLezcdnc6f8yDAX4Ne59vv9d3tc3YzEovrcmY8DhNBdHQ0ZWVl9mWz2YzRaOxVbjZ/e+TW0NDQq/z7bDYbr7/++nVnCt8/a7iZxsZWbLaBTX1oMOgxm93rrpTyE/XYFBhrDOrV9u/G0t5lpaXV+XMCWyyDU297exfmnt5PE99o3/w/j07n7Z1VvLOzikPHTfwk6w6CHXwZt3VZOVjl/DGMZk6JorOtq1/ruuPnrC8Si+saaDxqteqmB9AOu4Zmz57N/v37aWpqoqOjg927d5Oammovj4mJwc/Pj/LycgCKiop6lV/fIDUffPABu3btAqCwsJDp06ej03nWrZHOUHmmCX9fH8aNDB7upgw5P18fnnkogSczJnH8fDO/+K8v+PuxSzL3sRCDwGEiiIqKIi8vj9zcXB5++GEWLFhAYmIiS5YsoaKiAoCCggLWrVvH3LlzaW9vJzc396Z1rl+/nj/+8Y9kZmby3nvvsXbtWudE40EURaHydBNT4sLQ+Hjn4x4qlYoH7oxhzVMziQzx542/HOM/3z1CXaPcVSSEM6kUNzzE8oauIVNTO6ve+DtPpk/kgRmjepV9N5bB6g6ZPtHAV187/2LtzClRBPr17pHsz76x2RQ+LLtA4b4zdFtspN05kqzZYwgN8rOvM5hdQ99vc1/c7XN2MxKL63J211D/Pt1iyFX+Y0pHTxpf6Hao1SrS744lJSGaos/P8MmhWj77qpbZU6PJuDuWERGBw91EIdyWJAIXdfRME4ZQf4xhcu3ku4IDfXkyfRIZM0ez68AF9lXU8dlXdSRNiLzuzEkI0T+SCFyQtcdG1flm7kmIHu6muCxjmI4nMyaRfd9YPiy/yMdfXuTQyQYiQvyZHBvKmBF6fNTeeW1FiIGSROCCqi9eoau7h2nSLeRQcKAvOanjmJ8Sy0eHath94AKfV1yi/ISZCaNCmBgbSqC/5z+MJ8TtkETggipON+KjVjHZw4eVcCZ/Xw1pSTEE+PpQ19jO8fOXqTjdROWZJmKNQUyKCyMqLMAjB+4T4nZJInBBFaebmDAqhIB+3qkivqVSqRgZGcjIyEBa2rv5+sJlTl68wjlTK5Eh/kwbH8EoQ6AkBCG+QzpRXUxzSxcXza1Mc/NJ6l2BXufLXZOMLLx/PCkJUXR29/DxlzX8tfQc5y61yMNpQvyDHHK6mMozjQBMlUTgNBofNRNHhxIfE8KZuqtUnGrkk8O1hAT5ctdEA6OMtzZ2lRCeQhKBi6k83URIkC+jDHJfvLOp1SrGx4QwdmQw5+paOFzdwEdf1jAyMpCZkw2EfOfhNCG8iXQNuZAem42jZ5qYNjZC+rAHkVqlYuzIYB66byzJkwyYL3fwl8/PcrCqnm5Lj+MKhPAwckbgQs7UttDeZWXqOLltdCj4qFXcMTacsSODOXyygapzzZypu8rdU4zEReslGQuvIWcELqTidCMqlQwrMdQC/DTcMzWazNlxBAZo+fSrOvYeqqV9EOY2EMIVSSJwIZVnGhk/MkQegBomEcH+zJsVy4xJBmob2vjLvjNUX7widxcJjyeJwEVcbe/mbF2LdAsNM7VaxdSx4WTdO4ZQvR+llZfYVFhJc0v/JqYRwh1JInARR880oYA8P+AiggN9ybh7NDOnGDl18Qq/+K8v2F8pE+MIzySJwEVUnm4kKEBLXLRnzavqzlQqFVPiwvj3J+5iZGQgb/71GK/9uZKrbd3D3TQhnKpfiaC4uJj58+eTnp7O5s2bryuvqqoiJyeHjIwMVq9ejdXa+yLbxo0b+d3vfmdfvnr1KkuXLmXevHksXry415zH3simKFSeaWLq2HDUcqeKyzGGBbBy8Qz++YF4jpxq4Pn/+oKy4/XD3SwhnMZhIjCZTGzYsIEtW7ZQWFjItm3bqK6u7rVOfn4+a9asYdeuXSiKwvbt2wFoaWnhueee4+233+61/saNG0lOTmbnzp08+uijvPTSS04Myf2cN7XQ0m7xiusDKrWKti5rr3/1Te3XvXYr/wY4ad2AqNUq5s6K5Zf/eyYRIf78vrCSN/5ylNYOy+C9qRBDxOFzBKWlpaSkpBAaGgpARkYGJSUl/PSnPwWgpqaGzs5OkpKSAMjJyeG3v/0tjz/+OHv27GHMmDH8+Mc/7lXn3r177WcWCxYs4MUXX8RisdfDbYAAABlESURBVKDVeufdMhWn/jGsxFjPvz7QZem5bgpMfZA/La2dt1339ImG267DkRhDEKufvIsdfz9H8ednqTrfzI/nTSZxfOSgv7cQg8XhGUF9fT0Gw7d/YEajEZPJ1Ge5wWCwlz/88MMsXboUHx+fPuvUaDQEBQXR1NR0e5G4sYrTTcRF6QkO9B3upoh+0PioeejesTyfm0xQgJaNfzrC2zuq5LkD4bYcnhHYbLZeT1gqitJr2VF5fyiKgnoAs0ndbBLmmzEYXO9C7OWWLk7VXmHRDycNqH3frKs0taMP8nd6u7RazZDW64z3Gqw263R+GMKvnzLUYNAzfUoUW3ad4P2PT1JxpomnsxK4f8Yoj3kq2RX/Zm6VJ8UCzo3HYSKIjo6mrKzMvmw2mzEajb3Kv3uxt6GhoVf5jRiNRhoaGoiOjsZqtdLW1mbveuqPxsZWbAPsEDYY9JjNLQPaZih89lUtigITRgb3u33fjaW9y+qUbpXvs1iGrl5ndQ0NVpvb27sw9/Q9BtH8u0eTEBvKH3ed4DdbvuRvn53mifSJxBjce1RTV/2buRWeFAsMPB61WnXTA2iHh+GzZ89m//79NDU10dHRwe7du0lNTbWXx8TE4OfnR3l5OQBFRUW9ym8kLS2NwsJCAHbs2EFycrLXXh84XN1AeLAfsVHu/aXh7eKi9azOvYufPjqdi+ZW/s/bB9n20UnaOuVisnB9Ds8IoqKiyMvLIzc3F4vFwsKFC0lMTGTJkiUsX76cadOmUVBQwPPPP09raysJCQnk5ubetM4VK1awcuVKMjMz0ev1FBQUOC0gd9Jt6eHomSbuSxzhMV0J3kytUpGRMoYJI/S898lpdh24wGdf1TF3Vixzkkfh7ytjPArXpFLc8FFJT+kaOnyygd++d4T/+0fTB3TH0HdjaeuycrDK5GCLgZs+0XDd3T2DVa8z7xoajDbfnRCN0s/Pm07nR3v7teEoLppb+VvpWSpPN6HXaUmfGcu9iSPQaq6diPtpNWhc+JFOV/ybuVWeFAs4v2tIDlGG0eFqM/6+PkyOlUnqXdmNbnnty/eT2oyJBkYbgzj0dQPvfXKKnX8/x+QxYUwcFcK9iSPRyLzUwgXIp3CY2BSFw9WNTBsXgcbHhQ8LxW0zhAaQfvdo6hrbqDjVxJcnzBypbsB0uYP7k2IID3bunU6ufqYhXI8kgmFyquYKV9u6uXOCPIjkLUZEBDIiIpDGK50cO9vEJ4dq2ftlDbFReibHhmIMC3DKtaKZU6LkTEMMiHxahsnB4/VofNRMj5dE4G0iQvz5wfSRLB4RzJ/3VnPy4hXOXWohNMiXSbGhjBsZYr+OIMRQkEQwDGyKQtnxeqaNCydAjty8Vpjej7smGZkeH8mZuhZOnG/mi2P1fHmigXExwUyKDSU0yG+4mym8gHwLDYNTNVe43NrNzMk3f/BOeAeNj5oJo0KIjwmm4UonJ85f5uSFK5w4f5nocB2TYkMZbQxCrZZbjMXgkEQwDKRbSNyISqXCEBqAITSAuyYZqL54ha8vXOaTw7Xo/DVMHB3KhFEhchYpnE4+UUNMuoVEfwT4aZg2PoKEceFcrG/lxPnLHD7ZwJHqBmKjr11cNoQ65+KyEPJNNMSkW0gMhFqlIjZKT2yUniut3Xx94TLVNVc4W9dCmN6PSbGhjB0RLBeXxW2RRDDEDhyTbiFxa0KCfJk5xUjShEjO1F3lxPnL/P2oifITZuJjQpgUGypDmYtbIolgCFl7bHxRZWLGxEjpFhK3TKtR268X1F/u4MS5yxw/30zVuWZGRuoIDvTlzvhI6TYS/SbfRkPoq+pGWjsszJ46YribIjyASqUiKkxHVJiOji4rJy9c5vj5y7z6XgVjovXMS4njrokGudtIOCSJYAiVVtYREuhLwlgZW0g4V4CfhsT4SBLGhtNjg4++vMimwkqMYQHMnRXLvVOj0Wp8HFckvJIkgiFytb2bI6ca+WHyaHwGMBubEAPh46MmZWoUc+4aRfnXZnb8/Rx/LDlB4Wdn+GHyKB64Mwadv3fO/SH6JolgiHxxzESPTWH2tOjhborwAmq1ipmTjSRPMnD8XDM7vjjPe5+c5m/7z3H/nTH8MHk0YXp5allcI4lgiJRWXCIuSs8oN5++ULgXlUrFlDHhTBkTzrlLLez84hy7Dpznw7IL3JMQzdxZsYyICBzuZoph1q8+iuLiYubPn096ejqbN2++rryqqoqcnBwyMjJYvXo1VqsVgNraWhYvXszcuXN59tlnaWtrA+DAgQPMmjWL7OxssrOzWbVqlRNDcj2na69yztTCfYlykVgMn7hoPcuyp7JuaQo/SBzJ34+ZeP7NL3j1/QpO1V4Z7uaJYeQwEZhMJjZs2MCWLVsoLCxk27ZtVFdX91onPz+fNWvWsGvXLhRFYfv27QC88MILPP7445SUlDB16lR+//vfA1BZWcnTTz9NUVERRUVFrFu3bhBCcx17yi/i7+vD7KnSLSSGnzFMx5MZk/iPZ2eTOTuO4+eaeemP5azf/CVHTjXihpMWitvkMBGUlpaSkpJCaGgoOp2OjIwMSkpK7OU1NTV0dnaSlJQEQE5ODiUlJVgsFg4ePEhGRkav1wEqKirYt28fWVlZLFu2jLq6usGIzSVcbevm4HET904dIc8OCJcSHOhLTup4/uP/ms2PHoyn/nIHG//0Fb/874PsP3qJnh7bcDdRDBGHiaC+vh6DwWBfNhqNmEymPssNBgMmk4nm5maCgoLQaDS9XgfQ6/U8+eSTFBcXk5aWRl5entMCcjWfflWLtUfhwbtihrspQtxQgJ+GjLtjWb/sHp6eP4Uem403i4+xdN2HfFh2gS5Lz3A3UQwyh4eoNput1xOKiqL0Wu6r/PvrAfblF1980f7aokWLeOWVV2hpaUGv1/er0TebhPlmDIb+1e8sPT02Pv2qlqQJBhInO7db6JtYlKZ29EHOneoQQKvVDGm9znivoW5zX/q77mC1V6fzwxCuu6VtH4kOIfuBCRw8don3Pq5my4cnKS49R9Z9Y8m8b5xbD2Ex1H//g82Z8ThMBNHR0ZSVldmXzWYzRqOxV7nZ/O3E3g0NDRiNRsLDw2lpaaGnpwcfHx/7djabjddff52lS5fi4/PtAy7f/dmRxsZWbLaB9WMaDHrM5pYBbXO7DlSZaLjSyWP/NMGp7/3dWNq7rL0mS3cWi2Xo6v3+hO/OrNsZBlLvQGIZrPZ2dHZz9mLXbdURFerPzxffRcXJej48eIEtu0/w7scnSU0cSfrdo4kMCXBSa4fGcPz9D6aBxqNWq256AO0wEcyePZvf/e53NDU1ERAQwO7du/nVr35lL4+JicHPz4/y8nLuuusuioqKSE1NRavVkpyczI4dO8jKyqKwsJDU1FTUajUffPABcXFxzJ8/n8LCQqZPn45Od2tHMK7Kpij8tfQc0eE6kmSAOTGEuiw9fPW12fGKDnyT1GZMMjB2ZDCmpnY+PlTDR1/WMOsOI/NmxTHKKLdDewKHiSAqKoq8vDxyc3OxWCwsXLiQxMRElixZwvLly5k2bRoFBQU8//zztLa2kpCQQG5uLgC//OUvWblyJZs2bWLEiBH85je/AWD9+vX84he/4LXXXiM8PJyXX355cKMcBodPNnDR3MqSBXfIWC/C7YXp/Ui/O5ZH749n98ELfPpVLfuPmkgcH8G8WbFMHB0qg9y5sX7dxpKVlUVWVlav19588037z5MnT+bdd9+9bruYmBjeeeed616fMGECW7duHWhb3YaiKBR/fhZjaAB33yHzDgjPERHiz6I5E8i6dwwffXmRD8susn7LIcaPDGZeShxJEyJRS0JwO3I/4yA4cqqRc6YWfjx/sowrJDxSUICWh+4dS8bdsew7UseuA+d59f0KRkTomHt3LPdMjUbjI599dyGJwMlsNoU/f3aayBB/7kmQB8iE51CpVbR1Wa97PWVqNDPviOLQ12Y+LLvA2zuPU7jvDHOSR3PP1Oh+zZ7mp9Ugk6wNH0kETvbZkVrOm1pZ+tAdckQkPEp/LkI/OCOG2oZ2jpxq5E8fV/PX0jMkjAlnwujQmyaEmVOi0MgDl8NGfvNO1N5p4f1PTzNhVAizpkQNd3OEGHIqlYoYQyAjI3WYmjo4cqqRshNmKk43cceYMCbFheIr8yK4HEkETvSXz8/S2m7h8X+eKHdQCK+mUqmIjtARHaGjvrmDilONHDrZwNEzTUyOC2NKXBh+vpIQXIUkAic5d6mFPeUX+cH0kcRFe9YTjELcDmNYAP+UPIrGK50cOdXIkVONVJ1tZlJsKFPGhMkYXC5A9oATdFt6eKP4KEE6LQvvHz/czRHCJUWE+PPAjBiaW7qoONVI5Zkmqs41M3F0KBNHhxIoCWHYyNVMJ/jT3lPUNbbzL5lTCAqQaQCFuJkwvR+pSSPJvm8scdF6jp9v5v/89wHe2X2CxivOH3JDOCYp+DZ9Vd3AnvKLzEkexdSxEcPdHCHcRkiQL/cljmB6fASmpg4+PVzLp4drmT01msx74jCGedawM65MEsFtOG9q4fW/HGW0MYiFadIlJMSt0Ot8efCu0Tzyg3GUfHGeT76q5fOKS8y6I4rMe+IYGSlTaQ42SQS3qLmli/989wgBfhpWLEzEVyt3QAhxOyJC/FmcPpHM2XHsOnCejw/V8Pejl0iaEMmDd41iSlyYDF8xSCQR3ILLrV38ZvthOrqsrHriLsKDnT+mvBDeKjTIjx89OIH5KXF8UHaBvYdqOXSygahwHQ/cGcO906IJ9Jdrcc4kiWCATM3tvLL1MC3tFn72v6YxWobhFWJQ6HXXptLMmj2GsuNmPjp0ka17TvL+J6e4a5KBlIRo7hgTJuN5OYEkggE4cb6ZTYWV2BTIX3Qn40YGD3eThPAIfY1j9I3ECZEkTojkgqmFzyvq+PJrM/uPmtDrtMyYaCB5ipG4KP11D3LKGEb9I4mgH6w9Nor2nWHH/nMYQgNY8WgiIyLkApYQzjKQyXTGx4QwJlrPRXMbZ+qu8tlXdXxyuJYAPw2jDIGMMgYxIkKHxkctYxj1k/yGbkJRFI6cauTdvaeoaWjjB4kjWDRnAv6+8msTYjj5+KiJi9YTF62ny9LDBVMrF82tnKm7ysmLV/BRq4gK19Hc0kXCmHBC5VbUm5JvtBuw9tg4fLKBD8su8PXFKxjDAvhZzjTunGgY7qYJIb7HT+tD/KgQ4keF0GNTMDW1U2Nuo7axjeLPz1L8+Vm02w4zJlrP+JgQYo1BjI7SEx0eINcX/qFfiaC4uJhNmzZhtVp56qmnWLx4ca/yqqoqVq9eTVtbG8nJybzwwgtoNBpqa2vJz8+nsbGRsWPHUlBQQGBgIFevXuXnP/85Fy5cIDw8nI0bN2IwDO+XrMVq48SFZr6qbqTseD1X2roJD/bjifSJpE4fKUNKC+EGfNQqRkYG2p89mDImnNr6Vi42dfDV1/V8WHYBa48CgFajJuYf6xrDAogK09n/1/l71zGyw2hNJhMbNmzg/fffx9fXl8cee4xZs2YRHx9vXyc/P5+1a9eSlJTEc889x/bt23n88cd54YUXePzxx8nMzOS1117j97//Pfn5+WzcuJHk5GTeeOMNCgsLeemll9i4ceOgBvoNi7WHy63dNFzu4FJzB7UN1/oZz5tasPYoaDVqpo4N5wfTR5I4LkLmGxbCjQUFaLlzooF0gx6zORZrj41Lje1cqG/lfH0L502tVJ1rprTyUq/tAvx8CNP7ExbkS6jejzC9H0EBvgT6awgK0BIYoL32v78Gnb/G7c8sHCaC0tJSUlJSCA0NBSAjI4OSkhJ++tOfAlBTU0NnZydJSUkA5OTk8Nvf/pZHH32UgwcP8tprr9lff+KJJ8jPz2fv3r1s3rwZgAULFvDiiy9isVjQavt3b/CtfDkrisJ/vnuEusa2Xq/7an2IMQRy10QjY2OCiY8JwdcNbjP45neg8VGjG4R7qoey3gA/DT3W238vV/hdDCQWV2jvzXw/lsFq72DWrfFR2/9W1GoVvmofYqP1xEbruZcR9vW6rTaarnTScKWDhiudXGnt5krbtX+m5g6qa66gKH2/j1ajRqvxwU+jRqu99rOvRo1Wo77WBpUKlVqFWnXtrEWtujZUt1r9j3+osCkKNkWhx6aAotCjXJvx0GZT6LbasFh7SIo3kJIQZY+nvxyt6zAR1NfX9+q2MRqNHDlypM9yg8GAyWSiubmZoKAgNBpNr9e/v41GoyEoKIimpiaiovo3mUtY2K3dsbP22XtvaTtXFBHx7fMLo0aEDMp7jBsV5lb1DmbdUu/g1jvYdUPvv5kbGRHlXreDO4pnIBwe+tpstl735iqK0mu5r/Lvrwf0OVmLoiio3fzUSggh3JXDb9/o6GjM5m/v7zWbzRiNxj7LGxoaMBqNhIeH09LSQk9Pz3XbGY1GGhoaALBarbS1tdm7noQQQgwth4lg9uzZ7N+/n6amJjo6Oti9ezepqan28piYGPz8/CgvLwegqKiI1NRUtFotycnJ7NixA4DCwkL7dmlpaRQWFgKwY8cOkpOT+319QAghhHOpFOVml0CuKS4u5vXXX8disbBw4UKWLFnCkiVLWL58OdOmTeP48eM8//zztLa2kpCQwLp16/D19aWmpoaVK1fS2NjIiBEj+M1vfkNISAiXL19m5cqVXLhwAb1eT0FBAaNGjRqKeIUQQnxPvxKBEEIIzyVXaIUQwstJIhBCCC8niUAIIbycJAIhhPByHp0IysvLWbhwIdnZ2Tz11FPU1NQAcPXqVZYuXcq8efNYvHhxr+cgXF1xcTHz588nPT3dPkyHO3n11VfJzMwkMzOTl19+Gbg2jElWVhbp6els2LBhmFs4cOvXr2flypXAtQEYc3JyyMjIYPXq1VitfU+24ko++ugjcnJymDdvHmvXrgXce78UFRXZP2fr168H3G/ftLa2smDBAi5evAj0vT+cEpfiwR544AGlqqpKURRF+dOf/qQsW7ZMURRFeeGFF5TXX39dURRF+fOf/6ysWLFi2No4EJcuXVIeeOABpbm5WWlra1OysrKUkydPDnez+u3zzz9XfvSjHyldXV1Kd3e3kpubqxQXFytpaWnK+fPnFYvFojz99NPK3r17h7up/VZaWqrMmjVL+fd//3dFURQlMzNTOXTokKIoirJq1Spl8+bNw9m8fjl//rxy3333KXV1dUp3d7eyaNEiZe/evW67X9rb25WZM2cqjY2NisViURYuXKh8/vnnbrVvDh8+rCxYsEBJSEhQLly4oHR0dPS5P5wRl8eeEXR3d7NixQomT54MwKRJk6irqwNg7969ZGVlAdcGvfv000+xWCzD1tb++u4AgDqdzj4AoLswGAysXLkSX19ftFot48eP5+zZs8TFxTF69Gg0Gg1ZWVluE9Ply5fZsGEDy5YtA248AKM7xPLBBx8wf/58oqOj0Wq1bNiwgYCAALfdLz09PdhsNjo6OrBarVitVjQajVvtm+3bt/PLX/7SPhrDkSNHbrg/nPWZ89hBt319fcnOzgaujYf06quvMmfOHOD2B70bLo4GAHR1EyZMsP989uxZdu7cyRNPPHFdTN8MTujq1qxZQ15env0Ao68BGF3duXPn0Gq1LFu2jLq6Ou6//34mTJjgtvslKCiIFStWMG/ePAICApg5cyZardat9s1LL73Ua/lGf/smk8lpnzmPSAQ7d+5k3bp1vV4bN24cf/jDH+ju7mblypVYrVaeeeaZG26vuMmgd44GAHQXJ0+e5JlnnuHf/u3f8PHx4ezZs/Yyd4npT3/6EyNGjOCee+7h/fffB9x3//T09FBWVsY777yDTqfj2Wefxd/f3y1jATh+/DjvvfceH3/8MXq9np///Od8/vnnbhsP9P3ZctZnziMSwbx585g3b951r7e1tfHss88SGhrKpk2b7OMZfTPoXXR0tFsNehcdHU1ZWZl9+fsDALqD8vJyli9fznPPPUdmZiYHDhy46aCGrmrHjh2YzWays7O5cuUK7e3tqFSqGw7A6OoiIyO55557CA8PB2DOnDmUlJTg4+NjX8dd9gvAvn37uOeee4iIiACudZe89dZbbrlvvtHX4J99Dfo5UK5/GHwb8vPziYuLY+PGjfj6+tpfd9dB7xwNAOjq6urq+Nd//VcKCgrIzMwEYPr06Zw5c4Zz587R09PDX//6V7eI6e233+avf/0rRUVFLF++nAcffJB169bdcABGV/fAAw+wb98+rl69Sk9PD5999hlz5851y/0CMHnyZEpLS2lvb0dRFD766CPuvvtut9w33+jr76SvQT8HyiPOCG7k2LFj7Nmzh/j4eB555BHg2pnAm2++yYoVK1i5ciWZmZn2Qe/cQVRUFHl5eeTm5toHAExMTBzuZvXbW2+9RVdXF7/+9a/trz322GP8+te/5mc/+xldXV2kpaUxd+7cYWzl7SkoKOg1AGNubu5wN8mh6dOn85Of/ITHH38ci8XCvffey6JFixg3bpxb7pf77ruPY8eOkZOTg1arZdq0aSxdupQf/vCHbrdvvuHn59fn34kzPnMy6JwQQng5j+4aEkII4ZgkAiGE8HKSCIQQwstJIhBCCC8niUAIIbycJAIhhPBykgiEEMLLSSIQQggv9/8DDsyFZM9oc/UAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1459]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab length</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab1_stop</span><span class="o">-</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab1_start</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab2_stop</span><span class="o">-</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">vocab2_start</span><span class="p">))</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="c1"># vocab_instances20_alltissue_df_rs_filt[((vocab_instances20_alltissue_df_rs_filt.vocab1_stop-vocab_instances20_alltissue_df_rs_filt.vocab1_start)&gt;=20)| ((vocab_instances20_alltissue_df_rs_filt.vocab2_stop-vocab_instances20_alltissue_df_rs_filt.vocab2_start)&gt;=20)]#.vocab2.unique()</span>
<span class="c1"># vocab_instances20_alltissue_df_rs_filt[ ((vocab_instances20_alltissue_df_rs_filt.vocab2_stop-vocab_instances20_alltissue_df_rs_filt.vocab2_start)&gt;=20)].vocab2.unique()</span>


<span class="c1"># really long tfs</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span> <span class="p">((</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">vocab1_stop</span><span class="o">-</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">vocab1_start</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">20</span><span class="p">)]</span><span class="o">.</span><span class="n">vocab1</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>count    9172.000000
mean       10.907436
std         5.349342
min         3.000000
25%         6.000000
50%        10.000000
75%        14.000000
max        21.000000
dtype: float64
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[1459]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;THAP1&#39;, &#39;PATZ1&#39;, &#39;SP2&#39;, &#39;ZFP28&#39;, &#39;SP1&#39;, &#39;ZNF816&#39;, &#39;ZNF324&#39;, &#39;MAZ&#39;,
       &#39;VEZF1&#39;], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-Add-in-positive-and-negative-controls">4. Add in positive and negative controls<a class="anchor-link" href="#4.-Add-in-positive-and-negative-controls">&#182;</a></h1><p>need to run 8F_controls.ipynb first</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1027]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">MAX_DIST</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1027]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>135</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1028]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tss_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/external/TSS_annon_hg19.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;TSS&#39;</span><span class="p">)</span>
<span class="n">tss_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1028]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chr</th>
      <th>loc</th>
      <th>end</th>
      <th>width</th>
      <th>strand</th>
      <th>TSS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>chr1</td>
      <td>1846266</td>
      <td>1846266</td>
      <td>1</td>
      <td>*</td>
      <td>CALML6</td>
    </tr>
    <tr>
      <td>1</td>
      <td>chr1</td>
      <td>231376933</td>
      <td>231376933</td>
      <td>1</td>
      <td>*</td>
      <td>C1orf131</td>
    </tr>
    <tr>
      <td>2</td>
      <td>chr1</td>
      <td>241683061</td>
      <td>241683061</td>
      <td>1</td>
      <td>*</td>
      <td>FH</td>
    </tr>
    <tr>
      <td>3</td>
      <td>chr1</td>
      <td>120202421</td>
      <td>120202421</td>
      <td>1</td>
      <td>*</td>
      <td>PHGDH</td>
    </tr>
    <tr>
      <td>4</td>
      <td>chr1</td>
      <td>204135465</td>
      <td>204135465</td>
      <td>1</td>
      <td>*</td>
      <td>REN</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>20255</td>
      <td>chrX</td>
      <td>140084756</td>
      <td>140084756</td>
      <td>1</td>
      <td>*</td>
      <td>SPANXB2</td>
    </tr>
    <tr>
      <td>20256</td>
      <td>chrX</td>
      <td>52683950</td>
      <td>52683950</td>
      <td>1</td>
      <td>*</td>
      <td>SSX7</td>
    </tr>
    <tr>
      <td>20257</td>
      <td>chrX</td>
      <td>140096761</td>
      <td>140096761</td>
      <td>1</td>
      <td>*</td>
      <td>SPANXB1</td>
    </tr>
    <tr>
      <td>20258</td>
      <td>chrX</td>
      <td>52736239</td>
      <td>52736239</td>
      <td>1</td>
      <td>*</td>
      <td>SSX2</td>
    </tr>
    <tr>
      <td>20259</td>
      <td>chrX</td>
      <td>147582139</td>
      <td>147582139</td>
      <td>1</td>
      <td>*</td>
      <td>AFF2</td>
    </tr>
  </tbody>
</table>
<p>20178 rows  6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1029]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pos_genes_df = pd.read_csv(os.path.join(save_dir, &#39;pos_genes_df.csv&#39;),index_col=0)#.gene.values#.iloc[:,0]</span>
<span class="n">pos_genes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;all_pos_genes.csv&#39;</span><span class="p">),</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
<span class="n">pos_genes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;gene&#39;</span><span class="p">:</span><span class="n">pos_genes_df</span><span class="p">},</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pos genes&#39;</span><span class="p">,</span> <span class="n">pos_genes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">neg_genes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;neg_genes_far.csv&#39;</span><span class="p">),</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
<span class="n">neg_genes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;gene&#39;</span><span class="p">:</span><span class="n">neg_genes_df</span><span class="p">},</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;neg genes&#39;</span><span class="p">,</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>pos genes (85, 1)
neg genes (275, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1030]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pos_genes_df</span> <span class="o">=</span> <span class="n">pos_genes_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tss_df</span><span class="p">[[</span><span class="s1">&#39;TSS&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;TSS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">pos_genes_df</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_genes_df</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">MAX_DIST</span>
<span class="n">pos_genes_df</span> <span class="o">=</span> <span class="n">pos_genes_df</span><span class="p">[[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">,</span><span class="s1">&#39;gene&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pos_genes_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1030]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(85, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1031]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">neg_genes_df</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">tss_df</span><span class="p">[[</span><span class="s1">&#39;TSS&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;TSS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="c1">#.shape</span>
<span class="n">neg_genes_df</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">neg_genes_df</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">end</span> <span class="o">-</span> <span class="n">MAX_DIST</span>
<span class="n">neg_genes_df</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="p">[[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">,</span><span class="s1">&#39;gene&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">neg_genes_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1031]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(95, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1032]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pos_genes_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;pos_genes_position.csv&#39;</span><span class="p">))</span>
<span class="n">neg_genes_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;neg_genes_position.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1232]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pybedtools</span><span class="o">.</span><span class="n">BedTool</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">pos_genes_df</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">saveas</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;pos_genes_position.bed&#39;</span><span class="p">))</span>
<span class="n">pybedtools</span><span class="o">.</span><span class="n">BedTool</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">neg_genes_df</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span><span class="o">.</span><span class="n">saveas</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;neg_genes_position.bed&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1232]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;BedTool(../data/processed/fig4_modelling/vocab_sum_final/neg_genes_position.bed)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-get-sequences">4. get sequences<a class="anchor-link" href="#4.-get-sequences">&#182;</a></h1><ul>
<li>vocab sequences in : <code>../data/processed/fig4_modelling/vocab_sum_final/vocab_instances20_alltissue_df.csv</code></li>
<li>pos sequences in: <code>../data/processed/fig4_modelling/vocab_sum_final/pos_genes_position.csv</code></li>
<li>neg sequences in : <code>../data/processed/fig4_modelling/vocab_sum_final/neg_genes_position.csv</code></li>
</ul>
<p>get sequence by url requesting <a href="http://genome.ucsc.edu/cgi-bin/das/hg19/dna?segment=chr1:100000,200000">http://genome.ucsc.edu/cgi-bin/das/hg19/dna?segment=chr1:100000,200000</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4A-get-sequences">4A get sequences<a class="anchor-link" href="#4A-get-sequences">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1037]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">xmltodict</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1038]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_sequence</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">chr_col</span><span class="o">=</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="n">start_col</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="n">stop_col</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://genome.ucsc.edu/cgi-bin/das/hg19/dna?segment=</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">chr_col</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="n">start_col</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="n">stop_col</span><span class="p">])</span><span class="c1">#chr4:39355986,39356120&#39;</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">xmltodict</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">contents</span><span class="p">)[</span><span class="s1">&#39;DASDNA&#39;</span><span class="p">][</span><span class="s1">&#39;SEQUENCE&#39;</span><span class="p">][</span><span class="s1">&#39;DNA&#39;</span><span class="p">][</span><span class="s1">&#39;#text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1171]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># #testing</span>
<span class="c1"># row = vocab_instances20_alltissue_df.loc[0,:]</span>
<span class="c1"># get_sequence(row,chr_col=&#39;chr&#39;, start_col=&#39;start_pad&#39;, stop_col=&#39;stop_pad&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1172]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># probably will take ~20 min (12 min 35s for 15instances , 17 min for 20instances)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chr_col</span><span class="o">=</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="n">start_col</span><span class="o">=</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span> <span class="n">stop_col</span><span class="o">=</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(4586, 18)
CPU times: user 4.72 s, sys: 1.51 s, total: 6.23 s
Wall time: 15min 45s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># takes 18.3 s</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos_genes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">pos_genes_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_genes_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chr_col</span><span class="o">=</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="n">start_col</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="n">stop_col</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(85, 6)
CPU times: user 81.4 ms, sys: 28.6 ms, total: 110 ms
Wall time: 16.5 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1174]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># takes 18.8 s</span>
<span class="nb">print</span><span class="p">(</span><span class="n">neg_genes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">neg_genes_df</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">get_sequence</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">chr_col</span><span class="o">=</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="n">start_col</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="n">stop_col</span><span class="o">=</span><span class="s1">&#39;end&#39;</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(95, 6)
CPU times: user 94.3 ms, sys: 32 ms, total: 126 ms
Wall time: 20.1 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1175]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_alltissue_df_wseq.csv&#39;</span><span class="p">))</span>
<span class="n">pos_genes_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;pos_genes_position_wseq.csv&#39;</span><span class="p">))</span>
<span class="n">neg_genes_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;pos_genes_position_wseq.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4B-MPRA-CONSTANTS-(choosing-RS)">4B MPRA CONSTANTS (choosing RS)<a class="anchor-link" href="#4B-MPRA-CONSTANTS-(choosing-RS)">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[154]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define constants</span>
<span class="n">LEN_FILLER</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">NUM_OLIGO_PER_MOTIF</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">DESIRED_OLIGO_LENGTH</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">MAX_OLIGO_LENGTH</span> <span class="o">=</span> <span class="mi">230</span>
<span class="n">MAX_MOTIF_LENGTH</span> <span class="o">=</span> <span class="mi">63</span>
<span class="n">FORWARD_PCR_PRIMER</span> <span class="o">=</span> <span class="s1">&#39;ACTGGCCGCTTCACTG&#39;</span>
<span class="n">REVERSE_PCR_PRIMER</span> <span class="o">=</span> <span class="s1">&#39;AGATCGGAAGAGCGTCG&#39;</span>
<span class="c1"># LINKER_SPACER_v10 = &#39;CAGTATGCGATGCTCATGATTGTGACTGAAAGTCTATGAGTCCATTGA&#39;</span>
<span class="n">RS_ECORI</span> <span class="o">=</span> <span class="s1">&#39;GAATTC&#39;</span> <span class="c1"># 5&#39;-3&#39;</span>
<span class="n">RS_BAMHI</span> <span class="o">=</span> <span class="s1">&#39;GGATCC&#39;</span>
<span class="n">RS_XHOI</span> <span class="o">=</span> <span class="s1">&#39;CTCGAG&#39;</span>
<span class="n">RS_XBAI</span> <span class="o">=</span> <span class="s1">&#39;TCTAGA&#39;</span>
<span class="n">RS_BSPDI</span> <span class="o">=</span> <span class="s1">&#39;ATCGAT&#39;</span>
<span class="n">RS_NHEI</span> <span class="o">=</span> <span class="s1">&#39;GCTAGC&#39;</span>
<span class="n">RS_NCOI</span> <span class="o">=</span> <span class="s1">&#39;CCATGG&#39;</span>

<span class="c1"># CCTAGG formed by RS_XHOI and RS_NHEI, can be cut by AvrII</span>

<span class="c1"># RS_LIST = [RS_ECORI ,RS_BAMHI , RS_XHOI , RS_XBAI] #original</span>
<span class="c1"># RS_LIST = [RS_BSPDI ,RS_BAMHI , RS_XHOI, RS_NHEI]</span>
<span class="n">RS_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="n">RS_ECORI</span> <span class="p">,</span><span class="n">RS_BAMHI</span> <span class="p">,</span> <span class="n">RS_XHOI</span> <span class="p">,</span> <span class="n">RS_NHEI</span><span class="p">]</span>

<span class="n">RS_XBAI_dam1</span> <span class="o">=</span> <span class="s1">&#39;GATCTAGA&#39;</span>
<span class="n">RS_XBAI_dam2</span> <span class="o">=</span> <span class="s1">&#39;TCTAGATC&#39;</span>
<span class="n">RS_XBAI_dam1_pre</span> <span class="o">=</span> <span class="s1">&#39;^GA&#39;</span>
<span class="n">RS_XBAI_dam2_suf</span> <span class="o">=</span> <span class="s1">&#39;TC$&#39;</span>
<span class="n">LETTERS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4C-check-if-the-mpra-restriction-enzymes-(and-then-remove-sequences-that-don't-pass-rs-checking">4C check if the mpra restriction enzymes (and then remove sequences that don't pass rs checking<a class="anchor-link" href="#4C-check-if-the-mpra-restriction-enzymes-(and-then-remove-sequences-that-don't-pass-rs-checking">&#182;</a></h2><p>revision: replace XbaI with NcoI b/c dam methylation of Xba (NcoI pairs with XhoI, in the second restriction digest)</p>
<p>not if the restriction site is NOT the sequence area manually change the sequence</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[155]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">check_rs</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">rs_list</span> <span class="o">=</span> <span class="n">RS_LIST</span><span class="p">):</span>
    <span class="n">rs_sites</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">rs</span> <span class="ow">in</span> <span class="n">rs_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rs</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
            <span class="n">rs_sites</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">rs_sites</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1183]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span><span class="s1">&#39;check_rs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_rs</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1183]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((340, 20), (4586, 20))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1184]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1184]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>NFIC::RARG    10
CBFB::IRF8    10
Name: vocab_pair, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>507 of the 4691 instances are bad . But only all vocab words have at least 10 genomic instances</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1185]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># controls</span>
<span class="n">pos_genes_df</span><span class="p">[</span><span class="s1">&#39;check_rs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos_genes_df</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_rs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos_genes_df</span><span class="p">[</span><span class="n">pos_genes_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">pos_genes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">neg_genes_df</span><span class="p">[</span><span class="s1">&#39;check_rs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">check_rs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">neg_genes_df</span><span class="p">[</span><span class="n">neg_genes_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">neg_genes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(13, 6) (85, 6)
(6, 6) (95, 6)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1186]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># new dataframes</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df</span><span class="p">[</span><span class="n">vocab_instances20_alltissue_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pos_genes_df_rs_filt</span> <span class="o">=</span> <span class="n">pos_genes_df</span><span class="p">[</span><span class="n">pos_genes_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="n">neg_genes_df_rs_filt</span> <span class="o">=</span> <span class="n">neg_genes_df</span><span class="p">[</span><span class="n">neg_genes_df</span><span class="o">.</span><span class="n">check_rs</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos_genes_df_rs_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">neg_genes_df_rs_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_alltissue_df_wseq_rsfilt.csv&#39;</span><span class="p">))</span>
<span class="n">pos_genes_df_rs_filt</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;pos_genes_position_wseq_rsfilt.csv&#39;</span><span class="p">))</span>
<span class="n">neg_genes_df_rs_filt</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;neg_genes_position_wseq_rsfilt.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(4246, 20)
(72, 6)
(89, 6)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1187]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[[</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1187]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>BATF::KLF15       20
NFE2L1::ZBTB49    20
IRF8::STAT1       20
FOXL1::PRRX1      20
SP1::TBX1         20
                  ..
IRF4::PLAG1       12
IKZF1::IRF2       12
FOXM1::SP2        11
NFIC::RARG        10
CBFB::IRF8        10
Name: vocab_pair, Length: 239, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>all vocab instances have at least 10 genomic sites</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="5.-scramble-sequences-(vocab-words)">5. scramble sequences (vocab words)<a class="anchor-link" href="#5.-scramble-sequences-(vocab-words)">&#182;</a></h1><p>test a max of <code>MAX_ITER</code> times,</p>
<p>options:</p>
<ul>
<li>scramble only the motif</li>
<li>scramble the 10 bp window around the motif</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5A-get-the-scrambles">5A get the scrambles<a class="anchor-link" href="#5A-get-the-scrambles">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[161]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_alltissue_df_wseq_rsfilt.csv&#39;</span><span class="p">),</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[162]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[162]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;vocab_pair&#39;, &#39;tot_dist&#39;, &#39;btn_dist&#39;, &#39;chr&#39;, &#39;start&#39;, &#39;stop&#39;, &#39;vocab1&#39;,
       &#39;vocab1_start&#39;, &#39;vocab1_stop&#39;, &#39;vocab2&#39;, &#39;vocab2_start&#39;, &#39;vocab2_stop&#39;,
       &#39;tissue&#39;, &#39;loop_type&#39;, &#39;start_pad&#39;, &#39;stop_pad&#39;, &#39;vocab_tissue_count&#39;,
       &#39;name&#39;, &#39;sequence&#39;, &#39;check_rs&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[163]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[163]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([135])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[164]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[164]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>vocab1_stop</th>
      <th>vocab2</th>
      <th>vocab2_start</th>
      <th>vocab2_stop</th>
      <th>tissue</th>
      <th>loop_type</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>sequence</th>
      <th>check_rs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>BARX2::FOXF2</td>
      <td>28</td>
      <td>14</td>
      <td>chr1</td>
      <td>206848337</td>
      <td>206848365</td>
      <td>BARX2</td>
      <td>206848337</td>
      <td>206848341</td>
      <td>FOXF2</td>
      <td>206848355</td>
      <td>206848365</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>206848284</td>
      <td>206848418</td>
      <td>1</td>
      <td>BARX2::FOXF2+Colon+1</td>
      <td>CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>BARX2::FOXF2</td>
      <td>54</td>
      <td>40</td>
      <td>chr4</td>
      <td>38859601</td>
      <td>38859655</td>
      <td>FOXF2</td>
      <td>38859601</td>
      <td>38859611</td>
      <td>BARX2</td>
      <td>38859651</td>
      <td>38859655</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>38859561</td>
      <td>38859695</td>
      <td>2</td>
      <td>BARX2::FOXF2+Colon+2</td>
      <td>GTGGCTCTGAGGGAATTTCAAGTAACCGTGGACTAAAGTCTTAAGA...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>BARX2::FOXF2</td>
      <td>46</td>
      <td>32</td>
      <td>chr6</td>
      <td>74222776</td>
      <td>74222822</td>
      <td>FOXF2</td>
      <td>74222776</td>
      <td>74222786</td>
      <td>BARX2</td>
      <td>74222818</td>
      <td>74222822</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>74222732</td>
      <td>74222866</td>
      <td>3</td>
      <td>BARX2::FOXF2+Colon+3</td>
      <td>GCCACTGCACTCCAGCCTGGTGACAGAGCGAGACTCTGTCTCAAGA...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr3</td>
      <td>49384674</td>
      <td>49384690</td>
      <td>FOXF2</td>
      <td>49384674</td>
      <td>49384684</td>
      <td>BARX2</td>
      <td>49384686</td>
      <td>49384690</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>49384615</td>
      <td>49384749</td>
      <td>4</td>
      <td>BARX2::FOXF2+Colon+4</td>
      <td>AGTATTATGTGCTCATGGTCCCTACCCTCCAGGGTTCACAGTGTGG...</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr10</td>
      <td>112247520</td>
      <td>112247536</td>
      <td>BARX2</td>
      <td>112247520</td>
      <td>112247524</td>
      <td>FOXF2</td>
      <td>112247526</td>
      <td>112247536</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>112247461</td>
      <td>112247595</td>
      <td>5</td>
      <td>BARX2::FOXF2+Colon+5</td>
      <td>ATGTGGCTGCGGGGCTTTAGGAGCTGACTCTTTGGTCACGGGGAGA...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[165]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># motif_bed = pybedtools.BedTool(&#39;../data/raw/merged_motif_scan/Colon_merged.bed&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %%time</span>
<span class="c1"># motif_bed.to_dataframe()[:5]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[167]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[168]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %%time</span>
<span class="c1"># pybedtools.BedTool.from_dataframe(pd.DataFrame(row[[&#39;chr&#39;,&#39;start_pad&#39;,&#39;stop_pad&#39;]]).T).intersect(motif_bed,wa=True,wb=True)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[169]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[169]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>vocab_pair                                                 BARX2::FOXF2
tot_dist                                                             28
btn_dist                                                             14
chr                                                                chr1
start                                                         206848337
stop                                                          206848365
vocab1                                                            BARX2
vocab1_start                                                  206848337
vocab1_stop                                                   206848341
vocab2                                                            FOXF2
vocab2_start                                                  206848355
vocab2_stop                                                   206848365
tissue                                                            Colon
loop_type                                                       pro_pro
start_pad                                                     206848284
stop_pad                                                      206848418
vocab_tissue_count                                                    1
name                                               BARX2::FOXF2+Colon+1
sequence              CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...
check_rs                                                              0
Name: 0, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[170]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;../data/raw/merged_motif_scan/*&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[170]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;../data/raw/merged_motif_scan/COLO-SCR-DMSO_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Icon\r&#39;,
 &#39;../data/raw/merged_motif_scan/Renal_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Prostate_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Uterine_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/GDSD6_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Pancreas_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/SCC13-CTRLi_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Melanocytes_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Ovarian_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Bladder_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/GDSD3_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Esophageal_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/A431-CTRLi_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/GM12878_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Astrocytes_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Colon_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/WM2664-SCR-DMSO_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/GDSD0_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/CAL27-CTRLi_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Thyroid_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/Airway_merged.bed&#39;,
 &#39;../data/raw/merged_motif_scan/HMEC_merged.bed&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[171]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">MAX_ITER</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[189]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="k">import</span> <span class="n">shuffle</span>

<span class="k">def</span> <span class="nf">mixup</span><span class="p">(</span><span class="n">word</span><span class="p">):</span>
    <span class="n">as_list_of_letters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="n">shuffle</span><span class="p">(</span><span class="n">as_list_of_letters</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">as_list_of_letters</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_scrambles</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">motif_len_scr</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># getting vocab locations in the sequence</span>
    <span class="n">vocab1_med</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_start&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">vocab1_start_shift</span> <span class="o">=</span> <span class="n">vocab1_med</span> <span class="o">-</span> <span class="n">motif_len_scr</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span>
    <span class="n">vocab1_stop_shift</span> <span class="o">=</span> <span class="n">vocab1_med</span> <span class="o">+</span> <span class="n">motif_len_scr</span> <span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="n">vocab2_med</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2_start&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2_stop&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">vocab2_start_shift</span> <span class="o">=</span> <span class="n">vocab2_med</span> <span class="o">-</span> <span class="n">motif_len_scr</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span>
    <span class="n">vocab2_stop_shift</span> <span class="o">=</span> <span class="n">vocab2_med</span> <span class="o">+</span> <span class="n">motif_len_scr</span> <span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="c1"># for overlaps</span>
    <span class="k">if</span> <span class="n">vocab1_stop_shift</span><span class="o">&gt;=</span> <span class="n">vocab2_start_shift</span><span class="p">:</span>
<span class="c1">#         print(idx)</span>
<span class="c1">#         print(row)</span>
        
        <span class="c1"># case 1 vocab words are really close, the padding goes into the vocab word</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">vocab2_start_shift</span><span class="p">:</span>
            
            <span class="n">vocab1_stop_shift</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">vocab2_start_shift</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1">#             print(vocab1_start_shift,vocab1_stop_shift, vocab2_start_shift, vocab2_stop_shift)</span>
<span class="c1">#             raise</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">vocab1_stop_shift</span> <span class="o">=</span> <span class="n">vocab1_stop_shift</span>
            <span class="n">vocab2_start_shift</span> <span class="o">=</span> <span class="n">vocab1_stop_shift</span>
<span class="c1">#             print(vocab1_start_shift,vocab1_stop_shift, vocab2_start_shift, vocab2_stop_shift)</span>
<span class="c1">#             raise</span>
    <span class="c1"># for edges:</span>
    <span class="n">vocab1_start_shift</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">vocab1_start_shift</span><span class="p">)</span>
    <span class="n">vocab2_stop_shift</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]),</span><span class="n">vocab2_stop_shift</span><span class="p">)</span>
    
    
    <span class="c1"># get sequences</span>
    <span class="n">vocab1_seq</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">vocab1_start_shift</span><span class="p">:</span><span class="n">vocab1_stop_shift</span><span class="p">]</span>
    <span class="n">vocab2_seq</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">vocab2_start_shift</span><span class="p">:</span><span class="n">vocab2_stop_shift</span><span class="p">]</span>

    <span class="n">vocab1_seq_scr</span> <span class="o">=</span> <span class="n">mixup</span><span class="p">(</span><span class="n">vocab1_seq</span><span class="p">)</span>
    <span class="n">vocab2_seq_scr</span> <span class="o">=</span> <span class="n">mixup</span><span class="p">(</span><span class="n">vocab2_seq</span><span class="p">)</span>

    <span class="n">A_B_seq</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">]</span>
    <span class="n">scrA_B_seq</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][:</span><span class="n">vocab1_start_shift</span><span class="p">]</span> <span class="o">+</span> <span class="n">vocab1_seq_scr</span> <span class="o">+</span>  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">vocab1_stop_shift</span><span class="p">:]</span>
    <span class="n">A_scrB_seq</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][:</span><span class="n">vocab2_start_shift</span><span class="p">]</span> <span class="o">+</span> <span class="n">vocab2_seq_scr</span> <span class="o">+</span>  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">vocab2_stop_shift</span><span class="p">:]</span>
    <span class="n">scrA_scrB_seq</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][:</span><span class="n">vocab1_start_shift</span><span class="p">]</span> <span class="o">+</span> <span class="n">vocab1_seq_scr</span> <span class="o">+</span>  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">vocab1_stop_shift</span><span class="p">:</span><span class="n">vocab2_start_shift</span><span class="p">]</span> <span class="o">+</span> <span class="n">vocab2_seq_scr</span> <span class="o">+</span>  <span class="n">row</span><span class="p">[</span><span class="s1">&#39;sequence&#39;</span><span class="p">][</span><span class="n">vocab2_stop_shift</span><span class="p">:]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scrA_scrB_seq</span><span class="p">)</span><span class="o">!=</span><span class="mi">135</span><span class="p">:</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">vocab1_start_shift</span><span class="p">,</span> <span class="n">vocab1_stop_shift</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vocab1_seq_scr&#39;</span><span class="p">,</span><span class="n">vocab1_seq_scr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">vocab2_start_shift</span><span class="p">,</span> <span class="n">vocab2_stop_shift</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vocab2_seq_scr&#39;</span><span class="p">,</span><span class="n">vocab2_seq_scr</span><span class="p">)</span>
        
        <span class="k">raise</span>
<span class="c1">#     if vocab1_stop_shift&lt; vocab2_start_shift:</span>
<span class="c1">#         scrA_scrB_seq = row[&#39;sequence&#39;][:vocab1_start_shift] + vocab1_seq_scr +  row[&#39;sequence&#39;][vocab1_stop_shift:vocab2_start_shift] + vocab2_seq_scr +  row[&#39;sequence&#39;][vocab2_stop_shift:]</span>
<span class="c1">#     else: # if the 10 bp windows for vocab1 and vocab2 overlap</span>
<span class="c1">#         vocab12_seq = row[&#39;sequence&#39;][vocab1_start_shift:vocab2_stop_shift]</span>
<span class="c1">#         vocab12_seq_scr = mixup(vocab12_seq)</span>
<span class="c1">#         scrA_scrB_seq = row[&#39;sequence&#39;][:vocab1_start_shift] + vocab12_seq_scr +  row[&#39;sequence&#39;][vocab2_stop_shift:]</span>
        

<span class="c1">#     # FOR DEBUG</span>
<span class="c1">#     print(A_B_seq)</span>
<span class="c1">#     print(scrA_B_seq)</span>
<span class="c1">#     print(A_scrB_seq)</span>
<span class="c1">#     print(scrA_scrB_seq)</span>

    <span class="k">return</span> <span class="n">A_B_seq</span><span class="p">,</span> <span class="n">scrA_B_seq</span><span class="p">,</span> <span class="n">A_scrB_seq</span><span class="p">,</span> <span class="n">scrA_scrB_seq</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ### tesin</span>
<span class="c1"># row = vocab_instances20_alltissue_df_rs_filt.iloc[100,:]</span>
<span class="c1"># print(row)</span>
<span class="c1"># motif_len_scr=10</span>
<span class="c1"># vocab1_med = int((row[&#39;vocab1_start&#39;]+row[&#39;vocab1_stop&#39;])/2)</span>
<span class="c1"># vocab1_start_shift = vocab1_med - motif_len_scr - row[&#39;start_pad&#39;]</span>
<span class="c1"># vocab1_stop_shift = vocab1_med + motif_len_scr -row[&#39;start_pad&#39;] + 1</span>
<span class="c1"># vocab2_med = int((row[&#39;vocab2_start&#39;]+row[&#39;vocab2_stop&#39;])/2)</span>
<span class="c1"># vocab2_start_shift = vocab2_med - motif_len_scr - row[&#39;start_pad&#39;]</span>
<span class="c1"># vocab2_stop_shift = vocab2_med + motif_len_scr -row[&#39;start_pad&#39;] + 1</span>

<span class="c1"># print(vocab1_start_shift,vocab1_stop_shift, vocab2_start_shift, vocab2_stop_shift)</span>
<span class="c1"># get_scrambles(row)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## iterate through the rows of the rs_filt vocab dataframe vocab_instances20_alltissue_df_rs_filt</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="s1">&#39;scr_pass_rs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="s1">&#39;A_B_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="s1">&#39;scrA_B_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="s1">&#39;A_scrB_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="s1">&#39;scrA_scrB_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="c1">## DEBUG</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">idx</span><span class="o">%</span><span class="k">100</span>)==0:
        <span class="nb">print</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    
    <span class="c1"># set default</span>
    <span class="n">scr_pass_rs</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">num_iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># iterate scrambles until find some that pass the check_rs filter</span>
    <span class="k">while</span> <span class="p">(</span><span class="ow">not</span> <span class="n">scr_pass_rs</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">num_iter</span> <span class="o">&gt;</span> <span class="n">MAX_ITER</span><span class="p">):</span>
        <span class="n">A_B_seq</span><span class="p">,</span> <span class="n">scrA_B_seq</span><span class="p">,</span> <span class="n">A_scrB_seq</span><span class="p">,</span> <span class="n">scrA_scrB_seq</span> <span class="o">=</span> <span class="n">get_scrambles</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>



        <span class="c1"># check_rs</span>
        <span class="n">A_B_seq_rs</span> <span class="o">=</span> <span class="n">check_rs</span><span class="p">(</span><span class="n">A_B_seq</span><span class="p">)</span>
        <span class="n">scrA_B_seq_rs</span> <span class="o">=</span> <span class="n">check_rs</span><span class="p">(</span><span class="n">scrA_B_seq</span><span class="p">)</span>
        <span class="n">A_scrB_seq_rs</span> <span class="o">=</span> <span class="n">check_rs</span><span class="p">(</span><span class="n">A_scrB_seq</span><span class="p">)</span>
        <span class="n">scrA_scrB_seq_rs</span> <span class="o">=</span> <span class="n">check_rs</span><span class="p">(</span><span class="n">scrA_scrB_seq</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">A_B_seq_rs</span><span class="o">+</span><span class="n">scrA_B_seq_rs</span><span class="o">+</span><span class="n">A_scrB_seq_rs</span><span class="o">+</span><span class="n">scrA_scrB_seq_rs</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
            <span class="n">scr_pass_rs</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">num_iter</span><span class="o">+=</span><span class="mi">1</span>
    
    <span class="c1"># add information to df</span>
    <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;scr_pass_rs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scr_pass_rs</span>
    <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;A_B_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_B_seq</span>
    <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;scrA_B_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scrA_B_seq</span>
    <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;A_scrB_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_scrB_seq</span>
    <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s1">&#39;scrA_scrB_seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scrA_scrB_seq</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(4246, 25)
0
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
1500
1600
1700
1800
1900
2000
2100
2200
2300
2400
2500
2600
2700
2800
2900
3000
3100
3200
3300
3400
3500
3600
3700
3800
3900
4000
4100
4200
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[195]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># manual step</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">scr_pass_rs</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[195]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>True    4246
Name: scr_pass_rs, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>all sequences and scr configurations pass the rs filter</p>
<p>if they don't keep running the scrambling until they all pass</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[196]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span> <span class="s1">&#39;vocab_tissue_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;tissue&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">cumcount</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span>
<span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">vocab_pair</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span><span class="o">+</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">tissue</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span><span class="o">+</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">vocab_tissue_count</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">vocab_instances20_seqs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;sequence&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
         <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;btn_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">,</span> <span class="s1">&#39;start_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;vocab1&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1_start&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1_stop&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_start&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_stop&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;tissue&#39;</span><span class="p">,</span> <span class="s1">&#39;loop_type&#39;</span><span class="p">,</span>  <span class="s1">&#39;vocab_tissue_count&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;check_rs&#39;</span><span class="p">,</span><span class="s1">&#39;scr_pass_rs&#39;</span><span class="p">],</span> 
            <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;seq_config&#39;</span><span class="p">,</span>
             <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;seq&quot;</span><span class="p">)</span>

<span class="n">vocab_instances20_seqs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[196]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>...</th>
      <th>vocab2_start</th>
      <th>vocab2_stop</th>
      <th>tissue</th>
      <th>loop_type</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>check_rs</th>
      <th>scr_pass_rs</th>
      <th>seq_config</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>BARX2::FOXF2</td>
      <td>28</td>
      <td>14</td>
      <td>chr1</td>
      <td>206848337</td>
      <td>206848365</td>
      <td>206848284</td>
      <td>206848418</td>
      <td>BARX2</td>
      <td>206848337</td>
      <td>...</td>
      <td>206848355</td>
      <td>206848365</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>1</td>
      <td>BARX2::FOXF2+Colon+1</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...</td>
    </tr>
    <tr>
      <td>1</td>
      <td>BARX2::FOXF2</td>
      <td>54</td>
      <td>40</td>
      <td>chr4</td>
      <td>38859601</td>
      <td>38859655</td>
      <td>38859561</td>
      <td>38859695</td>
      <td>FOXF2</td>
      <td>38859601</td>
      <td>...</td>
      <td>38859651</td>
      <td>38859655</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>2</td>
      <td>BARX2::FOXF2+Colon+2</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>GTGGCTCTGAGGGAATTTCAAGTAACCGTGGACTAAAGTCTTAAGA...</td>
    </tr>
    <tr>
      <td>2</td>
      <td>BARX2::FOXF2</td>
      <td>46</td>
      <td>32</td>
      <td>chr6</td>
      <td>74222776</td>
      <td>74222822</td>
      <td>74222732</td>
      <td>74222866</td>
      <td>FOXF2</td>
      <td>74222776</td>
      <td>...</td>
      <td>74222818</td>
      <td>74222822</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>3</td>
      <td>BARX2::FOXF2+Colon+3</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>GCCACTGCACTCCAGCCTGGTGACAGAGCGAGACTCTGTCTCAAGA...</td>
    </tr>
    <tr>
      <td>3</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr3</td>
      <td>49384674</td>
      <td>49384690</td>
      <td>49384615</td>
      <td>49384749</td>
      <td>FOXF2</td>
      <td>49384674</td>
      <td>...</td>
      <td>49384686</td>
      <td>49384690</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>4</td>
      <td>BARX2::FOXF2+Colon+4</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>AGTATTATGTGCTCATGGTCCCTACCCTCCAGGGTTCACAGTGTGG...</td>
    </tr>
    <tr>
      <td>4</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr10</td>
      <td>112247520</td>
      <td>112247536</td>
      <td>112247461</td>
      <td>112247595</td>
      <td>BARX2</td>
      <td>112247520</td>
      <td>...</td>
      <td>112247526</td>
      <td>112247536</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>5</td>
      <td>BARX2::FOXF2+Colon+5</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>ATGTGGCTGCGGGGCTTTAGGAGCTGACTCTTTGGTCACGGGGAGA...</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>16979</td>
      <td>STAT1::UBP1</td>
      <td>28</td>
      <td>7</td>
      <td>chr2</td>
      <td>65648057</td>
      <td>65648085</td>
      <td>65648004</td>
      <td>65648138</td>
      <td>UBP1</td>
      <td>65648057</td>
      <td>...</td>
      <td>65648069</td>
      <td>65648085</td>
      <td>MM</td>
      <td>loop_loop</td>
      <td>16</td>
      <td>STAT1::UBP1+MM+16</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>AGAGATTTAAACATCATCATCTTGATTCCCAGTAACAACAATGCTG...</td>
    </tr>
    <tr>
      <td>16980</td>
      <td>STAT1::UBP1</td>
      <td>32</td>
      <td>14</td>
      <td>chr1</td>
      <td>24106333</td>
      <td>24106365</td>
      <td>24106282</td>
      <td>24106416</td>
      <td>UBP1</td>
      <td>24106333</td>
      <td>...</td>
      <td>24106352</td>
      <td>24106365</td>
      <td>MM</td>
      <td>pro_pro</td>
      <td>17</td>
      <td>STAT1::UBP1+MM+17</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TTGCCCAGGGTCACACAACTAAACAGGTATTCAAACTCAGGTTCCC...</td>
    </tr>
    <tr>
      <td>16981</td>
      <td>STAT1::UBP1</td>
      <td>35</td>
      <td>14</td>
      <td>chr7</td>
      <td>114551357</td>
      <td>114551392</td>
      <td>114551307</td>
      <td>114551441</td>
      <td>UBP1</td>
      <td>114551357</td>
      <td>...</td>
      <td>114551376</td>
      <td>114551392</td>
      <td>MM</td>
      <td>loop_loop</td>
      <td>18</td>
      <td>STAT1::UBP1+MM+18</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TCATTAGTGGGCTTTCAAAATACCAGCTTCTTGGTTACTGAGACAC...</td>
    </tr>
    <tr>
      <td>16982</td>
      <td>STAT1::UBP1</td>
      <td>28</td>
      <td>7</td>
      <td>chr1</td>
      <td>120178558</td>
      <td>120178586</td>
      <td>120178505</td>
      <td>120178639</td>
      <td>STAT1</td>
      <td>120178558</td>
      <td>...</td>
      <td>120178581</td>
      <td>120178586</td>
      <td>MM</td>
      <td>pro_pro</td>
      <td>19</td>
      <td>STAT1::UBP1+MM+19</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TCATATCACACTACGAAGAGAGCAACTAGAAGATATTATGCTCCTA...</td>
    </tr>
    <tr>
      <td>16983</td>
      <td>STAT1::UBP1</td>
      <td>25</td>
      <td>7</td>
      <td>chr9</td>
      <td>132360293</td>
      <td>132360318</td>
      <td>132360238</td>
      <td>132360372</td>
      <td>UBP1</td>
      <td>132360293</td>
      <td>...</td>
      <td>132360305</td>
      <td>132360318</td>
      <td>MM</td>
      <td>loop_loop</td>
      <td>20</td>
      <td>STAT1::UBP1+MM+20</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>GCTTCCTGCATCAGCCAAGCCCTGCCCGCAGTGTAACCCGTGGTCC...</td>
    </tr>
  </tbody>
</table>
<p>16984 rows  22 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[197]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>array([135])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[198]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># save the vocab info</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_seq_wscr.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(16984, 22) (4246, 25)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[199]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[199]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;vocab_pair&#39;, &#39;tot_dist&#39;, &#39;btn_dist&#39;, &#39;chr&#39;, &#39;start&#39;, &#39;stop&#39;,
       &#39;start_pad&#39;, &#39;stop_pad&#39;, &#39;vocab1&#39;, &#39;vocab1_start&#39;, &#39;vocab1_stop&#39;,
       &#39;vocab2&#39;, &#39;vocab2_start&#39;, &#39;vocab2_stop&#39;, &#39;tissue&#39;, &#39;loop_type&#39;,
       &#39;vocab_tissue_count&#39;, &#39;name&#39;, &#39;check_rs&#39;, &#39;scr_pass_rs&#39;, &#39;seq_config&#39;,
       &#39;seq&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5B-only-pick-10-best-sequences-(vocab)-add-the-controls-for-final-df">5B only pick 10 best sequences (vocab) add the controls for final df<a class="anchor-link" href="#5B-only-pick-10-best-sequences-(vocab)-add-the-controls-for-final-df">&#182;</a></h2><p>Input DFs:</p>
<ul>
<li><code>vocab_instances20_seqs</code>: <code>vocab_instances20_seq_wscr.csv</code></li>
<li><code>pos_genes_df_rs_filt</code>: <code>pos_genes_position_wseq_rsfilt.csv</code></li>
<li><code>neg_genes_df_rs_filt</code>: <code>neg_genes_position_wseq_rsfilt.csv</code></li>
</ul>
<p>Output DF:</p>
<ul>
<li><code>mpra_lib_seq</code>: 'mpra_lib_seq.csv`</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[200]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs</span><span class="p">[[</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;tissue&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[200]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(239, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>still have 239 vocab words</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[201]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs</span><span class="p">[</span><span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">vocab_tissue_count</span><span class="o">==</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[201]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(239,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>all 239 vocab words have at least 10 genomic instances</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span><span class="p">[</span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span><span class="o">!=</span><span class="mi">135</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[202]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>...</th>
      <th>vocab2_stop</th>
      <th>tissue</th>
      <th>loop_type</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>check_rs</th>
      <th>scr_pass_rs</th>
      <th>seq_config</th>
      <th>seq</th>
      <th>name_config</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4413</td>
      <td>FOXM1::SP2</td>
      <td>131</td>
      <td>110</td>
      <td>chr16</td>
      <td>68268437</td>
      <td>68268568</td>
      <td>68268435</td>
      <td>68268569</td>
      <td>SP2</td>
      <td>68268437</td>
      <td>...</td>
      <td>68268568</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>8</td>
      <td>FOXM1::SP2+Colon+8</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_B_seq</td>
      <td>GCAGCCCCGCCTCCAGGTCTGACCAACCGAGGGGCAGAGAAACTCC...</td>
      <td>FOXM1::SP2+Colon+8+scrA_B</td>
    </tr>
    <tr>
      <td>4425</td>
      <td>FOXM1::SP4</td>
      <td>131</td>
      <td>107</td>
      <td>chr16</td>
      <td>68268437</td>
      <td>68268568</td>
      <td>68268435</td>
      <td>68268569</td>
      <td>SP4</td>
      <td>68268437</td>
      <td>...</td>
      <td>68268568</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>9</td>
      <td>FOXM1::SP4+Colon+9</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_B_seq</td>
      <td>GCAGCCCCGCCTCCAGGTCTGACCAACCGAGGGGCAGAGAAACTCC...</td>
      <td>FOXM1::SP4+Colon+9+scrA_B</td>
    </tr>
    <tr>
      <td>4624</td>
      <td>KLF5::RUNX3</td>
      <td>123</td>
      <td>105</td>
      <td>chr1</td>
      <td>6259618</td>
      <td>6259741</td>
      <td>6259612</td>
      <td>6259746</td>
      <td>RUNX3</td>
      <td>6259618</td>
      <td>...</td>
      <td>6259741</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>9</td>
      <td>KLF5::RUNX3+Colon+9</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_B_seq</td>
      <td>CCATACTAACCACAGGAGCCATGGCGGCAGCGGAGTTAGAAAGGGA...</td>
      <td>KLF5::RUNX3+Colon+9+scrA_B</td>
    </tr>
    <tr>
      <td>4625</td>
      <td>KLF5::RUNX3</td>
      <td>123</td>
      <td>105</td>
      <td>chr1</td>
      <td>6259618</td>
      <td>6259741</td>
      <td>6259612</td>
      <td>6259746</td>
      <td>RUNX3</td>
      <td>6259618</td>
      <td>...</td>
      <td>6259741</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>10</td>
      <td>KLF5::RUNX3+Colon+10</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_B_seq</td>
      <td>CCATACTAACCACAGGAGCCATGGCGGCAGCGGAGTTAGAAAGGGA...</td>
      <td>KLF5::RUNX3+Colon+10+scrA_B</td>
    </tr>
    <tr>
      <td>4734</td>
      <td>MSX2::THAP1</td>
      <td>121</td>
      <td>95</td>
      <td>chr11</td>
      <td>102177000</td>
      <td>102177121</td>
      <td>102176993</td>
      <td>102177127</td>
      <td>MSX2</td>
      <td>102177000</td>
      <td>...</td>
      <td>102177121</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>10</td>
      <td>MSX2::THAP1+Colon+10</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_B_seq</td>
      <td>AATGGTGAAATTAGTAATCATCCCAGCTGGTATAATACTGAATTGT...</td>
      <td>MSX2::THAP1+Colon+10+scrA_B</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>14903</td>
      <td>IRF8::ZNF816</td>
      <td>128</td>
      <td>106</td>
      <td>chr9</td>
      <td>134604524</td>
      <td>134604652</td>
      <td>134604521</td>
      <td>134604655</td>
      <td>ZNF816</td>
      <td>134604524</td>
      <td>...</td>
      <td>134604652</td>
      <td>GM12878</td>
      <td>loop_loop</td>
      <td>9</td>
      <td>IRF8::ZNF816+GM12878+9</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>CCCAGGGGCCATGAGGCAGGTCTCCCACCTCTCAGCTCAGGCTCAT...</td>
      <td>IRF8::ZNF816+GM12878+9+scrA_scrB</td>
    </tr>
    <tr>
      <td>14904</td>
      <td>IRF8::ZNF816</td>
      <td>134</td>
      <td>101</td>
      <td>chr22</td>
      <td>39337645</td>
      <td>39337779</td>
      <td>39337645</td>
      <td>39337779</td>
      <td>IRF8</td>
      <td>39337645</td>
      <td>...</td>
      <td>39337779</td>
      <td>GM12878</td>
      <td>loop_loop</td>
      <td>10</td>
      <td>IRF8::ZNF816+GM12878+10</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TGGTTTTAGTTCCTTGGGTGGTTTCCTCGGGGAACCACTATTTCTT...</td>
      <td>IRF8::ZNF816+GM12878+10+scrA_scrB</td>
    </tr>
    <tr>
      <td>15290</td>
      <td>MITF::ZNF589</td>
      <td>123</td>
      <td>110</td>
      <td>chr11</td>
      <td>62446468</td>
      <td>62446591</td>
      <td>62446462</td>
      <td>62446596</td>
      <td>ZNF589</td>
      <td>62446468</td>
      <td>...</td>
      <td>62446591</td>
      <td>Melanocytes</td>
      <td>loop_loop</td>
      <td>1</td>
      <td>MITF::ZNF589+Melanocytes+1</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>GCGAGGCAACCCGCCCTCGACACCCGCCGACGGGCGCTCGCTCTCT...</td>
      <td>MITF::ZNF589+Melanocytes+1+scrA_scrB</td>
    </tr>
    <tr>
      <td>16351</td>
      <td>EGR2::SOX10</td>
      <td>127</td>
      <td>109</td>
      <td>chr9</td>
      <td>38381691</td>
      <td>38381818</td>
      <td>38381687</td>
      <td>38381821</td>
      <td>EGR2</td>
      <td>38381691</td>
      <td>...</td>
      <td>38381818</td>
      <td>MM</td>
      <td>loop_loop</td>
      <td>8</td>
      <td>EGR2::SOX10+MM+8</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>AGGTGCCACCTCCACTCTGTCCTCACGGCCCTTGGCCTGGGACCCC...</td>
      <td>EGR2::SOX10+MM+8+scrA_scrB</td>
    </tr>
    <tr>
      <td>16522</td>
      <td>LEF1::NFAT5</td>
      <td>132</td>
      <td>117</td>
      <td>chr7</td>
      <td>16783057</td>
      <td>16783189</td>
      <td>16783056</td>
      <td>16783190</td>
      <td>NFAT5</td>
      <td>16783057</td>
      <td>...</td>
      <td>16783189</td>
      <td>MM</td>
      <td>pro_pro</td>
      <td>1</td>
      <td>LEF1::NFAT5+MM+1</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TATTTCCAAAAACTCTGTGTCTTTGTCGTAGGTTGTATCTAGTAGA...</td>
      <td>LEF1::NFAT5+MM+1+scrA_scrB</td>
    </tr>
  </tbody>
</table>
<p>74 rows  23 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>all vocab genomic i</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[203]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span><span class="p">[</span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;FOX&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[203]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>...</th>
      <th>vocab2_stop</th>
      <th>tissue</th>
      <th>loop_type</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>check_rs</th>
      <th>scr_pass_rs</th>
      <th>seq_config</th>
      <th>seq</th>
      <th>name_config</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>BARX2::FOXF2</td>
      <td>28</td>
      <td>14</td>
      <td>chr1</td>
      <td>206848337</td>
      <td>206848365</td>
      <td>206848284</td>
      <td>206848418</td>
      <td>BARX2</td>
      <td>206848337</td>
      <td>...</td>
      <td>206848365</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>1</td>
      <td>BARX2::FOXF2+Colon+1</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...</td>
      <td>BARX2::FOXF2+Colon+1+A_B</td>
    </tr>
    <tr>
      <td>1</td>
      <td>BARX2::FOXF2</td>
      <td>54</td>
      <td>40</td>
      <td>chr4</td>
      <td>38859601</td>
      <td>38859655</td>
      <td>38859561</td>
      <td>38859695</td>
      <td>FOXF2</td>
      <td>38859601</td>
      <td>...</td>
      <td>38859655</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>2</td>
      <td>BARX2::FOXF2+Colon+2</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>GTGGCTCTGAGGGAATTTCAAGTAACCGTGGACTAAAGTCTTAAGA...</td>
      <td>BARX2::FOXF2+Colon+2+A_B</td>
    </tr>
    <tr>
      <td>2</td>
      <td>BARX2::FOXF2</td>
      <td>46</td>
      <td>32</td>
      <td>chr6</td>
      <td>74222776</td>
      <td>74222822</td>
      <td>74222732</td>
      <td>74222866</td>
      <td>FOXF2</td>
      <td>74222776</td>
      <td>...</td>
      <td>74222822</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>3</td>
      <td>BARX2::FOXF2+Colon+3</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>GCCACTGCACTCCAGCCTGGTGACAGAGCGAGACTCTGTCTCAAGA...</td>
      <td>BARX2::FOXF2+Colon+3+A_B</td>
    </tr>
    <tr>
      <td>3</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr3</td>
      <td>49384674</td>
      <td>49384690</td>
      <td>49384615</td>
      <td>49384749</td>
      <td>FOXF2</td>
      <td>49384674</td>
      <td>...</td>
      <td>49384690</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>4</td>
      <td>BARX2::FOXF2+Colon+4</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>AGTATTATGTGCTCATGGTCCCTACCCTCCAGGGTTCACAGTGTGG...</td>
      <td>BARX2::FOXF2+Colon+4+A_B</td>
    </tr>
    <tr>
      <td>4</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr10</td>
      <td>112247520</td>
      <td>112247536</td>
      <td>112247461</td>
      <td>112247595</td>
      <td>BARX2</td>
      <td>112247520</td>
      <td>...</td>
      <td>112247536</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>5</td>
      <td>BARX2::FOXF2+Colon+5</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>ATGTGGCTGCGGGGCTTTAGGAGCTGACTCTTTGGTCACGGGGAGA...</td>
      <td>BARX2::FOXF2+Colon+5+A_B</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>15125</td>
      <td>FOXL1::PRRX1</td>
      <td>33</td>
      <td>13</td>
      <td>chr17</td>
      <td>45908368</td>
      <td>45908401</td>
      <td>45908317</td>
      <td>45908451</td>
      <td>PRRX1</td>
      <td>45908368</td>
      <td>...</td>
      <td>45908401</td>
      <td>Melanocytes</td>
      <td>pro_pro</td>
      <td>6</td>
      <td>FOXL1::PRRX1+Melanocytes+6</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TTTAAATGAGCTAACACATATAAAAATAGTTATCACAGTGCCCTAT...</td>
      <td>FOXL1::PRRX1+Melanocytes+6+scrA_scrB</td>
    </tr>
    <tr>
      <td>15126</td>
      <td>FOXL1::PRRX1</td>
      <td>69</td>
      <td>49</td>
      <td>chr1</td>
      <td>11322685</td>
      <td>11322754</td>
      <td>11322652</td>
      <td>11322786</td>
      <td>PRRX1</td>
      <td>11322685</td>
      <td>...</td>
      <td>11322754</td>
      <td>Melanocytes</td>
      <td>pro_pro</td>
      <td>7</td>
      <td>FOXL1::PRRX1+Melanocytes+7</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TAGGGAGAAGATGGACTGAAAAACAACGGCGATAAAGAAAATGTGA...</td>
      <td>FOXL1::PRRX1+Melanocytes+7+scrA_scrB</td>
    </tr>
    <tr>
      <td>15127</td>
      <td>FOXL1::PRRX1</td>
      <td>22</td>
      <td>2</td>
      <td>chr16</td>
      <td>84210876</td>
      <td>84210898</td>
      <td>84210820</td>
      <td>84210954</td>
      <td>PRRX1</td>
      <td>84210876</td>
      <td>...</td>
      <td>84210898</td>
      <td>Melanocytes</td>
      <td>pro_pro</td>
      <td>8</td>
      <td>FOXL1::PRRX1+Melanocytes+8</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>CAGTCTGAGCTGGAGCCCGTGCAGCCTCGGGCGGGGGCAGGCCTGG...</td>
      <td>FOXL1::PRRX1+Melanocytes+8+scrA_scrB</td>
    </tr>
    <tr>
      <td>15128</td>
      <td>FOXL1::PRRX1</td>
      <td>29</td>
      <td>9</td>
      <td>chrX</td>
      <td>102820628</td>
      <td>102820657</td>
      <td>102820575</td>
      <td>102820709</td>
      <td>PRRX1</td>
      <td>102820628</td>
      <td>...</td>
      <td>102820657</td>
      <td>Melanocytes</td>
      <td>pro_pro</td>
      <td>9</td>
      <td>FOXL1::PRRX1+Melanocytes+9</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>TAAGAAGTCAGTGCTGTACTACAGCCACAGTTTTTTAAAATTAACT...</td>
      <td>FOXL1::PRRX1+Melanocytes+9+scrA_scrB</td>
    </tr>
    <tr>
      <td>15129</td>
      <td>FOXL1::PRRX1</td>
      <td>54</td>
      <td>34</td>
      <td>chr1</td>
      <td>33886937</td>
      <td>33886991</td>
      <td>33886897</td>
      <td>33887031</td>
      <td>PRRX1</td>
      <td>33886937</td>
      <td>...</td>
      <td>33886991</td>
      <td>Melanocytes</td>
      <td>loop_loop</td>
      <td>10</td>
      <td>FOXL1::PRRX1+Melanocytes+10</td>
      <td>0</td>
      <td>True</td>
      <td>scrA_scrB_seq</td>
      <td>GTAAGCTAGTAAAGGACAGGAAGTAGGGCAAATGCCAGTGGGAAGT...</td>
      <td>FOXL1::PRRX1+Melanocytes+10+scrA_scrB</td>
    </tr>
  </tbody>
</table>
<p>480 rows  23 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="saving-selection-of-vocab-words">saving selection of vocab words<a class="anchor-link" href="#saving-selection-of-vocab-words">&#182;</a></h3><p>how <code>name_config</code> works:</p>
<p><code>df['vocab_pair','tissue','vocab_tissue_count','seq_config'] = df.name_config.str.split('+',expand=True)</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># for rerunnin </span>
<span class="n">pos_genes_df_rs_filt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;pos_genes_position_wseq_rsfilt.csv&#39;</span><span class="p">),</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">neg_genes_df_rs_filt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;neg_genes_position_wseq_rsfilt.csv&#39;</span><span class="p">),</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[211]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs</span><span class="p">[</span><span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">vocab_tissue_count</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">]</span>
<span class="n">vocab_instances20_seqs_sel</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;+&#39;</span> <span class="o">+</span> <span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">seq_config</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_seq&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">vocab_instances20_seqs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_seq_wscr_sel.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(9560, 23) (16984, 22)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[212]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[212]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;vocab_pair&#39;, &#39;tot_dist&#39;, &#39;btn_dist&#39;, &#39;chr&#39;, &#39;start&#39;, &#39;stop&#39;,
       &#39;start_pad&#39;, &#39;stop_pad&#39;, &#39;vocab1&#39;, &#39;vocab1_start&#39;, &#39;vocab1_stop&#39;,
       &#39;vocab2&#39;, &#39;vocab2_start&#39;, &#39;vocab2_stop&#39;, &#39;tissue&#39;, &#39;loop_type&#39;,
       &#39;vocab_tissue_count&#39;, &#39;name&#39;, &#39;check_rs&#39;, &#39;scr_pass_rs&#39;, &#39;seq_config&#39;,
       &#39;seq&#39;, &#39;name_config&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[213]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_seqs_sel.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[214]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_selcols</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs_sel</span><span class="p">[[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]]</span>
<span class="n">vocab_instances20_seqs_selcols</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span>
<span class="n">vocab_instances20_seqs_selcols</span><span class="p">[</span><span class="s1">&#39;seq_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;vocab&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  This is separate from the ipykernel package so we can avoid doing imports until
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[215]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pos_genes_df_seqs_sel_cols</span> <span class="o">=</span> <span class="n">pos_genes_df_rs_filt</span><span class="p">[[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">,</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span><span class="s1">&#39;sequence&#39;</span><span class="p">]]</span>
<span class="n">pos_genes_df_seqs_sel_cols</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span>
<span class="n">pos_genes_df_seqs_sel_cols</span><span class="p">[</span><span class="s1">&#39;seq_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span>
<span class="n">neg_genes_df_seqs_sel_cols</span> <span class="o">=</span> <span class="n">neg_genes_df_rs_filt</span><span class="p">[[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">,</span><span class="s1">&#39;gene&#39;</span><span class="p">,</span><span class="s1">&#39;sequence&#39;</span><span class="p">]]</span>
<span class="n">neg_genes_df_seqs_sel_cols</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">,</span><span class="s1">&#39;stop&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span>
<span class="n">neg_genes_df_seqs_sel_cols</span><span class="p">[</span><span class="s1">&#39;seq_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;neg&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[216]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpra_lib_seq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vocab_instances20_seqs_selcols</span><span class="p">,</span><span class="n">pos_genes_df_seqs_sel_cols</span><span class="p">,</span> <span class="n">neg_genes_df_seqs_sel_cols</span> <span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpra_lib_seq</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[216]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chr</th>
      <th>name</th>
      <th>seq</th>
      <th>seq_type</th>
      <th>start</th>
      <th>stop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>chr1</td>
      <td>BARX2::FOXF2+Colon+1+A_B</td>
      <td>CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...</td>
      <td>vocab</td>
      <td>206848284</td>
      <td>206848418</td>
    </tr>
    <tr>
      <td>1</td>
      <td>chr4</td>
      <td>BARX2::FOXF2+Colon+2+A_B</td>
      <td>GTGGCTCTGAGGGAATTTCAAGTAACCGTGGACTAAAGTCTTAAGA...</td>
      <td>vocab</td>
      <td>38859561</td>
      <td>38859695</td>
    </tr>
    <tr>
      <td>2</td>
      <td>chr6</td>
      <td>BARX2::FOXF2+Colon+3+A_B</td>
      <td>GCCACTGCACTCCAGCCTGGTGACAGAGCGAGACTCTGTCTCAAGA...</td>
      <td>vocab</td>
      <td>74222732</td>
      <td>74222866</td>
    </tr>
    <tr>
      <td>3</td>
      <td>chr3</td>
      <td>BARX2::FOXF2+Colon+4+A_B</td>
      <td>AGTATTATGTGCTCATGGTCCCTACCCTCCAGGGTTCACAGTGTGG...</td>
      <td>vocab</td>
      <td>49384615</td>
      <td>49384749</td>
    </tr>
    <tr>
      <td>4</td>
      <td>chr10</td>
      <td>BARX2::FOXF2+Colon+5+A_B</td>
      <td>ATGTGGCTGCGGGGCTTTAGGAGCTGACTCTTTGGTCACGGGGAGA...</td>
      <td>vocab</td>
      <td>112247461</td>
      <td>112247595</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>89</td>
      <td>chrX</td>
      <td>RHOXF2B</td>
      <td>ACCACGCTCTCCTAGGCAGTGCTAGAACTGTGAGTCGCCGCCTGCA...</td>
      <td>neg</td>
      <td>119211572</td>
      <td>119211707</td>
    </tr>
    <tr>
      <td>90</td>
      <td>chrX</td>
      <td>CT47A12</td>
      <td>AGTCTCTCTCTTTATTGAGGGAATAAGAGTCTGTCTCAGACGACAC...</td>
      <td>neg</td>
      <td>120066016</td>
      <td>120066151</td>
    </tr>
    <tr>
      <td>91</td>
      <td>chrX</td>
      <td>CT47A6</td>
      <td>AGTCTCTCTCTTTATTGAGGGAATAAGAGTCTGTCTCAGACGACAC...</td>
      <td>neg</td>
      <td>120095202</td>
      <td>120095337</td>
    </tr>
    <tr>
      <td>92</td>
      <td>chrX</td>
      <td>SPANXN4</td>
      <td>TGTCAGAGGTGGTTCTTTGTGATGCCAAAGCCACCCTAGGACTACC...</td>
      <td>neg</td>
      <td>142113569</td>
      <td>142113704</td>
    </tr>
    <tr>
      <td>93</td>
      <td>chrX</td>
      <td>SPANXN2</td>
      <td>TGTTCTTTTACCCAATGTCCATGTAGTTCCTTTAAGTTTCCTATTT...</td>
      <td>neg</td>
      <td>142804381</td>
      <td>142804516</td>
    </tr>
  </tbody>
</table>
<p>9721 rows  6 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="some-stats-then-saving">some stats then saving<a class="anchor-link" href="#some-stats-then-saving">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[217]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpra_lib_seq</span><span class="o">.</span><span class="n">seq_type</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[217]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>vocab    9560
neg        89
pos        72
Name: seq_type, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[218]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">tissue</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="mi">40</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[218]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>GDSD6          49.0
SCC            43.0
Colon          42.0
MM             40.0
GM12878        39.0
Melanocytes    26.0
Name: tissue, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[220]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">vocab_pair</span><span class="p">[</span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">irf_vocab</span><span class="p">)]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-220-c1f9fcc06457&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>vocab_instances20_seqs_sel<span class="ansi-blue-fg">.</span>vocab_pair<span class="ansi-blue-fg">[</span>vocab_instances20_seqs_sel<span class="ansi-blue-fg">.</span>vocab_pair<span class="ansi-blue-fg">.</span>isin<span class="ansi-blue-fg">(</span>irf_vocab<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>unique<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;irf_vocab&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1426]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># number of vocab words that have irf vocab setup</span>
<span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">vocab_pair</span><span class="p">[</span><span class="n">vocab_instances20_seqs_sel</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">irf_vocab</span><span class="p">)]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1426]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(19,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[221]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpra_lib_seq</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;mpra_lib_seq.csv&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="6.-add-MPRA-adaptors-and-barcodes">6. add MPRA adaptors and barcodes<a class="anchor-link" href="#6.-add-MPRA-adaptors-and-barcodes">&#182;</a></h1><p>done in 8E1R (based on <code>make_library_psych-postcadd-01119.ipynb</code> from the mpra library</p>
<p>note that the rs sites chosen from section 4B are: <code>[RS_ECORI ,RS_BAMHI , RS_XHOI , RS_NHEI]</code></p>
<p>input is <code>../data/processed/fig4_modelling/vocab_sum_final/mpra_lib_seq.csv</code></p>
<p>output is <code>../data/processed/fig4_modelling/vocab_sum_final/mpra_oligo_df_filt.csv</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[222]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># define constants</span>
<span class="n">LEN_FILLER</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">NUM_OLIGO_PER_MOTIF</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">DESIRED_OLIGO_LENGTH</span> <span class="o">=</span> <span class="mi">135</span> <span class="c1">#(changed from 150 )</span>
<span class="n">MAX_OLIGO_LENGTH</span> <span class="o">=</span> <span class="mi">230</span>
<span class="n">MAX_MOTIF_LENGTH</span> <span class="o">=</span> <span class="mi">63</span>
<span class="n">FORWARD_PCR_PRIMER</span> <span class="o">=</span> <span class="s1">&#39;ACTGGCCGCTTCACTG&#39;</span>
<span class="n">REVERSE_PCR_PRIMER</span> <span class="o">=</span> <span class="s1">&#39;AGATCGGAAGAGCGTCG&#39;</span>
<span class="c1"># LINKER_SPACER_v10 = &#39;CAGTATGCGATGCTCATGATTGTGACTGAAAGTCTATGAGTCCATTGA&#39;</span>
<span class="n">RS_ECORI</span> <span class="o">=</span> <span class="s1">&#39;GAATTC&#39;</span> <span class="c1"># 5&#39;-3&#39;</span>
<span class="n">RS_BAMHI</span> <span class="o">=</span> <span class="s1">&#39;GGATCC&#39;</span>
<span class="n">RS_XHOI</span> <span class="o">=</span> <span class="s1">&#39;CTCGAG&#39;</span>
<span class="n">RS_NHEI</span> <span class="o">=</span> <span class="s1">&#39;GCTAGC&#39;</span>


<span class="n">RS_LIST</span> <span class="o">=</span> <span class="p">[</span><span class="n">RS_ECORI</span> <span class="p">,</span><span class="n">RS_BAMHI</span> <span class="p">,</span> <span class="n">RS_XHOI</span> <span class="p">,</span> <span class="n">RS_NHEI</span><span class="p">]</span>

<span class="n">LETTERS</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="7.-MPRA-final-check">7. MPRA final check<a class="anchor-link" href="#7.-MPRA-final-check">&#182;</a></h1><ul>
<li>checks to make sure all sequences have 10 barcodes</li>
<li>all rs sites are passed (done in R notebook)</li>
<li><p>that there are still 239 vocab words with 40 instance (4 config of 10 each)</p>
</li>
<li><p><code>../data/processed/fig4_modelling/vocab_sum_final/mpra_lib_seq.csv</code> - includes information on all the sequences used</p>
</li>
<li><code>../data/processed/fig4_modelling/vocab_sum_final/mpra_oligo_df_filt.csv</code> - oligo information with a lot of columns (RS site check results etc.(</li>
<li><code>../data/processed/fig4_modelling/vocab_sum_final/mpra_oligo_df_final.txt</code> - with columns: name, seq_type, id, oligo, seq, filler, barcode</li>
<li><code>../data/processed/fig4_modelling/vocab_sum_final/mpra_oligo_df_final_SUBMIT.txt</code> - with columns: id, oligo</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1436]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1436]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;../data/processed/fig4_modelling/vocab_sum_final/&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[226]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">oligo_df_filt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span><span class="s1">&#39;mpra_oligo_df_filt.csv&#39;</span><span class="p">),</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oligo_df_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">oligo_df_filt</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(97210, 21)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[226]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>seq</th>
      <th>seq_type</th>
      <th>count</th>
      <th>id</th>
      <th>pass_restrict_seq</th>
      <th>pass_restrict_fwd_seq</th>
      <th>pass_restrict_seq_xho</th>
      <th>barcode</th>
      <th>len_seq</th>
      <th>...</th>
      <th>1:n()</th>
      <th>filler</th>
      <th>filler_check</th>
      <th>oligo</th>
      <th>len_oligo</th>
      <th>pass_restrict_ECORI</th>
      <th>pass_restrict_BAMHI</th>
      <th>pass_restrict_XHOI</th>
      <th>pass_restrict_NHEI</th>
      <th>pass_all</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>ABCF3</td>
      <td>ACCTTGAGCTCCCAGCCTTTGCCCCACCCCTCGCTCCCGGAACTCC...</td>
      <td>pos</td>
      <td>1</td>
      <td>ABCF3.1</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>GACCGGAGTAGGTTAGGTTA</td>
      <td>136</td>
      <td>...</td>
      <td>8</td>
      <td>CCGCCATTGTCTCGGGCGAA</td>
      <td>True</td>
      <td>ACTGGCCGCTTCACTGACCTTGAGCTCCCAGCCTTTGCCCCACCCC...</td>
      <td>221</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <td>2</td>
      <td>ABCF3</td>
      <td>ACCTTGAGCTCCCAGCCTTTGCCCCACCCCTCGCTCCCGGAACTCC...</td>
      <td>pos</td>
      <td>2</td>
      <td>ABCF3.2</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>GCTGGCGAATATAAGAGTAT</td>
      <td>136</td>
      <td>...</td>
      <td>14</td>
      <td>GCCCTATTATATGTGCGTCC</td>
      <td>True</td>
      <td>ACTGGCCGCTTCACTGACCTTGAGCTCCCAGCCTTTGCCCCACCCC...</td>
      <td>221</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <td>3</td>
      <td>ABCF3</td>
      <td>ACCTTGAGCTCCCAGCCTTTGCCCCACCCCTCGCTCCCGGAACTCC...</td>
      <td>pos</td>
      <td>3</td>
      <td>ABCF3.3</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>TGAGATCCAACCAAGGTTGC</td>
      <td>136</td>
      <td>...</td>
      <td>5</td>
      <td>ACAAGGTAGGAGGGGCAGAG</td>
      <td>True</td>
      <td>ACTGGCCGCTTCACTGACCTTGAGCTCCCAGCCTTTGCCCCACCCC...</td>
      <td>221</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <td>4</td>
      <td>ABCF3</td>
      <td>ACCTTGAGCTCCCAGCCTTTGCCCCACCCCTCGCTCCCGGAACTCC...</td>
      <td>pos</td>
      <td>4</td>
      <td>ABCF3.4</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>AAGATTAATCGGAGGAGTTG</td>
      <td>136</td>
      <td>...</td>
      <td>1</td>
      <td>CCTAAAATATGGACTTACCG</td>
      <td>True</td>
      <td>ACTGGCCGCTTCACTGACCTTGAGCTCCCAGCCTTTGCCCCACCCC...</td>
      <td>221</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <td>5</td>
      <td>ABCF3</td>
      <td>ACCTTGAGCTCCCAGCCTTTGCCCCACCCCTCGCTCCCGGAACTCC...</td>
      <td>pos</td>
      <td>5</td>
      <td>ABCF3.5</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>GAAGTACTCTCCTGCGAGGA</td>
      <td>136</td>
      <td>...</td>
      <td>4</td>
      <td>AGGACCTCCGTTGGCAATTC</td>
      <td>True</td>
      <td>ACTGGCCGCTTCACTGACCTTGAGCTCCCAGCCTTTGCCCCACCCC...</td>
      <td>221</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>5 rows  21 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[227]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq_counts</span> <span class="o">=</span> <span class="n">oligo_df_filt</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">seq_counts</span><span class="p">[</span><span class="n">seq_counts</span><span class="o">!=</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[227]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Series([], Name: name, dtype: int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>all sequences have 10 barcodes</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>rs sites checks (done in R notebook)</p>
<ul>
<li>no EcoRI </li>
<li>no BamHI sites</li>
<li>exactly 1 XhoI site</li>
<li>exactly 1 NheI site</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[228]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_oligo_df</span> <span class="o">=</span>  <span class="n">oligo_df_filt</span><span class="p">[</span><span class="n">oligo_df_filt</span><span class="o">.</span><span class="n">seq_type</span><span class="o">==</span><span class="s1">&#39;vocab&#39;</span><span class="p">]</span>
    
<span class="n">vocab_oligo_df</span><span class="p">[[</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span><span class="s1">&#39;tissue&#39;</span><span class="p">,</span><span class="s1">&#39;vocab_tissue_count&#39;</span><span class="p">,</span><span class="s1">&#39;seq_config&#39;</span><span class="p">]]</span><span class="o">=</span> <span class="n">vocab_oligo_df</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/pandas/core/frame.py:3494: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self[k1] = value[k2]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[229]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_oligo_counts</span> <span class="o">=</span> <span class="n">vocab_oligo_df</span><span class="o">.</span><span class="n">vocab_pair</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">vocab_oligo_counts</span><span class="p">[</span><span class="n">vocab_oligo_counts</span><span class="o">!=</span><span class="mi">400</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[229]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Series([], Name: vocab_pair, dtype: int64)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>all vocab types have 4 configs x 10 genomic instances x 10 barcodes = 400 oligos</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[230]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_oligo_counts</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[230]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(239,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>there are 239 vocab words</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="7B-motif-scan">7B motif scan<a class="anchor-link" href="#7B-motif-scan">&#182;</a></h2><h3 id="1.-make-fasta">1. make fasta<a class="anchor-link" href="#1.-make-fasta">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[231]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fasta_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;mpra_vocab_seq2.fasta&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vocab_oligo_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fasta_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">vocab_oligo_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(9560, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[321]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[321]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>seq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>ABCF3</td>
      <td>ACCTTGAGCTCCCAGCCTTTGCCCCACCCCTCGCTCCCGGAACTCC...</td>
    </tr>
    <tr>
      <td>11</td>
      <td>ADM</td>
      <td>GCTCCTCTCGGCTTTGCTCCGTCCCTGCCCCGGCCCCTCCGCGGGA...</td>
    </tr>
    <tr>
      <td>21</td>
      <td>ALDH16A1</td>
      <td>ATAAATCCGGAGCCCTCCTAACTATTCGCAAAGTACCCACATCGCC...</td>
    </tr>
    <tr>
      <td>31</td>
      <td>ANAPC15</td>
      <td>CTTACCGCGCCGGGAGGCTGCTGCCGGCGGCGACCCGGAAGCGCTT...</td>
    </tr>
    <tr>
      <td>41</td>
      <td>ANXA2</td>
      <td>CCCAGCAGGGCTCTGACCTACCTGGGCAGCCTCATTCCCCCACATC...</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>97161</td>
      <td>ZNF580</td>
      <td>GAGTAGCAAGGTGCGCGACGCAGGAACCTTTCTCTTGTGGGTGCGT...</td>
    </tr>
    <tr>
      <td>97171</td>
      <td>ZNF581</td>
      <td>GGGAGAAGGGGCTATTTCCCATGGGAAGACAAAGTGGGATGAATAG...</td>
    </tr>
    <tr>
      <td>97181</td>
      <td>ZNF679</td>
      <td>CAGAAATATGCCACAATCCCCAATGGAGGCCAAGACAAGGCAAGTC...</td>
    </tr>
    <tr>
      <td>97191</td>
      <td>ZNF839</td>
      <td>AACTGCGGAATCTTTTGGACTGGCCCAGAGGTTATCCAAGGCTACC...</td>
    </tr>
    <tr>
      <td>97201</td>
      <td>ZNF99</td>
      <td>AGCCCCTTCCCCTTCTCAGGATATCGGACCCGGCACTCTCACCATT...</td>
    </tr>
  </tbody>
</table>
<p>161 rows  2 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[323]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fasta_control_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;mpra_control_seq.fasta&#39;</span><span class="p">)</span>
<span class="n">control_oligo_df</span> <span class="o">=</span> <span class="n">oligo_df_filt</span><span class="p">[</span><span class="n">oligo_df_filt</span><span class="o">.</span><span class="n">seq_type</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span><span class="s1">&#39;neg&#39;</span><span class="p">])]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">control_oligo_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fasta_control_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">control_oligo_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(161, 2)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scanning-try-1:-RSAT-FAILED">scanning try 1: RSAT FAILED<a class="anchor-link" href="#scanning-try-1:-RSAT-FAILED">&#182;</a></h3><p><a href="http://rsat.sb-roscoff.fr/matrix-scan.cgi">http://rsat.sb-roscoff.fr/matrix-scan.cgi</a></p>
<p>Server command
$RSAT/perl-scripts/matrix-scan -v 1   -quick -matrix_format transfac -m $RSAT/public_html/tmp/apache/2020/09/02/matrix-scan_2020-09-02.015859_5S2uJF.matrix -pseudo 1 -decimals 1 -2str -origin end -bginput -markov 1 -bg_pseudo 0.01 -return limits -return sites -lth score 1 -i $RSAT/public_html/tmp/apache/2020/09/02/tmp_sequence_2020-09-02.015859_VpAOG3.fasta -seq_format fasta -n score</p>
<p>[RSAT] matrix-scan 2020-09-02.020844</p>
<p>Command: nice -n 19 $RSAT/perl-scripts/matrix-scan -v 1   -quick -matrix_format transfac -m $RSAT/public_html/tmp/apache/2020/09/02/matrix-scan_2020-09-02.020844_AC8494.matrix -pseudo 1 -decimals 1 -2str -origin end -bginput -markov 1 -bg_pseudo 0.01 -return limits -return sites -lth score 1 -i $RSAT/public_html/tmp/apache/2020/09/02/tmp_sequence_2020-09-02.020844_IedJeb.fasta -seq_format fasta -n score</p>
<p>Your task has been submitted to the RSAT server.</p>
<p>After completion of the task, an email will be sent to mguo123@stanford.edu</p>
<p>The result will become available at
    <a href="http://rsat.sb-roscoff.fr/tmp/apache/2020/09/02/matrix-scan_2020-09-02.020844_AC8494.ft">http://rsat.sb-roscoff.fr/tmp/apache/2020/09/02/matrix-scan_2020-09-02.020844_AC8494.ft</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scanning-try-2:-meme-suite-failed">scanning try 2: meme suite failed<a class="anchor-link" href="#scanning-try-2:-meme-suite-failed">&#182;</a></h3><p>also try <a href="http://meme-suite.org/info/status?service=MAST&amp;id=appMAST_5.1.11599005652624-545759054">http://meme-suite.org/info/status?service=MAST&amp;id=appMAST_5.1.11599005652624-545759054</a></p>

<pre><code>Status Messages
</code></pre>
<p>Parsing arguments
Arguments ok
Starting mast
mast -oc . -nostatus -minseqs 9560 -ev 10.0 HOCOMOCOv11_core_HUMAN_mono_meme_format.meme sequences.fa</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="scanning-try-3-MOODS-package">scanning try 3 MOODS package<a class="anchor-link" href="#scanning-try-3-MOODS-package">&#182;</a></h3><p><a href="https://github.com/jhkorhonen/MOODS/wiki/Getting-started">https://github.com/jhkorhonen/MOODS/wiki/Getting-started</a>
Matrices. The matrices are expected in the JASPAR .pfm format or the .adm format for first-order models. A JASPAR .pfm file consist of four rows, specifying the counts or frequencies for nucleotides A, C, G and T, respectively:</p>
<h4 id="DESCRIPTION">DESCRIPTION<a class="anchor-link" href="#DESCRIPTION">&#182;</a></h4><p>MOODS 1.9.1 introduced a Python command-line script moods-dna.py for standalone PWM analysis using the MOODS algorithms. This section explains the basics of using <code>moods-dna.py</code></p>
<h4 id="Input-matrics-(motifs)">Input matrics (motifs)<a class="anchor-link" href="#Input-matrics-(motifs)">&#182;</a></h4><p>pfms are in <code>/Users/mguo123/Google Drive/1_khavari/omics_project-LD/pan_omics/data/external/hocomoco_human_trim</code>
Note: the extensions are pwm but are pfms</p>
<h4 id="Input-sequences">Input sequences<a class="anchor-link" href="#Input-sequences">&#182;</a></h4><p>Sequences. The sequences can be given either as plain text files, or as fasta files possibly containing multiple sequences. Newlines and leading and trailing whitespace will be ignored, but other characters not encoding nucleotides will be treated as non-matchable positions (i.e., they should not appear outside fasta headers). IUPAC nucleotide ambiguity codes (WSMKRYBDHV) will be treated as coding SNPs, and MOODS will match the matrices versus all possible combinations.</p>
<h4 id="Output-(csv)">Output (csv)<a class="anchor-link" href="#Output-(csv)">&#182;</a></h4><p>The comma-separated fields are:</p>
<ul>
<li>Sequence name (either file name or fasta header).</li>
<li>Matrix file name.</li>
<li>Hit position (first position of sequence is position 0).</li>
<li>Indicates whether the match is versus the input strand (+) or the reverse complement (-).</li>
<li>Match score.</li>
<li>Hit site in the original sequence (note that if the match is -, then the match is versus the reverse complement of this).</li>
<li>Hit sequence with SNPs applied, i.e. shows how the ambiguity codes are resolved to get this score (there can be multiple hits at the same position with different "real" hit sequences).</li>
</ul>
<h4 id="Installation">Installation<a class="anchor-link" href="#Installation">&#182;</a></h4><p>follow: <a href="https://pypi.org/project/MOODS-python/">https://pypi.org/project/MOODS-python/</a></p>
<p>this doesn't work with subprocess</p>

<pre><code>pip install --user MOODS-python
PATH="$PATH:`python -m site --user-base`/bin"</code></pre>
<h4 id="Basic-usage">Basic usage<a class="anchor-link" href="#Basic-usage">&#182;</a></h4><p>The basic usage pattern of <code>moods-dna.py</code> is the following:</p>

<pre><code>moods-dna.py --help
usage: moods-dna.py [-h] [-v] [-m M [M ...]] [-S M [M ...]] [-s S [S ...]]
                    [-p p] [-t T] [-B n] [-o outfile] [--sep S] [-R]
                    [--no-snps] [--batch] [--bg pA pC pG pT] [--ps p]
                    [--log-base x] [--lo-bg pA pC pG pT]
                    [--threshold-precision x]

matches position weight matrices against DNA sequences

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbosity       verbose (-vv, -vvv for more)

input files (at least one matrix and sequence file required):
  -m M [M ...], --matrices M [M ...]
                        matrix files (count/frequency, will be converted to
                        PWM before matching)
  -S M [M ...], --score-matrices M [M ...]
                        matrix files (PWM/other score matrix, will be matched
                        directly)
  -s S [S ...], --sequences S [S ...]
                        sequence files

threshold selection (exactly one required):
  -p p, --p-value p     compute threshold from p-value
  -t T, --threshold T   use specified absolute threshold
  -B n, --best-hits n   return at least the specified amount of best matches

output (optional):
  -o outfile, --outfile outfile
                        output to file instead of standard output
  --sep S               set field separator in out (default ",")

search and model behaviour (optional):
  -R, --no-rc           disable matching versus reverse complement strand
  --no-snps             ignore IUPAC symbols coding multiple nucleotides
  --batch               do not recompute thresholds from p-values for each
                        sequence separately (recommended when dealing with
                        lots of short sequences)
  --bg pA pC pG pT      background distribution for computing thresholds from
                        p-value with --batch (default is 0.25 for all alleles)
  --ps p                total pseudocount added to each matrix column in log-
                        odds conversion (default = 0.01)
  --log-base x          logarithm base for log-odds conversion (default
                        natural logarithm)
  --lo-bg pA pC pG pT   background distribution for log-odds conversion
                        (default is 0.25 for all alleles)
  --threshold-precision x
                        specify the precision used for computing the
                        thresholds from p-values (default = 2000.0)


moods-dna.py -m example-data/matrices/*.{pfm,adm} -s example-data/seq/chr1-5k-55k.fa -p 0.0001
moods-dna.py -m ../data/external/hocomoco_human_trim/*.pwm -s ../data/processed/fig4_modelling/vocab_sum_final/mpra_vocab_seq.fasta -p 0.0001

moods-dna.py -m ../data/external/hocomoco_human_trim/FOXM1_HUMAN.H11MO.0.A.pwm.trim.pwm -s ../data/processed/fig4_modelling/vocab_sum_final/mpra_vocab_seq.fasta -p 0.0001</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1445]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># # !pip install --user MOODS-python</span>
<span class="c1"># !PATH=&quot;$PATH:`python -m site --user-base`/bin&quot;</span>
<span class="c1"># glob.glob(os.path.join(save_dir,&quot;*fasta&quot;))</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[325]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># num actual tfs used </span>
<span class="n">list_tfs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">vocab1</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">vocab2</span><span class="o">.</span><span class="n">unique</span><span class="p">())))</span>
<span class="nb">len</span><span class="p">(</span><span class="n">list_tfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[325]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>123</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="for-vocab">for vocab<a class="anchor-link" href="#for-vocab">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1687]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># make directory</span>
<span class="n">motif_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan3&#39;</span><span class="p">)</span> <span class="c1">#../data/processed/fig4_modelling/vocab_sum_final/motif_scan3</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">motif_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">motif_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">motif_path</span><span class="p">)</span>

<span class="n">input_fasta</span> <span class="o">=</span> <span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum_final/mpra_vocab_seq2.fasta&#39;</span>
<span class="c1"># run_file = &#39;run_8E1_make_mpra_7_motif_scan.sh&#39;</span>
<span class="n">run_file</span> <span class="o">=</span> <span class="s1">&#39;run_8E1_make_mpra_7_motif_scan_vocab_filt3.sh&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">run_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="c1"># print(len(glob.glob(&#39;../data/external/hocomoco_human_trim/*pwm&#39;)))</span>
    <span class="k">for</span> <span class="n">pwm_file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;../data/external/hocomoco_human_trim/*pwm&#39;</span><span class="p">)):</span>
        <span class="n">pwm</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">pwm_file</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.pwm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">tf_id_abbr_to_name_dict</span><span class="p">[</span><span class="n">pwm</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">list_tfs</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">motif_path</span><span class="p">,</span> <span class="n">pwm</span><span class="o">+</span><span class="s1">&#39;_scan.csv&#39;</span><span class="p">)</span>
<span class="c1">#             cmd = &#39;moods-dna.py -m {} -s {} -p 0.00005 -o {}&#39;.format(pwm_file,input_fasta, output_file) </span>
<span class="c1">#             cmd = &#39;moods-dna.py -m {} -s {} -p 0.001 -o {}&#39;.format(pwm_file,input_fasta, output_file) #motif_scan and motif_scan2 use this, the difference is in scrambling methods (see final analysis step)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;moods-dna.py -m </span><span class="si">{}</span><span class="s1"> -s </span><span class="si">{}</span><span class="s1"> -p 0.05 -o </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pwm_file</span><span class="p">,</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span> <span class="c1">#motif_scan3 uses this, difference from motif_scan2 is the pvalue</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
<span class="c1"># testing</span>
<span class="c1"># cmd = &#39;moods-dna.py -m {} -s {} -p 0.00005 -o {}&#39;.format(pwm_file,input_fasta, output_file)</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;moods-dna.py -m </span><span class="si">{}</span><span class="s1"> -s </span><span class="si">{}</span><span class="s1"> -p 0.05 -o </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pwm_file</span><span class="p">,</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
<span class="c1">#moods-dna.py -m ../data/external/hocomoco_human_trim/ZSC31_HUMAN.H11MO.0.C.pwm.trim.pwm -s ../data/processed/fig4_modelling/vocab_sum_final/mpra_vocab_seq2.fasta -p 0.05 -o ../data/processed/fig4_modelling/vocab_sum_final/motif_scan3/ZN816_HUMAN.H11MO.1.C_scan.csv</span>

<span class="c1"># subprocess.Popen(cmd.split())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1688]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>moods-dna.py -m ../data/external/hocomoco_human_trim/ZSC31_HUMAN.H11MO.0.C.pwm.trim.pwm -s ../data/processed/fig4_modelling/vocab_sum_final/mpra_vocab_seq2.fasta -p 0.05 -o ../data/processed/fig4_modelling/vocab_sum_final/motif_scan3/ZN816_HUMAN.H11MO.1.C_scan.csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="for-controls">for controls<a class="anchor-link" href="#for-controls">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[327]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># make directory</span>
<span class="n">motif_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan_control&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">motif_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">motif_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">motif_path</span><span class="p">)</span>
<span class="n">input_fasta</span> <span class="o">=</span> <span class="s1">&#39;../data/processed/fig4_modelling/vocab_sum_final/mpra_control_seq.fasta&#39;</span>
<span class="n">run_file</span> <span class="o">=</span> <span class="s1">&#39;run_8E1_make_mpra_7_motif_scan_control.sh&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">run_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="c1"># print(len(glob.glob(&#39;../data/external/hocomoco_human_trim/*pwm&#39;)))</span>
    <span class="k">for</span> <span class="n">pwm_file</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;../data/external/hocomoco_human_trim/*pwm&#39;</span><span class="p">)):</span>
        <span class="n">pwm</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">pwm_file</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.pwm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tf</span> <span class="o">=</span> <span class="n">tf_id_abbr_to_name_dict</span><span class="p">[</span><span class="n">pwm</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">tf</span> <span class="ow">in</span> <span class="n">list_tfs</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">motif_path</span><span class="p">,</span> <span class="n">pwm</span><span class="o">+</span><span class="s1">&#39;_scan.csv&#39;</span><span class="p">)</span>
            <span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;moods-dna.py -m </span><span class="si">{}</span><span class="s1"> -s </span><span class="si">{}</span><span class="s1"> -p 0.05 -o </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pwm_file</span><span class="p">,</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span> <span class="c1">#motif_scan3 uses this, difference from motif_scan4 is the pvalue            </span>
<span class="c1">#             cmd = &#39;moods-dna.py -m {} -s {} -p 0.001 -o {}&#39;.format(pwm_file,input_fasta, output_file) #motif_scan5 </span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># testing</span>
<span class="c1"># cmd = &#39;moods-dna.py -m {} -s {} -p 0.00005 -o {}&#39;.format(pwm_file,input_fasta, output_file)</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;moods-dna.py -m </span><span class="si">{}</span><span class="s1"> -s </span><span class="si">{}</span><span class="s1"> -p 0.05 -o </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pwm_file</span><span class="p">,</span><span class="n">input_fasta</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>../data/processed/fig4_modelling/vocab_sum_final/motif_scan_control
moods-dna.py -m ../data/external/hocomoco_human_trim/ZSC31_HUMAN.H11MO.0.C.pwm.trim.pwm -s ../data/processed/fig4_modelling/vocab_sum_final/mpra_control_seq.fasta -p 0.05 -o ../data/processed/fig4_modelling/vocab_sum_final/motif_scan_control/ZN816_HUMAN.H11MO.1.C_scan.csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>in cmd line in this folder run
<code>bash run_8E1_make_mpra_7_motif_scan_vocab_filt.sh</code>
<code>bash run_8E1_make_mpra_7_motif_scan_vocab_filt2.sh</code>
<code>bash run_8E1_make_mpra_7_motif_scan_vocab_filt3.sh</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>in sherlock</p>

<pre><code>cd /oak/stanford/groups/khavari/users/mguo123/pan_omics/notebooks

sbatch run_8E1_make_mpra_7_motif_scan_vocab_filt.sbatch



#!/bin/bash
#run_8E1_make_mpra_7_motif_scan.sbatch
#09/01/2020
#SBATCH -J motif_filt# A single job name for the array
#SBATCH -p rbaltman,khavari # Partition
#SBATCH -n 1 # one core
#SBATCH --mem=64000
#SBATCH --time=48:00:00
#SBATCH -o run_8E1_filt.out # Standard output
#SBATCH -e run_8E1_filt.err # Standard error
#SBATCH --mail-type=FAIL,END # notifications for job done &amp; fail
#SBATCH --mail-user=mguo123@stanford.edu

cd /oak/stanford/groups/khavari/users/mguo123/pan_omics/notebooks

bash run_8E1_make_mpra_7_motif_scan_vocab_filt.sh</code></pre>
<h4 id="header-of-the-*_scan.csv">header of the <code>*_scan.csv</code><a class="anchor-link" href="#header-of-the-*_scan.csv">&#182;</a></h4><p><code>ARID5B::KLF5+GDSD6+4+A_B,SRBP2_HUMAN.H11MO.0.B.pwm.trim.pwm,73,-,5.35564936116,CCACCCCGC,</code>
cvs headers (8 cols)</p>
<ul>
<li>vocabulary config name (from fasta)</li>
<li>pwm filename</li>
<li>position in the sequence (index 0)</li>
<li>strand: Indicates whether the match is versus the input strand (+) or the reverse complement (-).</li>
<li>score (bit score)</li>
<li>sequence substring from what we are scanning (original sequence) (note that if the match is -, then the match is versus the reverse complement of this).</li>
<li>(NOT USED)Hit sequence with SNPs applied, i.e. shows how the ambiguity codes are resolved to get this score (there can be multiple hits at the same position with different "real" hit sequences).</li>
</ul>
<h4 id="more-on-the-score">more on the score<a class="anchor-link" href="#more-on-the-score">&#182;</a></h4>
<pre><code>https://www.cs.helsinki.fi/group/pssmfind/doc/python/MOODS.html
  The input PWM matrix transformed to log-odds scores.
  The score for nucleotide N and position i is

     log ( matrix[N][i] + ps * bg[N] ) / C[i]
       - log ( bg[N] ),

  where C[i] is the sum of terms

     matrix[N][i] + ps * bg[N]

  for all nucleotides N.

so all the matches to the PWM transformed log-odds score are summed to get the match score</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1455]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># x= vocab_instances20_alltissue_df_rs_filt[vocab_instances20_alltissue_df_rs_filt.name==&#39;BARX2::FOXF2+Colon+1&#39;]</span>
<span class="c1"># x.start_pad - x.start    </span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_oligo_df[vocab_oligo_df.name==&#39;FLI1::FOXM1+Colon+9+A_B&#39;]</span>
<span class="c1"># vocab_instances20_alltissue_df_rs_filt[vocab_instances20_alltissue_df_rs_filt.name==&#39;FLI1::FOXM1+Colon+9&#39;]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1454]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="p">[</span><span class="n">vocab_instances20_alltissue_df_rs_filt</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;COT1&#39;</span><span class="p">)][:</span><span class="mi">60</span><span class="p">]</span><span class="c1">#.vocab_pair.unique()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[1454]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>vocab1_stop</th>
      <th>vocab2</th>
      <th>...</th>
      <th>stop_pad</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>sequence</th>
      <th>check_rs</th>
      <th>scr_pass_rs</th>
      <th>A_B_seq</th>
      <th>scrA_B_seq</th>
      <th>A_scrB_seq</th>
      <th>scrA_scrB_seq</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows  25 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="7C-read-in-motif-scan-data">7C read in motif scan data<a class="anchor-link" href="#7C-read-in-motif-scan-data">&#182;</a></h2><p>cases for the motif in the</p>
<ol>
<li>scrambling removes motif </li>
<li>there's a dummy motif somewhere else in the genomic instance (????? How would you deal with these noisy cases?
 2A. is the dummy motif is present in all 4 cases, (not changed by scrambling)
 2B. the dummy motif is present in only some cases, so probably changed by scrambling the other site?</li>
<li>scrambling reintroduces the motif at a (hopefully) lower strength, and sometimes with a shifted start position  ??? Potential to rescramble (but sometimes motifs have too many repetitive nucleotides so this might not work
 3A. the scrambling introduces the motif at a lower strength
 3B. the scrambling does not lower the score of the motif</li>
<li>we don't detect the motif in any config in the genomic instance at a certain p value threshold (this usually isnt the case, if we raise the p-value threshold enough; but the motif will be detected in a lot more genomic instances). This is sort of the sensitivity vs specificity tradeoff.</li>
</ol>
<p>2 parts</p>
<ol>
<li>map the vocab word locations to motifs and match to case above (get the score and the case) - exact match</li>
<li>determine vocab words gained lost between the motif configurations</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7C1:-get-vocab_instance_df-set-up-with-locations-and-vocab-predictions-given-config">7C1: get vocab_instance_df set up with locations and vocab predictions given config<a class="anchor-link" href="#7C1:-get-vocab_instance_df-set-up-with-locations-and-vocab-predictions-given-config">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_oligo_df.columns</span>
<span class="n">vocab_instances20_seqs_sel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;vocab_instances20_seq_wscr_sel.csv&#39;</span><span class="p">),</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">vocab_instances20_seqs_sel</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>vocab_pair</th>
      <th>tot_dist</th>
      <th>btn_dist</th>
      <th>chr</th>
      <th>start</th>
      <th>stop</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab1</th>
      <th>vocab1_start</th>
      <th>...</th>
      <th>vocab2_stop</th>
      <th>tissue</th>
      <th>loop_type</th>
      <th>vocab_tissue_count</th>
      <th>name</th>
      <th>check_rs</th>
      <th>scr_pass_rs</th>
      <th>seq_config</th>
      <th>seq</th>
      <th>name_config</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>BARX2::FOXF2</td>
      <td>28</td>
      <td>14</td>
      <td>chr1</td>
      <td>206848337</td>
      <td>206848365</td>
      <td>206848284</td>
      <td>206848418</td>
      <td>BARX2</td>
      <td>206848337</td>
      <td>...</td>
      <td>206848365</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>1</td>
      <td>BARX2::FOXF2+Colon+1</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>CTCAGCTCTCCCACAAGATCTCTGGGGAAGCTGGAAGAGGGCCACT...</td>
      <td>BARX2::FOXF2+Colon+1+A_B</td>
    </tr>
    <tr>
      <td>1</td>
      <td>BARX2::FOXF2</td>
      <td>54</td>
      <td>40</td>
      <td>chr4</td>
      <td>38859601</td>
      <td>38859655</td>
      <td>38859561</td>
      <td>38859695</td>
      <td>FOXF2</td>
      <td>38859601</td>
      <td>...</td>
      <td>38859655</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>2</td>
      <td>BARX2::FOXF2+Colon+2</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>GTGGCTCTGAGGGAATTTCAAGTAACCGTGGACTAAAGTCTTAAGA...</td>
      <td>BARX2::FOXF2+Colon+2+A_B</td>
    </tr>
    <tr>
      <td>2</td>
      <td>BARX2::FOXF2</td>
      <td>46</td>
      <td>32</td>
      <td>chr6</td>
      <td>74222776</td>
      <td>74222822</td>
      <td>74222732</td>
      <td>74222866</td>
      <td>FOXF2</td>
      <td>74222776</td>
      <td>...</td>
      <td>74222822</td>
      <td>Colon</td>
      <td>loop_loop</td>
      <td>3</td>
      <td>BARX2::FOXF2+Colon+3</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>GCCACTGCACTCCAGCCTGGTGACAGAGCGAGACTCTGTCTCAAGA...</td>
      <td>BARX2::FOXF2+Colon+3+A_B</td>
    </tr>
    <tr>
      <td>3</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr3</td>
      <td>49384674</td>
      <td>49384690</td>
      <td>49384615</td>
      <td>49384749</td>
      <td>FOXF2</td>
      <td>49384674</td>
      <td>...</td>
      <td>49384690</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>4</td>
      <td>BARX2::FOXF2+Colon+4</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>AGTATTATGTGCTCATGGTCCCTACCCTCCAGGGTTCACAGTGTGG...</td>
      <td>BARX2::FOXF2+Colon+4+A_B</td>
    </tr>
    <tr>
      <td>4</td>
      <td>BARX2::FOXF2</td>
      <td>16</td>
      <td>2</td>
      <td>chr10</td>
      <td>112247520</td>
      <td>112247536</td>
      <td>112247461</td>
      <td>112247595</td>
      <td>BARX2</td>
      <td>112247520</td>
      <td>...</td>
      <td>112247536</td>
      <td>Colon</td>
      <td>pro_pro</td>
      <td>5</td>
      <td>BARX2::FOXF2+Colon+5</td>
      <td>0</td>
      <td>True</td>
      <td>A_B_seq</td>
      <td>ATGTGGCTGCGGGGCTTTAGGAGCTGACTCTTTGGTCACGGGGAGA...</td>
      <td>BARX2::FOXF2+Colon+5+A_B</td>
    </tr>
  </tbody>
</table>
<p>5 rows  23 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">vocab_present_func</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="c1"># determine if there should be a vocab present (based on configuration)</span>
    <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab_order&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="c1">#     vocab_instances_df.vocab_order.apply(lambda x: xisin(vocab_instances_df.config.str.split(&#39;_&#39;))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances_df</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs_sel</span><span class="p">[[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1_start&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]]</span>
<span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span><span class="s1">&#39;vocab&#39;</span><span class="p">,</span><span class="s1">&#39;vocab_start&#39;</span><span class="p">,</span><span class="s1">&#39;vocab_stop&#39;</span><span class="p">]</span>
<span class="n">vocab_instances_df</span><span class="p">[</span><span class="s1">&#39;vocab_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>

<span class="n">vocab_instances_df2</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs_sel</span><span class="p">[[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span><span class="s1">&#39;vocab2&#39;</span><span class="p">,</span><span class="s1">&#39;vocab2_start&#39;</span><span class="p">,</span><span class="s1">&#39;vocab2_stop&#39;</span><span class="p">]]</span>
<span class="n">vocab_instances_df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span><span class="s1">&#39;start_pad&#39;</span><span class="p">,</span><span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span><span class="s1">&#39;vocab&#39;</span><span class="p">,</span><span class="s1">&#39;vocab_start&#39;</span><span class="p">,</span><span class="s1">&#39;vocab_stop&#39;</span><span class="p">]</span>
<span class="n">vocab_instances_df2</span><span class="p">[</span><span class="s1">&#39;vocab_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span>
<span class="n">vocab_instances_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vocab_instances_df</span><span class="p">,</span><span class="n">vocab_instances_df2</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_instances_df</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">name_config</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">vocab_instances_df</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">name_config</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">vocab_instances_df</span><span class="p">[</span><span class="s1">&#39;vocab_present_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vocab_present_func</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">vocab_instances_df</span><span class="p">[</span><span class="s1">&#39;vocab_loc_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab_start</span> <span class="o">-</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">start_pad</span>
<span class="n">vocab_instances_df</span><span class="p">[</span><span class="s1">&#39;vocab_loc_stop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab_stop</span> <span class="o">-</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">start_pad</span>
<span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_instances_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  This is separate from the ipykernel package so we can avoid doing imports until
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:7: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  import sys
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chr</th>
      <th>name_config</th>
      <th>start_pad</th>
      <th>stop_pad</th>
      <th>vocab</th>
      <th>vocab_order</th>
      <th>vocab_start</th>
      <th>vocab_stop</th>
      <th>instance</th>
      <th>config</th>
      <th>vocab_present_pred</th>
      <th>vocab_loc_start</th>
      <th>vocab_loc_stop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>744</td>
      <td>chr18</td>
      <td>ARID5B::KLF5+GDSD6+1+A_B</td>
      <td>61243074</td>
      <td>61243208</td>
      <td>ARID5B</td>
      <td>A</td>
      <td>61243131</td>
      <td>61243135</td>
      <td>ARID5B::KLF5+GDSD6+1</td>
      <td>A_B</td>
      <td>True</td>
      <td>57</td>
      <td>61</td>
    </tr>
    <tr>
      <td>744</td>
      <td>chr18</td>
      <td>ARID5B::KLF5+GDSD6+1+A_B</td>
      <td>61243074</td>
      <td>61243208</td>
      <td>KLF5</td>
      <td>B</td>
      <td>61243141</td>
      <td>61243152</td>
      <td>ARID5B::KLF5+GDSD6+1</td>
      <td>A_B</td>
      <td>True</td>
      <td>67</td>
      <td>78</td>
    </tr>
    <tr>
      <td>9236</td>
      <td>chr18</td>
      <td>ARID5B::KLF5+GDSD6+1+A_scrB</td>
      <td>61243074</td>
      <td>61243208</td>
      <td>ARID5B</td>
      <td>A</td>
      <td>61243131</td>
      <td>61243135</td>
      <td>ARID5B::KLF5+GDSD6+1</td>
      <td>A_scrB</td>
      <td>True</td>
      <td>57</td>
      <td>61</td>
    </tr>
    <tr>
      <td>9236</td>
      <td>chr18</td>
      <td>ARID5B::KLF5+GDSD6+1+A_scrB</td>
      <td>61243074</td>
      <td>61243208</td>
      <td>KLF5</td>
      <td>B</td>
      <td>61243141</td>
      <td>61243152</td>
      <td>ARID5B::KLF5+GDSD6+1</td>
      <td>A_scrB</td>
      <td>False</td>
      <td>67</td>
      <td>78</td>
    </tr>
    <tr>
      <td>4990</td>
      <td>chr18</td>
      <td>ARID5B::KLF5+GDSD6+1+scrA_B</td>
      <td>61243074</td>
      <td>61243208</td>
      <td>KLF5</td>
      <td>B</td>
      <td>61243141</td>
      <td>61243152</td>
      <td>ARID5B::KLF5+GDSD6+1</td>
      <td>scrA_B</td>
      <td>True</td>
      <td>67</td>
      <td>78</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>11996</td>
      <td>chr7</td>
      <td>ZFX::E2F6+SCC+9+A_scrB</td>
      <td>44153033</td>
      <td>44153167</td>
      <td>E2F6</td>
      <td>A</td>
      <td>44153086</td>
      <td>44153095</td>
      <td>ZFX::E2F6+SCC+9</td>
      <td>A_scrB</td>
      <td>True</td>
      <td>53</td>
      <td>62</td>
    </tr>
    <tr>
      <td>7750</td>
      <td>chr7</td>
      <td>ZFX::E2F6+SCC+9+scrA_B</td>
      <td>44153033</td>
      <td>44153167</td>
      <td>E2F6</td>
      <td>A</td>
      <td>44153086</td>
      <td>44153095</td>
      <td>ZFX::E2F6+SCC+9</td>
      <td>scrA_B</td>
      <td>False</td>
      <td>53</td>
      <td>62</td>
    </tr>
    <tr>
      <td>7750</td>
      <td>chr7</td>
      <td>ZFX::E2F6+SCC+9+scrA_B</td>
      <td>44153033</td>
      <td>44153167</td>
      <td>ZFX</td>
      <td>B</td>
      <td>44153101</td>
      <td>44153114</td>
      <td>ZFX::E2F6+SCC+9</td>
      <td>scrA_B</td>
      <td>True</td>
      <td>68</td>
      <td>81</td>
    </tr>
    <tr>
      <td>16242</td>
      <td>chr7</td>
      <td>ZFX::E2F6+SCC+9+scrA_scrB</td>
      <td>44153033</td>
      <td>44153167</td>
      <td>ZFX</td>
      <td>B</td>
      <td>44153101</td>
      <td>44153114</td>
      <td>ZFX::E2F6+SCC+9</td>
      <td>scrA_scrB</td>
      <td>False</td>
      <td>68</td>
      <td>81</td>
    </tr>
    <tr>
      <td>16242</td>
      <td>chr7</td>
      <td>ZFX::E2F6+SCC+9+scrA_scrB</td>
      <td>44153033</td>
      <td>44153167</td>
      <td>E2F6</td>
      <td>A</td>
      <td>44153086</td>
      <td>44153095</td>
      <td>ZFX::E2F6+SCC+9</td>
      <td>scrA_scrB</td>
      <td>False</td>
      <td>53</td>
      <td>62</td>
    </tr>
  </tbody>
</table>
<p>19120 rows  13 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(2390,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7C2:-add-in-motif_scan-information-per-case">7C2: add in motif_scan information per case<a class="anchor-link" href="#7C2:-add-in-motif_scan-information-per-case">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[328]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># helper functions</span>
<span class="k">def</span> <span class="nf">label_config</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab_present_actual&#39;</span><span class="p">]:</span> 
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab_present_pred&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;TP&#39;</span> <span class="c1"># good, Case 1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;FP&#39;</span> <span class="c1"># noisy, Case 3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab_present_pred&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;FN&#39;</span> <span class="c1"># not detected (Case 4)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;TN&#39;</span> <span class="c1"># good, Case 1</span>
<span class="k">def</span> <span class="nf">get_case_instance</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">row_counts</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="c1"># case 1: all the configs that should have the vocab have the vocab and those that don&#39;t do not</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span><span class="n">row_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TN&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;case 1&#39;</span>
    <span class="c1"># case 4: the pvalue threshold was too stringent</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FN&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span><span class="n">row_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TN&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;case 4&#39;</span>
    <span class="c1"># case 3: too noisy</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">row_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TP&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span><span class="n">row_counts</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FP&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;case 3&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;other&#39;</span>

<span class="k">def</span> <span class="nf">analyze_motif_scan</span><span class="p">(</span><span class="n">motif_scan_file</span><span class="p">,</span> <span class="n">tf_id_abbr_to_name_dict</span><span class="o">=</span><span class="n">tf_id_abbr_to_name_dict</span><span class="p">):</span>
    <span class="c1"># read in motif scan file</span>
    <span class="n">motif_scan_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">motif_scan_file</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;pwm_file&#39;</span><span class="p">,</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span><span class="s1">&#39;strand&#39;</span><span class="p">,</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">,</span><span class="s1">&#39;seq_actual&#39;</span><span class="p">])</span>
    <span class="n">motif</span> <span class="o">=</span> <span class="n">tf_id_abbr_to_name_dict</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">motif_scan_file</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_scan&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">motif_scan_results</span><span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">motif_scan_results</span><span class="o">.</span><span class="n">pwm_file</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.pwm&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tf_id_abbr_to_name_dict</span><span class="p">)</span>

    <span class="c1"># merge in genomic location information</span>
    <span class="n">vocab_motif_scan</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="p">[</span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab</span><span class="o">==</span><span class="n">motif</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">motif_scan_results</span><span class="p">[[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;vocab&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">])</span>
    <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">motif</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan</span><span class="p">[</span><span class="s1">&#39;vocab_present_actual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">vocab_loc_start</span> <span class="o">-</span> <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">pos</span> <span class="p">)</span> <span class="o">&lt;=</span><span class="mi">3</span>
    <span class="n">vocab_motif_scan</span><span class="p">[</span><span class="s1">&#39;off_target&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="o">~</span><span class="p">(</span> <span class="p">(</span> <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">vocab_present_actual</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">pos</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1">#### case 2: off-target effects</span>
    <span class="n">vocab_motif_scan_off_target</span> <span class="o">=</span> <span class="n">vocab_motif_scan</span><span class="p">[</span><span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">off_target</span><span class="p">]</span>
    <span class="n">vocab_motif_scan_off_target</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_off_target</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_off_target</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_off_target</span><span class="p">[</span><span class="s1">&#39;pos_close&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_motif_scan_off_target</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="p">(</span><span class="n">vocab_motif_scan_off_target</span><span class="o">.</span><span class="n">pos</span><span class="o">%</span><span class="k">2</span>)
    <span class="n">off_target_counts_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vocab_motif_scan_off_target</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">pos_close</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
    <span class="n">off_target_counts_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;count_pos&#39;</span><span class="p">]</span>
    <span class="n">off_target_counts_df</span><span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">motif</span>
    <span class="n">off_target_counts_df</span><span class="p">[</span><span class="s1">&#39;case&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">off_target_counts_df</span><span class="o">.</span><span class="n">count_pos</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;case 2A&#39;</span> <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mi">4</span> <span class="k">else</span> <span class="s1">&#39;case 2B&#39;</span><span class="p">)</span>
    <span class="n">off_target_counts_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1">##### Case 1,3,4</span>
    <span class="c1"># - case 1: good</span>
    <span class="c1"># - case 3: FP (too noisy, scrambling might not be good), case 4: FN (pval, threshold too low )</span>

    <span class="c1"># only include the highest scoring </span>
    <span class="n">vocab_motif_scan_on_target</span> <span class="o">=</span> <span class="n">vocab_motif_scan</span><span class="p">[</span><span class="o">~</span><span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">off_target</span><span class="p">]</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># fill in all possible instances in the library</span>
    <span class="n">vocab_motif_scan_on_target</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="p">[</span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab</span><span class="o">==</span><span class="n">motif</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">vocab_motif_scan_on_target</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">motif</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">vocab_present_actual</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">off_target</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_motif_scan_on_target</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">label_config</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># create data frame thats has rows (instances) and columns are the eval (TP,FP, etc) and score per config</span>
    <span class="n">vocab_motif_scan_on_target_config</span> <span class="o">=</span> <span class="n">vocab_motif_scan_on_target</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;eval&#39;</span><span class="p">,</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
    <span class="n">vocab_motif_scan_on_target_config</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">vocab_motif_scan_on_target_config</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
    <span class="n">vocab_motif_scan_on_target_config</span><span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">motif</span>
    <span class="n">vocab_motif_scan_on_target_config</span><span class="p">[</span><span class="s1">&#39;case&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vocab_motif_scan_on_target_config</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_case_instance</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># dict of case_type: # instances that fall in type</span>
    <span class="n">on_target_config_cases</span> <span class="o">=</span> <span class="n">vocab_motif_scan_on_target_config</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">motif</span><span class="p">,</span> <span class="n">off_target_counts_df</span><span class="p">,</span> <span class="n">vocab_motif_scan_on_target_config</span><span class="p">,</span> <span class="n">on_target_config_cases</span>

<span class="k">def</span> <span class="nf">analyze_motif_scan_wrap</span><span class="p">(</span><span class="n">motif_scan_files</span><span class="p">,</span> <span class="n">save_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# motif files: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">motif_scan_files</span><span class="p">))</span>
    <span class="c1"># overall dataframe setup</span>
    <span class="n">off_target_counts_df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">on_target_cases_df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">on_target_config_cases_dict</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1">#get scan results from file</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">motif_scan_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">motif_scan_files</span><span class="p">):</span>
        <span class="c1">## DEBUG</span>
    <span class="c1">#     print(idx,motif_scan_file)</span>
        <span class="n">motif</span><span class="p">,</span> <span class="n">off_target_counts_df</span><span class="p">,</span> <span class="n">vocab_motif_scan_on_target_config</span><span class="p">,</span> <span class="n">on_target_config_cases</span> <span class="o">=</span> <span class="n">analyze_motif_scan</span><span class="p">(</span><span class="n">motif_scan_file</span><span class="p">)</span>
        <span class="c1"># ADD TO RUNNING LIST (ACROSS MOTIFS)</span>
        <span class="n">off_target_counts_df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">off_target_counts_df_all</span><span class="p">,</span> <span class="n">off_target_counts_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">on_target_cases_df_all</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">on_target_cases_df_all</span><span class="p">,</span> <span class="n">vocab_motif_scan_on_target_config</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">on_target_config_cases_dict</span><span class="p">[</span><span class="n">motif</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_target_config_cases</span>

    <span class="c1"># convert dict to dataframe (row: motif, columns case type)</span>
    <span class="n">on_target_config_cases_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">on_target_config_cases_dict</span><span class="p">,</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">## TODO: add in save functionality</span>
    <span class="k">if</span> <span class="n">save_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">off_target_counts_df_all</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_prefix</span><span class="o">+</span><span class="s1">&#39;off_target_counts_df_all.csv&#39;</span><span class="p">)</span>
        <span class="n">on_target_cases_df_all</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_prefix</span><span class="o">+</span><span class="s1">&#39;motif_scan_&#39;</span><span class="o">+</span><span class="s1">&#39;on_target_cases_df_all.csv&#39;</span><span class="p">)</span>
        <span class="n">on_target_config_cases_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_prefix</span><span class="o">+</span> <span class="s1">&#39;motif_scan_&#39;</span><span class="o">+</span><span class="s1">&#39;on_target_config_cases_df.csv&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;saved&#39;</span><span class="p">,</span> <span class="n">save_prefix</span><span class="o">+</span><span class="s1">&#39;*.csv&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">off_target_counts_df_all</span><span class="p">,</span> <span class="n">on_target_cases_df_all</span><span class="p">,</span> <span class="n">on_target_config_cases_df</span>

<span class="k">def</span> <span class="nf">refine_case3</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;case&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;case 3&#39;</span><span class="p">:</span>
<span class="c1">#         print(row[&#39;case&#39;])</span>
        <span class="k">return</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;case&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># only remodify case 3:</span>
        <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;score_A_B&#39;</span><span class="p">]</span><span class="o">&gt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;score_A_scrB&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;score_scrA_B&#39;</span><span class="p">]</span> <span class="p">):</span>
    <span class="c1">#         print(&#39;here&#39;)</span>
            <span class="k">return</span> <span class="s1">&#39;case 3A&#39;</span> <span class="c1"># this is the good case where scrambling reduces the score of the motif</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;case 3B&#39;</span>
        <span class="c1"># case 3, where the TP are have higher score than where the true negatives are</span>

<span class="k">def</span> <span class="nf">get_offtarget_num</span><span class="p">(</span><span class="n">off_target_counts_df</span><span class="p">,</span> <span class="n">vocab_instances_df</span><span class="o">=</span><span class="n">vocab_instances20_seqs_sel</span><span class="p">):</span>
    <span class="n">off_target_res_case_2A</span> <span class="o">=</span> <span class="n">off_target_counts_df</span><span class="p">[</span><span class="n">off_target_counts_df</span><span class="o">.</span><span class="n">case</span><span class="o">==</span><span class="s1">&#39;case 2A&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">off_target_res_case_2A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">off_target_res_case_2A</span><span class="p">[</span><span class="s1">&#39;off_target_pos_str&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">off_target_res_case_2A</span><span class="o">.</span><span class="n">pos_close</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">off_target_res_case_2A</span> <span class="o">=</span> <span class="n">off_target_res_case_2A</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;off_target_pos_str&#39;</span><span class="p">:</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">off_target_res_case_2A</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;off_target_name&#39;</span><span class="p">,</span><span class="s1">&#39;off_target_motif&#39;</span><span class="p">,</span><span class="s1">&#39;off_target_pos_str&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">off_target_res_case_2A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># groupbed by instance</span>
    <span class="n">vocab_instances20_seqs_sel_offtarget</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">off_target_res_case_2A</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;off_target_name&#39;</span><span class="p">)</span>
    <span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">off_target_name</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">off_target_motif</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">off_target_pos_str</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vocab_instances20_seqs_sel_offtarget</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="p">,</span><span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_vocab_loc</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
<span class="c1">#     return vocab_instances20_seqs_sel_offtarget</span>
    <span class="n">vocab_instances20_seqs_sel_offtarget</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;btn_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">,</span>
           <span class="s1">&#39;start_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1_start&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1_stop&#39;</span><span class="p">,</span>
           <span class="s1">&#39;vocab2&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_start&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_stop&#39;</span><span class="p">,</span> <span class="s1">&#39;tissue&#39;</span><span class="p">,</span> <span class="s1">&#39;loop_type&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;check_rs&#39;</span><span class="p">,</span> <span class="s1">&#39;scr_pass_rs&#39;</span><span class="p">,</span> 
           <span class="s1">&#39;vocab_tissue_count&#39;</span><span class="p">,</span> <span class="s1">&#39;seq_config&#39;</span><span class="p">,</span> <span class="s1">&#39;seq&#39;</span><span class="p">,</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span> <span class="s1">&#39;off_target_name&#39;</span><span class="p">,</span><span class="s1">&#39;vocab1_start_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1_stop_shift&#39;</span><span class="p">,</span>
           <span class="s1">&#39;vocab2_start_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_stop_shift&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;off_target_motif&#39;</span><span class="p">:</span><span class="s1">&#39;::&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span><span class="s1">&#39;off_target_pos_str&#39;</span><span class="p">:</span><span class="s1">&#39;::&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

    <span class="n">vocab_instances20_seqs_sel_offtarget</span> <span class="o">=</span> <span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;vocab_pair&#39;</span><span class="p">,</span> <span class="s1">&#39;tot_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;btn_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span> <span class="s1">&#39;stop&#39;</span><span class="p">,</span>
           <span class="s1">&#39;start_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;stop_pad&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1_start&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab1_stop&#39;</span><span class="p">,</span>
           <span class="s1">&#39;vocab2&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_start&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_stop&#39;</span><span class="p">,</span> <span class="s1">&#39;tissue&#39;</span><span class="p">,</span> <span class="s1">&#39;loop_type&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
           <span class="s1">&#39;check_rs&#39;</span><span class="p">,</span> <span class="s1">&#39;scr_pass_rs&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab_tissue_count&#39;</span><span class="p">,</span>  <span class="s1">&#39;vocab1_start_shift&#39;</span><span class="p">,</span>
           <span class="s1">&#39;vocab1_stop_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_start_shift&#39;</span><span class="p">,</span> <span class="s1">&#39;vocab2_stop_shift&#39;</span><span class="p">,</span><span class="s1">&#39;off_target_name&#39;</span><span class="p">,</span>
           <span class="s1">&#39;off_target_motif&#39;</span><span class="p">,</span> <span class="s1">&#39;off_target_pos_str&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;seq_config&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="s1">&#39;name_config&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="c1"># </span>


    <span class="n">off_target_num_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vocab_instances20_seqs_sel_offtarget</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">off_target_pos_str</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">off_target_pos_str_find_num</span><span class="p">))</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">off_target_num_df</span><span class="p">[</span><span class="s1">&#39;instance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">off_target_num_df</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">off_target_num_df_counts</span> <span class="o">=</span> <span class="n">off_target_num_df</span><span class="p">[</span><span class="n">off_target_num_df</span><span class="o">.</span><span class="n">off_target_pos_str</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">off_target_num_df_counts</span><span class="o">/</span><span class="n">off_target_num_df_counts</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">off_target_num_df</span><span class="p">[</span><span class="n">off_target_num_df</span><span class="o">.</span><span class="n">off_target_pos_str</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_vocab_loc</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">motif_len_scr</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># getting vocab locations in the sequence</span>
    <span class="n">vocab1_med</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_start&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">vocab1_start_shift</span> <span class="o">=</span> <span class="n">vocab1_med</span> <span class="o">-</span> <span class="n">motif_len_scr</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span>
    <span class="n">vocab1_stop_shift</span> <span class="o">=</span> <span class="n">vocab1_med</span> <span class="o">+</span> <span class="n">motif_len_scr</span> <span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="n">vocab2_med</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2_start&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2_stop&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">vocab2_start_shift</span> <span class="o">=</span> <span class="n">vocab2_med</span> <span class="o">-</span> <span class="n">motif_len_scr</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span>
    <span class="n">vocab2_stop_shift</span> <span class="o">=</span> <span class="n">vocab2_med</span> <span class="o">+</span> <span class="n">motif_len_scr</span> <span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="c1"># for overlaps</span>
    <span class="k">if</span> <span class="n">vocab1_stop_shift</span><span class="o">&gt;=</span> <span class="n">vocab2_start_shift</span><span class="p">:</span>
<span class="c1">#         print(idx)</span>
<span class="c1">#         print(row)</span>
        
        <span class="c1"># case 1 vocab words are really close, the padding goes into the vocab word</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">vocab2_start_shift</span><span class="p">:</span>
            
            <span class="n">vocab1_stop_shift</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">vocab2_start_shift</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;start_pad&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="c1">#             print(vocab1_start_shift,vocab1_stop_shift, vocab2_start_shift, vocab2_stop_shift)</span>
<span class="c1">#             raise</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">vocab1_stop_shift</span> <span class="o">=</span> <span class="n">vocab1_stop_shift</span>
            <span class="n">vocab2_start_shift</span> <span class="o">=</span> <span class="n">vocab1_stop_shift</span>
<span class="c1">#             print(vocab1_start_shift,vocab1_stop_shift, vocab2_start_shift, vocab2_stop_shift)</span>
<span class="c1">#             raise</span>

    <span class="c1"># for edges:</span>
    <span class="n">vocab1_start_shift</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">vocab1_start_shift</span><span class="p">)</span>
    <span class="n">vocab2_stop_shift</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;seq&#39;</span><span class="p">]),</span><span class="n">vocab2_stop_shift</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;vocab1_start_shift&#39;</span><span class="p">:</span> <span class="n">vocab1_start_shift</span><span class="p">,</span>
                      <span class="s1">&#39;vocab1_stop_shift&#39;</span><span class="p">:</span><span class="n">vocab1_stop_shift</span><span class="p">,</span> 
                      <span class="s1">&#39;vocab2_start_shift&#39;</span><span class="p">:</span><span class="n">vocab2_start_shift</span><span class="p">,</span> 
                      <span class="s1">&#39;vocab2_stop_shift&#39;</span><span class="p">:</span><span class="n">vocab2_stop_shift</span><span class="p">})</span>


<span class="k">def</span> <span class="nf">get_vocab_to_loc_dict</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1&#39;</span><span class="p">]:[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_start_shift&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab1_stop_shift&#39;</span><span class="p">]],</span>
           <span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2&#39;</span><span class="p">]:[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2_start_shift&#39;</span><span class="p">],</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;vocab2_stop_shift&#39;</span><span class="p">]]}</span>


<span class="k">def</span> <span class="nf">off_target_pos_str_find_num</span><span class="p">(</span><span class="n">pos_str</span><span class="p">):</span>
    <span class="n">pos_arr_per_vocab_word</span> <span class="o">=</span> <span class="n">pos_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos_arr_per_vocab_word</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos_arr_per_vocab_word</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pos</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">continue</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">on_target_new_cases</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">motif_arr</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
    <span class="n">case_mod_arr</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;case_mod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
    <span class="n">num_motifs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">motif_arr</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">num_motifs</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">motif_arr</span><span class="p">))),</span> <span class="s1">&#39;more than 2 motifs&#39;</span>
    <span class="k">elif</span> <span class="n">num_motifs</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">motif_arr</span><span class="p">))),</span> <span class="s1">&#39;less than 2 motifs&#39;</span>    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">motif_to_case</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">motif</span><span class="p">,</span> <span class="n">case</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">motif_arr</span><span class="p">,</span> <span class="n">case_mod_arr</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">motif</span> <span class="ow">in</span> <span class="n">motif_to_case</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">motif_to_case</span><span class="p">[</span><span class="n">motif</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;case 3A&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">motif_to_case</span><span class="p">[</span><span class="n">motif</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;case 1&#39;</span><span class="p">):</span>
                    <span class="n">motif_to_case</span><span class="p">[</span><span class="n">motif</span><span class="p">]</span><span class="o">=</span><span class="n">case</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">motif_to_case</span><span class="p">[</span><span class="n">motif</span><span class="p">]</span><span class="o">=</span><span class="n">case</span>
        <span class="n">motif_new</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">motif_to_case</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">case_new</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">motif_to_case</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">motif_new</span><span class="p">,</span> <span class="n">case_new</span>
    
<span class="k">def</span> <span class="nf">on_target_new_case_good</span><span class="p">(</span><span class="n">case_new</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;|&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">case_new</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span> <span class="c1"># not two motifs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">case_status</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">case_new</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">):</span>
            <span class="k">if</span>  <span class="p">(</span><span class="n">case</span><span class="o">!=</span><span class="s1">&#39;case 3A&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">case</span><span class="o">!=</span><span class="s1">&#39;case 1&#39;</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">case_status</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">case_status</span>
    
<span class="k">def</span> <span class="nf">get_on_target_good_instance_num</span><span class="p">(</span><span class="n">on_target_cases_df</span><span class="p">):</span>
    <span class="n">on_target_counts</span> <span class="o">=</span> <span class="n">on_target_cases_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span><span class="s1">&#39;case_mod&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;instance&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;motif&#39;</span><span class="p">:</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span> <span class="s1">&#39;case_mod&#39;</span><span class="p">:</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span>
    <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">on_target_counts</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_target_counts</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">on_target_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">on_target_counts</span><span class="p">,</span> <span class="n">on_target_counts</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">on_target_new_cases</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;motif_new&#39;</span><span class="p">:</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;case_new&#39;</span><span class="p">:</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]}))],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">on_target_counts</span><span class="p">[</span><span class="s1">&#39;case_good_bool&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_target_counts</span><span class="o">.</span><span class="n">case_new</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">on_target_new_case_good</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">on_target_counts</span><span class="p">[</span><span class="n">on_target_counts</span><span class="o">.</span><span class="n">case_good_bool</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[257]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># testing</span>
    <span class="c1"># read in motif scan file</span>
<span class="n">motif_scan_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">motif_scan_files1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;pwm_file&#39;</span><span class="p">,</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span><span class="s1">&#39;strand&#39;</span><span class="p">,</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="s1">&#39;seq&#39;</span><span class="p">,</span><span class="s1">&#39;seq_actual&#39;</span><span class="p">])</span>
<span class="n">motif</span> <span class="o">=</span> <span class="n">tf_id_abbr_to_name_dict</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">motif_scan_files1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_scan&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">motif_scan_results</span><span class="p">[</span><span class="s1">&#39;motif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">motif_scan_results</span><span class="o">.</span><span class="n">pwm_file</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.pwm&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">tf_id_abbr_to_name_dict</span><span class="p">)</span>

<span class="c1"># merge in genomic location information</span>
<span class="n">vocab_motif_scan</span> <span class="o">=</span> <span class="n">vocab_instances_df</span><span class="p">[</span><span class="n">vocab_instances_df</span><span class="o">.</span><span class="n">vocab</span><span class="o">==</span><span class="n">motif</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span> <span class="n">motif_scan_results</span><span class="p">[[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span><span class="s1">&#39;score&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;vocab&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name_config&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">])</span>
<span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">motif</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">vocab_motif_scan</span><span class="p">[</span><span class="s1">&#39;vocab_present_actual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">vocab_loc_start</span> <span class="o">-</span> <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">pos</span> <span class="p">)</span> <span class="o">&lt;=</span><span class="mi">3</span>
<span class="n">vocab_motif_scan</span><span class="p">[</span><span class="s1">&#39;off_target&#39;</span><span class="p">]</span>  <span class="o">=</span>  <span class="o">~</span><span class="p">(</span> <span class="p">(</span> <span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">vocab_present_actual</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vocab_motif_scan</span><span class="o">.</span><span class="n">pos</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[258]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># vocab_motif_scan_off_target</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="version-1:-analyze-the-original-scrambled-version-(only-scramble-the-motifs)">version 1: analyze the original scrambled version (only scramble the motifs)<a class="anchor-link" href="#version-1:-analyze-the-original-scrambled-version-(only-scramble-the-motifs)">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># takes ~ 15s</span>

<span class="n">motif_scan_files1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan&#39;</span><span class="p">,</span><span class="s1">&#39;*csv&#39;</span><span class="p">)))</span>
<span class="n">off_target_counts_df_all_1</span><span class="p">,</span> <span class="n">on_target_cases_df_all_1</span><span class="p">,</span> <span class="n">on_target_config_cases_df_1</span> <span class="o">=</span> <span class="n">analyze_motif_scan_wrap</span><span class="p">(</span><span class="n">motif_scan_files1</span><span class="p">,</span> <span class="n">save_prefix</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan_&#39;</span><span class="p">))</span>
<span class="n">on_target_config_cases_df_1</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre># motif files:  158
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:43: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:44: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:59: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:61: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>saved ../data/processed/fig4_modelling/vocab_sum_final/motif_scan_*.csv
CPU times: user 14.1 s, sys: 242 ms, total: 14.3 s
Wall time: 14.7 s
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[105]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 1    3093.0
case 4    1077.0
case 3     535.0
other       75.0
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[260]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_1</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[260]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 1    3625
case 4    1722
case 3     611
other      122
Name: case, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="version-2:-analyze-the-scrambled-version-where-we-scramble-a-fixed-20bp-length,-p-val-&lt;0.001">version 2: analyze the scrambled version where we scramble a fixed 20bp length, p val &lt;0.001<a class="anchor-link" href="#version-2:-analyze-the-scrambled-version-where-we-scramble-a-fixed-20bp-length,-p-val-&lt;0.001">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[278]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># takes ~ 15s</span>
<span class="n">motif_scan_files2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan2&#39;</span><span class="p">,</span><span class="s1">&#39;*csv&#39;</span><span class="p">)))</span>
<span class="n">off_target_counts_df_all_2</span><span class="p">,</span> <span class="n">on_target_cases_df_all_2</span><span class="p">,</span> <span class="n">on_target_config_cases_df_2</span> <span class="o">=</span> <span class="n">analyze_motif_scan_wrap</span><span class="p">(</span><span class="n">motif_scan_files2</span><span class="p">,</span> <span class="n">save_prefix</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan2_&#39;</span><span class="p">))</span>
<span class="n">on_target_config_cases_df_2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre># motif files:  158
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:43: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:44: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:59: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:61: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>saved ../data/processed/fig4_modelling/vocab_sum_final/motif_scan2_*.csv
CPU times: user 13.9 s, sys: 235 ms, total: 14.1 s
Wall time: 14.1 s
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[278]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 1    3329.0
case 4    1085.0
other       93.0
case 3     273.0
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[282]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_2</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[282]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 1    3875
case 4    1740
case 3     320
other      145
Name: case, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[283]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_2</span><span class="p">[</span><span class="s1">&#39;case_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_target_cases_df_all_2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">refine_case3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">on_target_cases_df_all_2</span><span class="o">.</span><span class="n">case_mod</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[283]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 1     3875
case 4     1740
case 3A     165
case 3B     155
other       145
Name: case_mod, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[329]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_on_target_good_instance_num</span><span class="p">(</span><span class="n">on_target_cases_df_all_2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[329]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    234.000000
mean       6.820513
std        2.845418
min        1.000000
25%        5.000000
50%        8.000000
75%        9.000000
max       10.000000
Name: name, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[301]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_2</span><span class="o">.</span><span class="n">case_mod</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[301]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(6080,)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[285]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_config_cases_df_2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#double the number of instances b/c of the two vocab words per instance</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[285]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>4780.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[286]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_2</span><span class="p">[</span><span class="n">on_target_cases_df_all_2</span><span class="o">.</span><span class="n">case</span><span class="o">==</span><span class="s1">&#39;other&#39;</span><span class="p">][[</span><span class="s1">&#39;eval_A_B&#39;</span><span class="p">,</span>
                                                                  <span class="s1">&#39;eval_A_scrB&#39;</span><span class="p">,</span>	
                                                                  <span class="s1">&#39;eval_scrA_B&#39;</span><span class="p">,</span>	
                                                                  <span class="s1">&#39;eval_scrA_scrB&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[286]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>FN|FN|FP|FP    31
FN|FP|FN|FP    26
TP|TP|FP|TN    16
TP|TN|FN|TN    13
TP|TP|TN|FP    11
TP|FN|TN|TN     9
FN|TP|TN|TN     8
TP|FP|TP|TN     7
FN|TN|TP|TN     5
TP|TN|TP|FP     5
FN|FN|FP|TN     5
FN|TN|FN|FP     3
FN|FN|TN|FP     2
TP|TN|FN|FP     1
FN|FP|FN|TN     1
TP|FP|FN|TN     1
TP|FN|FP|TN     1
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[288]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">off_target_counts_df_all_2</span><span class="p">[[</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span><span class="s1">&#39;case&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">off_target_counts_df_all_2</span><span class="p">[[</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span><span class="s1">&#39;case&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()[</span><span class="s1">&#39;case&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(2840, 3)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[288]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 2B    1703
case 2A    1137
Name: case, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[309]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">off_target_counts_df_all_2</span><span class="p">[</span><span class="n">off_target_counts_df_all_2</span><span class="o">.</span><span class="n">case</span><span class="o">==</span><span class="s1">&#39;case 2A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[309]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>5    57
4    51
3    38
6    32
2    21
1    13
7    12
9     3
8     3
Name: instance, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[315]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_offtarget_num</span><span class="p">(</span><span class="n">off_target_counts_df_all_2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(1248, 5)
(1137, 3)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:127: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1     0.004184
2     0.012552
3     0.033473
4     0.100418
5     0.221757
6     0.188285
7     0.205021
8     0.125523
9     0.066946
10    0.041841
Name: instance, dtype: float64
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[315]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    239.000000
mean       6.230126
std        1.780311
min        1.000000
25%        5.000000
50%        6.000000
75%        7.000000
max       10.000000
Name: instance, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="version-3:-analyze-the-scrambled-version-where-we-scramble-a-fixed-20bp-length-and-raise-the-p-val-threshold-to-0.05">version 3: analyze the scrambled version where we scramble a fixed 20bp length and raise the p val threshold to 0.05<a class="anchor-link" href="#version-3:-analyze-the-scrambled-version-where-we-scramble-a-fixed-20bp-length-and-raise-the-p-val-threshold-to-0.05">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we find that that the 20bp scrambling words better (less case 3s, more case 1s, and slight increase in case 4). that's why we're trying raising the p value threshold</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[289]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="c1"># takes 30 s </span>

<span class="n">motif_scan_files3</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan3&#39;</span><span class="p">,</span><span class="s1">&#39;*csv&#39;</span><span class="p">)))</span>
<span class="n">off_target_counts_df_all_3</span><span class="p">,</span> <span class="n">on_target_cases_df_all_3</span><span class="p">,</span> <span class="n">on_target_config_cases_df_3</span> <span class="o">=</span> <span class="n">analyze_motif_scan_wrap</span><span class="p">(</span><span class="n">motif_scan_files3</span><span class="p">,</span> <span class="n">save_prefix</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">save_dir</span><span class="p">,</span> <span class="s1">&#39;motif_scan3_&#39;</span><span class="p">))</span>
<span class="n">on_target_config_cases_df_3</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre># motif files:  158
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:43: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:44: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:45: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:46: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:59: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:60: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:61: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>saved ../data/processed/fig4_modelling/vocab_sum_final/motif_scan3_*.csv
CPU times: user 1min 53s, sys: 4.16 s, total: 1min 58s
Wall time: 1min 58s
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[289]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 3    2886.0
case 1    1627.0
other      195.0
case 4      72.0
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[291]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_3</span><span class="p">[</span><span class="s1">&#39;case_mod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">on_target_cases_df_all_3</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">refine_case3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[292]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># row = on_target_cases_df_all_3[on_target_cases_df_all_3.case==&#39;case 3&#39;].iloc[0,:]</span>
<span class="n">on_target_cases_df_all_3</span><span class="o">.</span><span class="n">case</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[292]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 3    3625
case 1    1989
other      313
case 4     153
Name: case, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[293]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_3</span><span class="o">.</span><span class="n">case_mod</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[293]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 3A    3216
case 1     1989
case 3B     409
other       313
case 4      153
Name: case_mod, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[330]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_on_target_good_instance_num</span><span class="p">(</span><span class="n">on_target_cases_df_all_3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[330]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    239.000000
mean       8.736402
std        1.369526
min        5.000000
25%        8.000000
50%        9.000000
75%       10.000000
max       10.000000
Name: name, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[294]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_3</span><span class="o">.</span><span class="n">case_mod</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[294]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>6080</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[295]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_config_cases_df_3</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1">#double the number of instances b/c of the two vocab words per instance</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[295]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>4780.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[296]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">on_target_cases_df_all_3</span><span class="p">[</span><span class="n">on_target_cases_df_all_3</span><span class="o">.</span><span class="n">case</span><span class="o">==</span><span class="s1">&#39;other&#39;</span><span class="p">][[</span><span class="s1">&#39;eval_A_B&#39;</span><span class="p">,</span>
                                                                  <span class="s1">&#39;eval_A_scrB&#39;</span><span class="p">,</span>	
                                                                  <span class="s1">&#39;eval_scrA_B&#39;</span><span class="p">,</span>	
                                                                  <span class="s1">&#39;eval_scrA_scrB&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[296]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>FN|FP|FN|FP    87
FN|FN|FP|FP    52
TP|FP|TP|TN    41
TP|TN|TP|FP    39
TP|TP|FP|TN    31
TP|TP|TN|FP    23
FN|FP|TP|FP     5
FN|TN|FN|FP     5
FN|TN|TP|TN     4
FN|FP|FN|TN     4
TP|FP|FN|FP     4
TP|TN|FN|TN     3
FN|TP|TN|FP     3
FN|TP|TN|TN     2
TP|FP|FN|TN     2
FN|TP|FP|FP     2
FN|FN|TN|FP     1
FN|TN|TP|FP     1
TP|FN|FP|TN     1
TP|FN|FP|FP     1
FN|FN|FP|TN     1
TP|FN|TN|TN     1
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[297]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">off_target_counts_df_all_3</span><span class="p">[[</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span><span class="s1">&#39;case&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">off_target_counts_df_all_3</span><span class="p">[[</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">,</span><span class="s1">&#39;case&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()[</span><span class="s1">&#39;case&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(5227, 3)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[297]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>case 2B    3050
case 2A    2177
Name: case, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[298]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">off_target_counts_df_all_3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="s1">&#39;instance&#39;</span><span class="p">,</span><span class="s1">&#39;motif&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[298]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(4764, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[299]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">off_target_counts_df_all_3</span><span class="p">[</span><span class="n">off_target_counts_df_all_3</span><span class="o">.</span><span class="n">case</span><span class="o">==</span><span class="s1">&#39;case 2A&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[299]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>case</th>
      <th>count_pos</th>
      <th>instance</th>
      <th>motif</th>
      <th>pos_close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>case 2A</td>
      <td>4</td>
      <td>KLF15::TFAP2B+Melanocytes+1</td>
      <td>TFAP2B</td>
      <td>42.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>case 2A</td>
      <td>4</td>
      <td>KLF15::TFAP2B+Melanocytes+10</td>
      <td>TFAP2B</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>case 2A</td>
      <td>4</td>
      <td>KLF15::TFAP2B+Melanocytes+2</td>
      <td>TFAP2B</td>
      <td>82.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>case 2A</td>
      <td>4</td>
      <td>KLF15::TFAP2B+Melanocytes+3</td>
      <td>TFAP2B</td>
      <td>108.0</td>
    </tr>
    <tr>
      <td>12</td>
      <td>case 2A</td>
      <td>4</td>
      <td>KLF15::TFAP2B+Melanocytes+7</td>
      <td>TFAP2B</td>
      <td>94.0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>28</td>
      <td>case 2A</td>
      <td>4</td>
      <td>IRF4::ZNF816+GM12878+4</td>
      <td>ZNF816</td>
      <td>6.0</td>
    </tr>
    <tr>
      <td>29</td>
      <td>case 2A</td>
      <td>4</td>
      <td>IRF4::ZNF816+GM12878+5</td>
      <td>ZNF816</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>30</td>
      <td>case 2A</td>
      <td>4</td>
      <td>IRF4::ZNF816+GM12878+6</td>
      <td>ZNF816</td>
      <td>6.0</td>
    </tr>
    <tr>
      <td>31</td>
      <td>case 2A</td>
      <td>4</td>
      <td>IRF4::ZNF816+GM12878+7</td>
      <td>ZNF816</td>
      <td>104.0</td>
    </tr>
    <tr>
      <td>51</td>
      <td>case 2A</td>
      <td>4</td>
      <td>IRF8::ZNF816+GM12878+7</td>
      <td>ZNF816</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
<p>2446 rows  5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[308]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">off_target_counts_df_all_3</span><span class="p">[</span><span class="n">off_target_counts_df_all_3</span><span class="o">.</span><span class="n">case</span><span class="o">==</span><span class="s1">&#39;case 2A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">instance</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[308]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>7     59
8     46
6     42
9     35
5     18
4     15
10    13
3      5
2      4
1      2
Name: instance, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[316]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_offtarget_num</span><span class="p">(</span><span class="n">off_target_counts_df_all_3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(2446, 5)
(2177, 3)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/mguo123/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:127: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1    0.085470
2    0.200855
3    0.213675
4    0.217949
5    0.123932
6    0.085470
7    0.042735
8    0.021368
9    0.008547
Name: instance, dtype: float64
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[316]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>count    234.000000
mean       3.679487
std        1.761488
min        1.000000
25%        2.000000
50%        3.500000
75%        5.000000
max        9.000000
Name: instance, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    </div>
  </div>
</body>

 


</html>
